var alm,__extends=this&&this.__extends||function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}();!function(t){var c,e,i,n;c=t.canvas||(t.canvas={}),e=t.event.EventDispatcher,i=t.browser.DeviceInfo,n=function(o){function h(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=null);var u=o.call(this)||this;return u.mouseOverHandler=function(t){u.getMousePointer(t)},u.mouseOutHandler=function(t){var e=u.getMousePointer(t);delete u.pointersById[u.mousePointerId];var n=u.pointerIds.indexOf(u.mousePointerId);-1!=n&&u.pointerIds.splice(n,1),--u.pointingCount,e.notifyLeave(),u.onPointerLeave(e)},u.mouseDownHandler=function(t){var e=u.getMousePointer(t);e.notifyTouch(),u.onPointerTouch(e)},u.mouseUpHandler=function(t){var e=u.getMousePointer(t);e.notifyRelease(),u.onPointerRelease(e)},u.mouseMoveHandler=function(t){var e=u.getMousePointer(t),n=u.getPointerPosition(t);e.notifyMove(n[0],n[1]),u.onPointerMove(e),e.isDragging&&u.onPointerDrag(e)},u.touchStartHandler=function(t){for(var e,n,o,i=t.changedTouches,r=t.changedTouches.length,s=0;s<r;++s){e=i.item(s),n=h.getPointerId(e.identifier),o=new c.Pointer(n),u.pointersById[n]=o,u.pointerIds.push(n),++u.pointingCount;var a=u.getPointerPosition(t);o.notifyEnter(a[0],a[1]),o.notifyTouch(),u.onPointerEnter(o),u.onPointerTouch(o)}},u.touchEndHandler=function(t){for(var e,n,o,i=t.changedTouches,r=t.changedTouches.length,s=0;s<r;++s){e=i.item(s),n=h.getPointerId(e.identifier),o=u.pointersById[n],delete u.pointersById[n];var a=u.pointerIds.indexOf(n);-1!=a&&u.pointerIds.splice(a,1),--u.pointingCount,o.notifyRelease(),o.notifyLeave(),u.onPointerRelease(o),u.onPointerLeave(o)}},u.touchCancelHandler=function(t){u.touchEndHandler(t)},u.touchMoveHandler=function(t){t.originalEvent.preventDefault();for(var e,n,o,i=t.changedTouches,r=t.changedTouches.length,s=0;s<r;++s){e=i.item(s),n=h.getPointerId(e.identifier),o=u.pointersById[n];var a=u.getPointerPosition(t);o.notifyMove(a[0],a[1]),o.isDragging&&u.onPointerDrag(o)}},u.touchForceChangeHandler=function(t){for(var e,n,o,i=t.changedTouches,r=t.changedTouches.length,s=0;s<r;++s)e=i.item(s),n=h.getPointerId(e.identifier),(o=u.pointersById[n])&&(o.notifyTouchForce(e.force),u.onPointerTouchForceChange(o))},u.keyDownHandler=function(t){u.onKeyDown(t.key)},u.keyUpHandler=function(t){u.onKeyUp(t.key)},u.resizeHandler=function(t){u.resize(u.canvas.width(),u.canvas.height())},u.requestAnimationFrame=function(){++u.elapsedFrameCount,u.elapsedTime=((new Date).getTime()-u.startTime)/1e3,u.onUpdate(),u.onPlatformRender(),requestAnimationFrame(u.requestAnimationFrame)},u.canvas=jQuery(t),u.isAutoResizeEnabled=e,trace("[BaseApp] canvas : ",t),trace("[BaseApp] isAutoResizeEnabled : "+u.isAutoResizeEnabled),u.pointerIds=[],u.pointersById={},u.pointingCount=0,u.elapsedFrameCount=0,u.startTime=(new Date).getTime(),u.mousePointerId="mouse",i.getIsTouchEnabled()?(u.canvas.on("touchstart",u.touchStartHandler),u.canvas.on("touchend",u.touchEndHandler),u.canvas.on("touchcancel",u.touchCancelHandler),u.canvas.on("touchmove",u.touchMoveHandler),u.canvas.on("touchforcechange",u.touchForceChangeHandler)):(u.canvas.on("mouseover",u.mouseOverHandler),u.canvas.on("mouseout",u.mouseOutHandler),u.canvas.on("mousedown",u.mouseDownHandler),u.canvas.on("mouseup",u.mouseUpHandler),u.canvas.on("mousemove",u.mouseMoveHandler)),u.canvas.on("keydown",u.keyDownHandler),u.canvas.on("keyup",u.keyUpHandler),u.canvas.attr("tabindex",1),requestAnimationFrame(u.requestAnimationFrame),u.onPlatformSetup(n||[]),u.onSetup(),u.isAutoResizeEnabled&&(u.canvas.on("resize",u.resizeHandler),u.resizeHandler(null)),u}return __extends(h,o),h.prototype.onSetup=function(){},h.prototype.onUpdate=function(){},h.prototype.onPointerEnter=function(t){},h.prototype.onPointerLeave=function(t){},h.prototype.onPointerTouch=function(t){},h.prototype.onPointerRelease=function(t){},h.prototype.onPointerMove=function(t){},h.prototype.onPointerDrag=function(t){},h.prototype.onPointerTouchForceChange=function(t){},h.prototype.onKeyDown=function(t){},h.prototype.onKeyUp=function(t){},h.prototype.onResize=function(t,e){},h.prototype.onPlatformSetup=function(t){},h.prototype.onPlatformRender=function(){},h.prototype.onPlatformResize=function(t,e){},h.prototype.resize=function(t,e){this.stageWidth=t,this.stageHeight=e,trace("[BaseApp] resize : width = "+this.stageWidth+", height = "+this.stageHeight),this.onPlatformResize(this.stageWidth,this.stageHeight),this.onResize(this.stageWidth,this.stageHeight)},h.prototype.getMousePointer=function(t){var e=this.pointersById[this.mousePointerId];if(null==e){e=new c.Pointer(this.mousePointerId),this.pointersById[this.mousePointerId]=e,this.pointerIds.push(this.mousePointerId),++this.pointingCount;var n=this.getPointerPosition(t);e.notifyEnter(n[0],n[1]),this.onPointerEnter(e)}return e},h.prototype.getPointerPosition=function(t){var e=this.getCanvas().offset();return[t.pageX-e.left,t.pageY-e.top]},h.getPointerId=function(t){return"touch_"+t},h.prototype.getPointerIds=function(){return this.pointerIds},h.prototype.getFirstPointer=function(){return 0<this.pointingCount?this.getPointerById(this.pointerIds[0]):null},h.prototype.getLastPointer=function(){return 0<this.pointingCount?this.getPointerById(this.pointerIds[this.pointingCount-1]):null},h.prototype.getPointerById=function(t){return this.pointersById[t]},h.prototype.getPointingCount=function(){return this.pointingCount},h.prototype.getStageWidth=function(){return this.stageWidth},h.prototype.getStageHeight=function(){return this.stageHeight},h.prototype.getElapsedFrameCount=function(){return this.elapsedFrameCount},h.prototype.getElapsedTime=function(){return this.elapsedTime},h.prototype.getCanvas=function(){return this.canvas},h.prototype.getIsAutoResizeEnabled=function(){return this.isAutoResizeEnabled},h.prototype.setIsAutoResizeEnabled=function(t){this.isAutoResizeEnabled=t},h}(e),c.BaseApp=n}(alm||(alm={})),function(t){var e,n;e=t.canvas||(t.canvas={}),n=function(){function t(t){this.id=t,this.isHovering=!1,this.isTouching=!1,this.isDragging=!1,this.x=0,this.y=0,this.prevX=0,this.prevY=0,this.dragX=0,this.dragY=0,this.velocityX=0,this.velocityY=0,this.touchBeginX=0,this.touchBeginY=0,this.touchForce=0}return t.prototype.notifyEnter=function(t,e){this.prevX=this.x=t,this.prevY=this.y=e,this.isHovering=!0},t.prototype.notifyLeave=function(){this.isHovering=!1},t.prototype.notifyTouch=function(){this.isTouching=!0,this.touchBeginX=this.x,this.touchBeginY=this.y},t.prototype.notifyRelease=function(){this.isTouching=!1,this.isDragging=!1,this.dragX=0,this.dragY=0},t.prototype.notifyMove=function(t,e){this.prevX=this.x,this.prevY=this.y,this.x=t,this.y=e,this.velocityX=this.x-this.prevX,this.velocityY=this.y-this.prevY,this.isTouching&&(this.isDragging=!0),this.isDragging&&(this.dragX=this.x-this.touchBeginX,this.dragY=this.y-this.touchBeginY)},t.prototype.notifyTouchForce=function(t){this.touchForce=t},t}(),e.Pointer=n}(alm||(alm={}));
//# sourceMappingURL=alumican.canvas.min.js.map
