var alm,__extends=this&&this.__extends||function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}();!function(t){var c,i,e,r,s,n;function p(t,e,n,o){void 0===e&&(e=!0),void 0===n&&(n=!0),void 0===o&&(o=null);var h=i.call(this)||this;return h.mouseOverHandler=function(t){h.getMousePointer(t)},h.mouseOutHandler=function(t){var e=h.getMousePointer(t);delete h.pointersById[h.mousePointerId];var n=h.pointerIds.indexOf(h.mousePointerId);-1!=n&&h.pointerIds.splice(n,1),--h.pointingCount,e.notifyLeave(),h.onPointerLeave(e)},h.mouseDownHandler=function(t){var e=h.getMousePointer(t);e.notifyTouch(),h.onPointerTouch(e)},h.mouseUpHandler=function(t){var e=h.getMousePointer(t);e.notifyRelease(),h.onPointerRelease(e)},h.mouseMoveHandler=function(t){var e=h.getMousePointer(t),n=h.getMousePointerPosition(t);e.notifyMove(n[0],n[1]),h.onPointerMove(e),e.isDragging&&h.onPointerDrag(e)},h.touchStartHandler=function(t){for(var e,n,o,i=t.originalEvent,r=i.changedTouches,s=i.changedTouches.length,a=0;a<s;++a){e=r.item(a),n=p.getPointerId(e.identifier),o=new c.Pointer(n),h.pointersById[n]=o,h.pointerIds.push(n),++h.pointingCount;var u=h.getTouchPointerPosition(e);o.notifyEnter(u[0],u[1]),o.notifyTouch(),h.onPointerEnter(o),h.onPointerTouch(o)}},h.touchEndHandler=function(t){for(var e,n,o,i=t.originalEvent,r=i.changedTouches,s=i.changedTouches.length,a=0;a<s;++a){e=r.item(a),n=p.getPointerId(e.identifier),o=h.pointersById[n],delete h.pointersById[n];var u=h.pointerIds.indexOf(n);-1!=u&&h.pointerIds.splice(u,1),--h.pointingCount,o.notifyRelease(),o.notifyLeave(),h.onPointerRelease(o),h.onPointerLeave(o)}},h.touchCancelHandler=function(t){h.touchEndHandler(t)},h.touchMoveHandler=function(t){h.isDefaultTouchEventEnabled||t.originalEvent.preventDefault();for(var e,n,o,i=t.originalEvent,r=i.changedTouches,s=i.changedTouches.length,a=0;a<s;++a){e=r.item(a),n=p.getPointerId(e.identifier),o=h.pointersById[n];var u=h.getTouchPointerPosition(e);o.notifyMove(u[0],u[1]),o.isDragging&&h.onPointerDrag(o)}},h.touchForceChangeHandler=function(t){for(var e,n,o,i=t.originalEvent,r=i.changedTouches,s=i.changedTouches.length,a=0;a<s;++a)e=r.item(a),n=p.getPointerId(e.identifier),(o=h.pointersById[n])&&(o.notifyTouchForce(e.force),h.onPointerTouchForceChange(o))},h.keyDownHandler=function(t){h.onKeyDown(t.key)},h.keyUpHandler=function(t){h.onKeyUp(t.key)},h.requestAnimationFrameHandler=function(){h.update(),window.requestAnimationFrame(h.requestAnimationFrameHandler)},h.resizeHandler=function(t){var e=h.canvas.width(),n=h.canvas.height();h.stageWidth==e&&h.stageHeight==n||h.resize(e,n)},h.visibilityStateChangeHandler=function(t){h.visibilityState=document.visibilityState,h.onVisibilityStateChange(h.visibilityState)},h.window=jQuery(window),h.canvas=jQuery(t),h.isAutoResizeEnabled=e,h.isAutoUpdateEnabled=n,h.isDefaultTouchEventEnabled=!1,h.pointerIds=[],h.pointersById={},h.pointingCount=0,h.elapsedFrameCount=0,h.startTime=s.now(),h.mousePointerId="mouse",h.isTouchEnabled=r.getIsTouchEnabled(),h.isForceTouchEnabled=void 0!==t.ontouchforcechange,h.visibilityState=document.visibilityState,trace("[BaseApp] canvas : ",t),trace("[BaseApp] platformSetupOptions : ",o),trace("[BaseApp] isAutoResizeEnabled : "+h.isAutoResizeEnabled),trace("[BaseApp] isAutoUpdateEnabled : "+h.isAutoUpdateEnabled),trace("[BaseApp] isTouchEnabled : "+h.isTouchEnabled),trace("[BaseApp] isForceTouchEnabled : "+h.isForceTouchEnabled),h.isTouchEnabled?(h.canvas.on("touchstart",h.touchStartHandler),h.canvas.on("touchend",h.touchEndHandler),h.canvas.on("touchcancel",h.touchCancelHandler),h.canvas.on("touchmove",h.touchMoveHandler),h.isForceTouchEnabled&&h.canvas.on("touchforcechange",h.touchForceChangeHandler)):(h.canvas.on("mouseover",h.mouseOverHandler),h.canvas.on("mouseout",h.mouseOutHandler),h.canvas.on("mousedown",h.mouseDownHandler),h.canvas.on("mouseup",h.mouseUpHandler),h.canvas.on("mousemove",h.mouseMoveHandler)),h.window.on("keydown",h.keyDownHandler),h.window.on("keyup",h.keyUpHandler),jQuery(document).on("visibilitychange",h.visibilityStateChangeHandler),h.isAutoUpdateEnabled&&window.requestAnimationFrame(h.requestAnimationFrameHandler),h.onPlatformSetup(o||[]),h.onSetup(),h.isAutoResizeEnabled&&(h.window.on("resize",h.resizeHandler),h.resizeHandler(null)),h}c=t.canvas||(t.canvas={}),e=t.event.EventDispatcher,r=t.browser.DeviceInfo,s=t.util.Time,__extends(p,i=e),p.prototype.onSetup=function(){},p.prototype.onUpdate=function(){},p.prototype.onPointerEnter=function(t){},p.prototype.onPointerLeave=function(t){},p.prototype.onPointerTouch=function(t){},p.prototype.onPointerRelease=function(t){},p.prototype.onPointerMove=function(t){},p.prototype.onPointerDrag=function(t){},p.prototype.onPointerTouchForceChange=function(t){},p.prototype.onKeyDown=function(t){},p.prototype.onKeyUp=function(t){},p.prototype.onResize=function(t,e){},p.prototype.onVisibilityStateChange=function(t){},p.prototype.onPlatformSetup=function(t){},p.prototype.onPlatformRender=function(){},p.prototype.onPlatformResize=function(t,e){},p.prototype.update=function(){++this.elapsedFrameCount,this.elapsedTime=(s.now()-this.startTime)/1e3,this.onUpdate(),this.onPlatformRender()},p.prototype.resize=function(t,e){this.stageWidth=t,this.stageHeight=e,trace("[BaseApp] resize : width = "+this.stageWidth+", height = "+this.stageHeight),this.onPlatformResize(this.stageWidth,this.stageHeight),this.onResize(this.stageWidth,this.stageHeight)},p.prototype.getMousePointer=function(t){var e=this.pointersById[this.mousePointerId];if(null==e){e=new c.Pointer(this.mousePointerId),this.pointersById[this.mousePointerId]=e,this.pointerIds.push(this.mousePointerId),++this.pointingCount;var n=this.getMousePointerPosition(t);e.notifyEnter(n[0],n[1]),this.onPointerEnter(e)}return e},p.prototype.getTouchPointerPosition=function(t){var e=this.getCanvas().offset();return[t.pageX-e.left,t.pageY-e.top]},p.prototype.getMousePointerPosition=function(t){var e=this.getCanvas().offset();return[t.pageX-e.left,t.pageY-e.top]},p.getPointerId=function(t){return"touch_"+t},p.prototype.getPointerIds=function(){return this.pointerIds},p.prototype.getFirstPointer=function(){return 0<this.pointingCount?this.getPointerById(this.pointerIds[0]):null},p.prototype.getLastPointer=function(){return 0<this.pointingCount?this.getPointerById(this.pointerIds[this.pointingCount-1]):null},p.prototype.getPointerById=function(t){return this.pointersById[t]},p.prototype.getPointingCount=function(){return this.pointingCount},p.prototype.getStageWidth=function(){return this.stageWidth},p.prototype.getStageHeight=function(){return this.stageHeight},p.prototype.getElapsedFrameCount=function(){return this.elapsedFrameCount},p.prototype.getElapsedTime=function(){return this.elapsedTime},p.prototype.getCanvas=function(){return this.canvas},p.prototype.getVisibilityState=function(){return this.visibilityState},p.prototype.getIsAutoResizeEnabled=function(){return this.isAutoResizeEnabled},p.prototype.getIsAutoUpdateEnabled=function(){return this.isAutoUpdateEnabled},p.prototype.getIsForceTouchEnabled=function(){return this.isForceTouchEnabled},p.prototype.getIsTouchEnabled=function(){return this.isTouchEnabled},p.prototype.getIsDefaultTouchEventEnabled=function(){return this.isDefaultTouchEventEnabled},p.prototype.setIsDefaultTouchEventEnabled=function(t){this.isDefaultTouchEventEnabled=t},n=p,c.BaseApp=n}(alm=alm||{}),function(t){var e,n;function o(t){this.id=t,this.isHovering=!1,this.isTouching=!1,this.isDragging=!1,this.x=0,this.y=0,this.prevX=0,this.prevY=0,this.dragX=0,this.dragY=0,this.velocityX=0,this.velocityY=0,this.touchBeginX=0,this.touchBeginY=0,this.touchForce=0}e=t.canvas||(t.canvas={}),o.prototype.notifyEnter=function(t,e){this.prevX=this.x=t,this.prevY=this.y=e,this.isHovering=!0},o.prototype.notifyLeave=function(){this.isHovering=!1},o.prototype.notifyTouch=function(){this.isTouching=!0,this.touchBeginX=this.x,this.touchBeginY=this.y},o.prototype.notifyRelease=function(){this.isTouching=!1,this.isDragging=!1,this.dragX=0,this.dragY=0},o.prototype.notifyMove=function(t,e){this.prevX=this.x,this.prevY=this.y,this.x=t,this.y=e,this.velocityX=this.x-this.prevX,this.velocityY=this.y-this.prevY,this.isTouching&&(this.isDragging=!0),this.isDragging&&(this.dragX=this.x-this.touchBeginX,this.dragY=this.y-this.touchBeginY)},o.prototype.notifyTouchForce=function(t){this.touchForce=t},n=o,e.Pointer=n}(alm=alm||{});
//# sourceMappingURL=alumican.canvas.min.js.map
