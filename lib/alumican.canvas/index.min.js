var alm,__extends=this&&this.__extends||function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}();!function(t){var u,i,e,r,s;function h(t,e,n,o){void 0===e&&(e=!0),void 0===n&&(n=!0),void 0===o&&(o=null);var a=i.call(this)||this;return a.mouseOverHandler=function(t){a.getMousePointer(t)},a.mouseOutHandler=function(t){var e=a.getMousePointer(t);delete a.pointersById[a.mousePointerId];t=a.pointerIds.indexOf(a.mousePointerId);-1!=t&&a.pointerIds.splice(t,1),--a.pointingCount,e.notifyLeave(),a.onPointerLeave(e)},a.mouseDownHandler=function(t){t=a.getMousePointer(t);t.notifyTouch(),a.onPointerTouch(t)},a.mouseUpHandler=function(t){t=a.getMousePointer(t);t.notifyRelease(),a.onPointerRelease(t)},a.mouseMoveHandler=function(t){var e=a.getMousePointer(t),t=a.getMousePointerPosition(t);e.notifyMove(t[0],t[1]),a.onPointerMove(e),e.isDragging&&a.onPointerDrag(e)},a.touchStartHandler=function(t){for(var e,n,t=t.originalEvent,o=t.changedTouches,i=t.changedTouches.length,r=0;r<i;++r){s=o.item(r),e=h.getPointerId(s.identifier),n=new u.Pointer(e),a.pointersById[e]=n,a.pointerIds.push(e),++a.pointingCount;var s=a.getTouchPointerPosition(s);n.notifyEnter(s[0],s[1]),n.notifyTouch(),a.onPointerEnter(n),a.onPointerTouch(n)}},a.touchEndHandler=function(t){for(var e,t=t.originalEvent,n=t.changedTouches,o=t.changedTouches.length,i=0;i<o;++i){e=n.item(i),r=h.getPointerId(e.identifier),e=a.pointersById[r],delete a.pointersById[r];var r=a.pointerIds.indexOf(r);-1!=r&&a.pointerIds.splice(r,1),--a.pointingCount,e.notifyRelease(),e.notifyLeave(),a.onPointerRelease(e),a.onPointerLeave(e)}},a.touchCancelHandler=function(t){a.touchEndHandler(t)},a.touchMoveHandler=function(t){a.isDefaultTouchEventEnabled||t.originalEvent.preventDefault();for(var t=t.originalEvent,e=t.changedTouches,n=t.changedTouches.length,o=0;o<n;++o){var i=e.item(o),r=h.getPointerId(i.identifier),r=a.pointersById[r],i=a.getTouchPointerPosition(i);r.notifyMove(i[0],i[1]),r.isDragging&&a.onPointerDrag(r)}},a.touchForceChangeHandler=function(t){for(var e,n,t=t.originalEvent,o=t.changedTouches,i=t.changedTouches.length,r=0;r<i;++r)e=o.item(r),n=h.getPointerId(e.identifier),(n=a.pointersById[n])&&(n.notifyTouchForce(e.force),a.onPointerTouchForceChange(n))},a.keyDownHandler=function(t){a.onKeyDown(t.key)},a.keyUpHandler=function(t){a.onKeyUp(t.key)},a.requestAnimationFrameHandler=function(){a.update(),window.requestAnimationFrame(a.requestAnimationFrameHandler)},a.resizeHandler=function(t){var e=a.canvas.width(),n=a.canvas.height();a.stageWidth==e&&a.stageHeight==n||a.resize(e,n)},a.visibilityStateChangeHandler=function(t){a.visibilityState=document.visibilityState,a.onVisibilityStateChange(a.visibilityState)},a.window=jQuery(window),a.canvas=jQuery(t),a.isAutoResizeEnabled=e,a.isAutoUpdateEnabled=n,a.isDefaultTouchEventEnabled=!1,a.pointerIds=[],a.pointersById={},a.pointingCount=0,a.elapsedFrameCount=0,a.startTime=s.now(),a.mousePointerId="mouse",a.isTouchEnabled=r.getIsTouchEnabled(),a.isForceTouchEnabled=void 0!==t.ontouchforcechange,a.visibilityState=document.visibilityState,trace("[BaseApp] canvas : ",t),trace("[BaseApp] platformSetupOptions : ",o),trace("[BaseApp] isAutoResizeEnabled : "+a.isAutoResizeEnabled),trace("[BaseApp] isAutoUpdateEnabled : "+a.isAutoUpdateEnabled),trace("[BaseApp] isTouchEnabled : "+a.isTouchEnabled),trace("[BaseApp] isForceTouchEnabled : "+a.isForceTouchEnabled),a.isTouchEnabled?(a.canvas.on("touchstart",a.touchStartHandler),a.canvas.on("touchend",a.touchEndHandler),a.canvas.on("touchcancel",a.touchCancelHandler),a.canvas.on("touchmove",a.touchMoveHandler),a.isForceTouchEnabled&&a.canvas.on("touchforcechange",a.touchForceChangeHandler)):(a.canvas.on("mouseover",a.mouseOverHandler),a.canvas.on("mouseout",a.mouseOutHandler),a.canvas.on("mousedown",a.mouseDownHandler),a.canvas.on("mouseup",a.mouseUpHandler),a.canvas.on("mousemove",a.mouseMoveHandler)),a.window.on("keydown",a.keyDownHandler),a.window.on("keyup",a.keyUpHandler),jQuery(document).on("visibilitychange",a.visibilityStateChangeHandler),a.isAutoUpdateEnabled&&window.requestAnimationFrame(a.requestAnimationFrameHandler),a.onPlatformSetup(o||[]),a.onSetup(),a.isAutoResizeEnabled&&(a.window.on("resize",a.resizeHandler),a.resizeHandler(null)),a}u=t.canvas||(t.canvas={}),e=t.event.EventDispatcher,r=t.browser.DeviceInfo,s=t.util.Time,__extends(h,i=e),h.prototype.onSetup=function(){},h.prototype.onUpdate=function(){},h.prototype.onPointerEnter=function(t){},h.prototype.onPointerLeave=function(t){},h.prototype.onPointerTouch=function(t){},h.prototype.onPointerRelease=function(t){},h.prototype.onPointerMove=function(t){},h.prototype.onPointerDrag=function(t){},h.prototype.onPointerTouchForceChange=function(t){},h.prototype.onKeyDown=function(t){},h.prototype.onKeyUp=function(t){},h.prototype.onResize=function(t,e){},h.prototype.onVisibilityStateChange=function(t){},h.prototype.onPlatformSetup=function(t){},h.prototype.onPlatformRender=function(){},h.prototype.onPlatformResize=function(t,e){},h.prototype.update=function(){++this.elapsedFrameCount,this.elapsedTime=(s.now()-this.startTime)/1e3,this.onUpdate(),this.onPlatformRender()},h.prototype.resize=function(t,e){this.stageWidth=t,this.stageHeight=e,trace("[BaseApp] resize : width = "+this.stageWidth+", height = "+this.stageHeight),this.onPlatformResize(this.stageWidth,this.stageHeight),this.onResize(this.stageWidth,this.stageHeight)},h.prototype.getMousePointer=function(t){var e=this.pointersById[this.mousePointerId];return null==e&&(e=new u.Pointer(this.mousePointerId),this.pointersById[this.mousePointerId]=e,this.pointerIds.push(this.mousePointerId),++this.pointingCount,t=this.getMousePointerPosition(t),e.notifyEnter(t[0],t[1]),this.onPointerEnter(e)),e},h.prototype.getTouchPointerPosition=function(t){var e=this.getCanvas().offset();return[t.pageX-e.left,t.pageY-e.top]},h.prototype.getMousePointerPosition=function(t){var e=this.getCanvas().offset();return[t.pageX-e.left,t.pageY-e.top]},h.getPointerId=function(t){return"touch_"+t},h.prototype.getPointerIds=function(){return this.pointerIds},h.prototype.getFirstPointer=function(){return 0<this.pointingCount?this.getPointerById(this.pointerIds[0]):null},h.prototype.getLastPointer=function(){return 0<this.pointingCount?this.getPointerById(this.pointerIds[this.pointingCount-1]):null},h.prototype.getPointerById=function(t){return this.pointersById[t]},h.prototype.getPointingCount=function(){return this.pointingCount},h.prototype.getStageWidth=function(){return this.stageWidth},h.prototype.getStageHeight=function(){return this.stageHeight},h.prototype.getElapsedFrameCount=function(){return this.elapsedFrameCount},h.prototype.getElapsedTime=function(){return this.elapsedTime},h.prototype.getCanvas=function(){return this.canvas},h.prototype.getVisibilityState=function(){return this.visibilityState},h.prototype.getIsAutoResizeEnabled=function(){return this.isAutoResizeEnabled},h.prototype.getIsAutoUpdateEnabled=function(){return this.isAutoUpdateEnabled},h.prototype.getIsForceTouchEnabled=function(){return this.isForceTouchEnabled},h.prototype.getIsTouchEnabled=function(){return this.isTouchEnabled},h.prototype.getIsDefaultTouchEventEnabled=function(){return this.isDefaultTouchEventEnabled},h.prototype.setIsDefaultTouchEventEnabled=function(t){this.isDefaultTouchEventEnabled=t},e=h,u.BaseApp=e}(alm=alm||{}),function(t){function e(t){this.id=t,this.isHovering=!1,this.isTouching=!1,this.isDragging=!1,this.x=0,this.y=0,this.prevX=0,this.prevY=0,this.dragX=0,this.dragY=0,this.velocityX=0,this.velocityY=0,this.touchBeginX=0,this.touchBeginY=0,this.touchForce=0}t=t.canvas||(t.canvas={}),e.prototype.notifyEnter=function(t,e){this.prevX=this.x=t,this.prevY=this.y=e,this.isHovering=!0},e.prototype.notifyLeave=function(){this.isHovering=!1},e.prototype.notifyTouch=function(){this.isTouching=!0,this.touchBeginX=this.x,this.touchBeginY=this.y},e.prototype.notifyRelease=function(){this.isTouching=!1,this.isDragging=!1,this.dragX=0,this.dragY=0},e.prototype.notifyMove=function(t,e){this.prevX=this.x,this.prevY=this.y,this.x=t,this.y=e,this.velocityX=this.x-this.prevX,this.velocityY=this.y-this.prevY,this.isTouching&&(this.isDragging=!0),this.isDragging&&(this.dragX=this.x-this.touchBeginX,this.dragY=this.y-this.touchBeginY)},e.prototype.notifyTouchForce=function(t){this.touchForce=t},t.Pointer=e}(alm=alm||{});
//# sourceMappingURL=index.min.js.map
