{"version":3,"sources":["../src/alumican.canvas/alm/canvas/Pointer.ts","../src/alumican.canvas/alm/canvas/BaseApp.ts"],"names":["alm","canvas","BaseApp","_super","canvasId","isAutoResizeEnabled","platformSetupOptions","_i","arguments","length","_this","call","this","mouseOverHandler","event","getMousePointer","mouseOutHandler","pointer","pointersById","mousePointerId","pointerIndex","pointerIds","indexOf","splice","pointingCount","notifyLeave","onPointerLeave","mouseDownHandler","notifyTouch","onPointerTouch","mouseUpHandler","notifyRelease","onPointerRelease","mouseMoveHandler","notifyMove","clientX","clientY","onPointerMove","isDragging","onPointerDrag","touchStartHandler","touch","id","touches","changedTouches","touchCount","i","item","getPointerId","identifier","Pointer","push","notifyEnter","onPointerEnter","touchEndHandler","touchCancelHandler","touchMoveHandler","touchForceChangeHandler","notifyTouchForce","force","onPointerTouchForceChange","canvasTouchMoveHandler","originalEvent","preventDefault","keyDownHandler","onKeyDown","key","keyUpHandler","onKeyUp","resizeHandler","resize","$","window","width","height","requestAnimationFrame","elapsedFrameCount","elapsedTime","Date","getTime","startTime","onUpdate","onPlatformRender","jQuery","trace","on","onPlatformSetup","apply","onSetup","__extends","prototype","onResize","stageWidth","stageHeight","onPlatformResize","touchId","getPointerIds","getFirstPointer","getPointerById","getLastPointer","getPointingCount","getStageWidth","getStageHeight","getElapsedFrameCount","getElapsedTime","getCanvas","getIsAutoResizeEnabled","setIsAutoResizeEnabled","value","EventDispatcher","isHovering","isTouching","x","y","prevX","prevY","dragX","dragY","velocityX","velocityY","touchBeginX","touchBeginY","touchForce"],"mappings":"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","file":"alumican.canvas.min.js","sourcesContent":["/// <reference path=\"../../include.ts\" />\n\nnamespace alm.canvas {\n\n\texport class Pointer {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(id:string) {\n\t\t\tthis.id = id;\n\n\t\t\tthis.isHovering = false;\n\t\t\tthis.isTouching = false;\n\t\t\tthis.isDragging = false;\n\n\t\t\tthis.x = 0;\n\t\t\tthis.y = 0;\n\n\t\t\tthis.prevX = 0;\n\t\t\tthis.prevY = 0;\n\n\t\t\tthis.dragX = 0;\n\t\t\tthis.dragY = 0;\n\n\t\t\tthis.velocityX = 0;\n\t\t\tthis.velocityY = 0;\n\n\t\t\tthis.touchBeginX = 0;\n\t\t\tthis.touchBeginY = 0;\n\n\t\t\tthis.touchForce = 0;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic notifyEnter(x:number, y:number):void {\n\t\t\tthis.prevX = this.x = x;\n\t\t\tthis.prevY = this.y = y;\n\t\t\tthis.isHovering = true;\n\t\t}\n\n\t\tpublic notifyLeave():void {\n\t\t\tthis.isHovering = false;\n\t\t}\n\n\t\tpublic notifyTouch():void {\n\t\t\tthis.isTouching = true;\n\t\t\tthis.touchBeginX = this.x;\n\t\t\tthis.touchBeginY = this.y;\n\t\t}\n\n\t\tpublic notifyRelease():void {\n\t\t\tthis.isTouching = false;\n\t\t\tthis.isDragging = false;\n\t\t\tthis.dragX = 0;\n\t\t\tthis.dragY = 0;\n\t\t}\n\n\t\tpublic notifyMove(x:number, y:number):void {\n\t\t\tthis.prevX = this.x;\n\t\t\tthis.prevY = this.y;\n\n\t\t\tthis.x = x;\n\t\t\tthis.y = y;\n\n\t\t\tthis.velocityX = this.x - this.prevX;\n\t\t\tthis.velocityY = this.y - this.prevY;\n\n\t\t\tif (this.isTouching) {\n\t\t\t\tthis.isDragging = true;\n\t\t\t}\n\n\t\t\tif (this.isDragging) {\n\t\t\t\tthis.dragX = this.x - this.touchBeginX;\n\t\t\t\tthis.dragY = this.y - this.touchBeginY;\n\t\t\t}\n\t\t}\n\n\t\tpublic notifyTouchForce(force:number):void {\n\t\t\tthis.touchForce = force;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic id:string;\n\t\tpublic isHovering:boolean;\n\t\tpublic isTouching:boolean;\n\t\tpublic isDragging:boolean;\n\n\t\tpublic x:number;\n\t\tpublic y:number;\n\n\t\tpublic prevX:number;\n\t\tpublic prevY:number;\n\n\t\tpublic dragX:number;\n\t\tpublic dragY:number;\n\n\t\tpublic velocityX:number;\n\t\tpublic velocityY:number;\n\n\t\tpublic touchBeginX:number;\n\t\tpublic touchBeginY:number;\n\n\t\tpublic touchForce:number;\n\t}\n}","/// <reference path=\"../../include.ts\" />\n\nnamespace alm.canvas {\n\n\timport EventDispatcher = alm.event.EventDispatcher;\n\n\texport abstract class BaseApp extends EventDispatcher {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(canvasId:string, isAutoResizeEnabled:boolean = true, ...platformSetupOptions:any[]) {\n\t\t\tsuper();\n\n\t\t\tthis.canvas = <JQuery<HTMLCanvasElement>>jQuery(canvasId);\n\t\t\tthis.isAutoResizeEnabled = isAutoResizeEnabled;\n\n\t\t\ttrace(\"[BaseApp] canvasId : \" + canvasId);\n\t\t\ttrace(\"[BaseApp] isAutoResizeEnabled : \" + this.isAutoResizeEnabled);\n\n\t\t\tthis.pointerIds = [];\n\t\t\tthis.pointersById = {};\n\t\t\tthis.pointingCount = 0;\n\n\t\t\tthis.elapsedFrameCount = 0;\n\t\t\tthis.startTime = new Date().getTime();\n\t\t\tthis.mousePointerId = 'mouse';\n\n\t\t\tjQuery(window).on('mouseover', this.mouseOverHandler);\n\t\t\tjQuery(window).on('mouseout', this.mouseOutHandler);\n\t\t\tjQuery(window).on('mousedown', this.mouseDownHandler);\n\t\t\tjQuery(window).on('mouseup', this.mouseUpHandler);\n\t\t\tjQuery(window).on('mousemove', this.mouseMoveHandler);\n\t\t\tjQuery(window).on('touchstart', this.touchStartHandler);\n\t\t\tjQuery(window).on('touchend', this.touchEndHandler);\n\t\t\tjQuery(window).on('touchcancel', this.touchCancelHandler);\n\t\t\tjQuery(window).on('touchmove', this.touchMoveHandler);\n\t\t\tjQuery(window).on('touchforcechange', this.touchForceChangeHandler);\n\t\t\tjQuery(window).on('keydown', this.keyDownHandler);\n\t\t\tjQuery(window).on('keyup', this.keyUpHandler);\n\t\t\tthis.canvas.on('touchmove', this.canvasTouchMoveHandler);\n\t\t\trequestAnimationFrame(this.requestAnimationFrame);\n\n\t\t\tthis.onPlatformSetup.apply(this, platformSetupOptions);\n\t\t\tthis.onSetup();\n\n\t\t\tif (this.isAutoResizeEnabled) {\n\t\t\t\tjQuery(window).on('resize', this.resizeHandler);\n\t\t\t\tthis.resizeHandler(null);\n\t\t\t}\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic onSetup():void {\n\t\t}\n\n\t\tpublic onUpdate():void {\n\t\t}\n\n\t\tpublic onPointerEnter(pointer:Pointer):void {\n\t\t}\n\n\t\tpublic onPointerLeave(pointer:Pointer,):void {\n\t\t}\n\n\t\tpublic onPointerTouch(pointer:Pointer):void {\n\t\t}\n\n\t\tpublic onPointerRelease(pointer:Pointer):void {\n\t\t}\n\n\t\tpublic onPointerMove(pointer:Pointer):void {\n\t\t}\n\n\t\tpublic onPointerDrag(pointer:Pointer):void {\n\t\t}\n\n\t\tpublic onPointerTouchForceChange(pointer:Pointer):void {\n\t\t}\n\n\t\tpublic onKeyDown(key:string):void {\n\t\t}\n\n\t\tpublic onKeyUp(key:string):void {\n\t\t}\n\n\t\tpublic onResize(stageWidth:number, stageHeight:number):void {\n\t\t}\n\n\t\tprotected onPlatformSetup(...platformSetupOptions:any[]):void {\n\t\t}\n\n\t\tprotected onPlatformRender():void {\n\t\t}\n\n\t\tprotected onPlatformResize(stageWidth:number, stageHeight:number):void {\n\t\t}\n\n\t\tpublic resize(width:number, height:number):void {\n\t\t\tthis.stageWidth = width;\n\t\t\tthis.stageHeight = height;\n\t\t\ttrace('[BaseApp] resize : width = ' + this.stageWidth + ', height = ' + this.stageHeight);\n\t\t\tthis.onPlatformResize(this.stageWidth, this.stageHeight);\n\t\t\tthis.onResize(this.stageWidth, this.stageHeight);\n\t\t}\n\n\t\t// --------------------------------------------------\n\t\t// Mouse Event\n\n\t\tprivate mouseOverHandler = (event:JQuery.Event):void => {\n\t\t\tconst pointer:Pointer = this.getMousePointer(event);\n\t\t};\n\n\t\tprivate mouseOutHandler = (event:JQuery.Event):void => {\n\t\t\tconst pointer:Pointer = this.getMousePointer(event);\n\t\t\tdelete this.pointersById[this.mousePointerId];\n\t\t\tconst pointerIndex = this.pointerIds.indexOf(this.mousePointerId);\n\t\t\tif (pointerIndex != -1) {\n\t\t\t\tthis.pointerIds.splice(pointerIndex, 1);\n\t\t\t}\n\t\t\t--this.pointingCount;\n\t\t\tpointer.notifyLeave();\n\t\t\tthis.onPointerLeave(pointer);\n\t\t};\n\n\t\tprivate mouseDownHandler = (event:JQuery.Event):void => {\n\t\t\tconst pointer:Pointer = this.getMousePointer(event);\n\t\t\tpointer.notifyTouch();\n\t\t\tthis.onPointerTouch(pointer);\n\t\t};\n\n\t\tprivate mouseUpHandler = (event:JQuery.Event):void => {\n\t\t\tconst pointer:Pointer = this.getMousePointer(event);\n\t\t\tpointer.notifyRelease();\n\t\t\tthis.onPointerRelease(pointer);\n\t\t};\n\n\t\tprivate mouseMoveHandler = (event:JQuery.Event):void => {\n\t\t\tconst pointer:Pointer = this.getMousePointer(event);\n\t\t\tpointer.notifyMove(event.clientX, event.clientY);\n\t\t\tthis.onPointerMove(pointer);\n\t\t\tif (pointer.isDragging) {\n\t\t\t\tthis.onPointerDrag(pointer);\n\t\t\t}\n\t\t};\n\n\t\t// --------------------------------------------------\n\t\t// Touch Event\n\n\t\tprivate touchStartHandler = (event:JQuery.Event):void => {\n\t\t\tconst touches:TouchList = event.changedTouches;\n\t\t\tconst touchCount:number = event.changedTouches.length;\n\t\t\tlet touch:Touch;\n\t\t\tlet id:string;\n\t\t\tlet pointer:Pointer;\n\t\t\tfor (let i:number = 0; i < touchCount; ++i) {\n\t\t\t\ttouch = touches.item(i);\n\t\t\t\tid = BaseApp.getPointerId(touch.identifier);\n\t\t\t\tpointer = new Pointer(id);\n\t\t\t\tthis.pointersById[id] = pointer;\n\t\t\t\tthis.pointerIds.push(id);\n\t\t\t\t++this.pointingCount;\n\t\t\t\tpointer.notifyEnter(touch.clientX, touch.clientY);\n\t\t\t\tpointer.notifyTouch();\n\t\t\t\tthis.onPointerEnter(pointer);\n\t\t\t\tthis.onPointerTouch(pointer);\n\t\t\t}\n\t\t};\n\n\t\tprivate touchEndHandler = (event:JQuery.Event):void => {\n\t\t\tconst touches:TouchList = event.changedTouches;\n\t\t\tconst touchCount:number = event.changedTouches.length;\n\t\t\tlet touch:Touch;\n\t\t\tlet id:string;\n\t\t\tlet pointer:Pointer;\n\t\t\tfor (let i:number = 0; i < touchCount; ++i) {\n\t\t\t\ttouch = touches.item(i);\n\t\t\t\tid = BaseApp.getPointerId(touch.identifier);\n\t\t\t\tpointer = this.pointersById[id];\n\t\t\t\tdelete this.pointersById[id];\n\t\t\t\tconst pointerIndex = this.pointerIds.indexOf(id);\n\t\t\t\tif (pointerIndex != -1) {\n\t\t\t\t\tthis.pointerIds.splice(pointerIndex, 1);\n\t\t\t\t}\n\t\t\t\t--this.pointingCount;\n\t\t\t\tpointer.notifyRelease();\n\t\t\t\tpointer.notifyLeave();\n\t\t\t\tthis.onPointerRelease(pointer);\n\t\t\t\tthis.onPointerLeave(pointer);\n\t\t\t}\n\t\t};\n\n\t\tprivate touchCancelHandler = (event:JQuery.Event):void => {\n\t\t\tthis.touchEndHandler(event);\n\t\t};\n\n\t\tprivate touchMoveHandler = (event:JQuery.Event):void => {\n\t\t\tconst touches:TouchList = event.changedTouches;\n\t\t\tconst touchCount:number = event.changedTouches.length;\n\t\t\tlet touch:Touch;\n\t\t\tlet id:string;\n\t\t\tlet pointer:Pointer;\n\t\t\tfor (let i:number = 0; i < touchCount; ++i) {\n\t\t\t\ttouch = touches.item(i);\n\t\t\t\tid = BaseApp.getPointerId(touch.identifier);\n\t\t\t\tpointer = this.pointersById[id];\n\t\t\t\tpointer.notifyMove(touch.clientX, touch.clientY);\n\t\t\t\tif (pointer.isDragging) {\n\t\t\t\t\tthis.onPointerDrag(pointer);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tprivate touchForceChangeHandler = (event:JQuery.Event):void => {\n\t\t\tconst touches:TouchList = event.changedTouches;\n\t\t\tconst touchCount:number = event.changedTouches.length;\n\t\t\tlet touch:Touch;\n\t\t\tlet id:string;\n\t\t\tlet pointer:Pointer;\n\t\t\tfor (let i:number = 0; i < touchCount; ++i) {\n\t\t\t\ttouch = touches.item(i);\n\t\t\t\tid = BaseApp.getPointerId(touch.identifier);\n\t\t\t\tpointer = this.pointersById[id];\n\t\t\t\tpointer.notifyTouchForce(touch.force);\n\t\t\t\tthis.onPointerTouchForceChange(pointer);\n\t\t\t}\n\t\t};\n\n\t\tprivate canvasTouchMoveHandler = (event:JQuery.Event):void => {\n\t\t\tevent.originalEvent.preventDefault();\n\t\t};\n\n\t\t// --------------------------------------------------\n\t\t// Key Event\n\n\t\tprivate keyDownHandler = (event:JQuery.Event):void => {\n\t\t\tthis.onKeyDown(event.key);\n\t\t};\n\n\t\tprivate keyUpHandler = (event:JQuery.Event):void => {\n\t\t\tthis.onKeyUp(event.key);\n\t\t};\n\n\t\t// --------------------------------------------------\n\t\t// Other Event\n\n\t\tprivate resizeHandler = (event:JQuery.Event):void => {\n\t\t\tthis.resize($(window).width(), $(window).height());\n\t\t};\n\n\t\tprivate requestAnimationFrame = ():void => {\n\t\t\t++this.elapsedFrameCount;\n\t\t\tthis.elapsedTime = (new Date().getTime() - this.startTime) / 1000;\n\t\t\tthis.onUpdate();\n\t\t\tthis.onPlatformRender();\n\t\t\trequestAnimationFrame(this.requestAnimationFrame);\n\t\t};\n\n\t\t// --------------------------------------------------\n\t\t// Util\n\n\t\tprivate getMousePointer(event:JQuery.Event):Pointer {\n\t\t\tlet pointer:Pointer = this.pointersById[this.mousePointerId];\n\t\t\tif (pointer == null) {\n\t\t\t\tpointer = new Pointer(this.mousePointerId);\n\t\t\t\tthis.pointersById[this.mousePointerId] = pointer;\n\t\t\t\tthis.pointerIds.push(this.mousePointerId);\n\t\t\t\t++this.pointingCount;\n\t\t\t\tpointer.notifyEnter(event.clientX, event.clientY);\n\t\t\t\tthis.onPointerEnter(pointer);\n\t\t\t}\n\t\t\treturn pointer;\n\t\t}\n\n\t\tpublic static getPointerId(touchId:number):string {\n\t\t\treturn 'touch_' + touchId;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic getPointerIds():string[] { return this.pointerIds; }\n\t\tprivate pointerIds:string[];\n\n\t\tpublic getFirstPointer():Pointer { return this.pointingCount > 0 ? this.getPointerById(this.pointerIds[0]) : null; }\n\t\tpublic getLastPointer():Pointer { return this.pointingCount > 0 ? this.getPointerById(this.pointerIds[this.pointingCount - 1]) : null; }\n\n\t\tpublic getPointerById(id:string):Pointer { return this.pointersById[id]; }\n\t\tprivate pointersById:alm.util.Hash<Pointer>;\n\n\t\tpublic getPointingCount():number { return this.pointingCount; }\n\t\tprivate pointingCount:number;\n\n\t\tpublic getStageWidth():number { return this.stageWidth; }\n\t\tprivate stageWidth:number;\n\n\t\tpublic getStageHeight():number { return this.stageHeight; }\n\t\tprivate stageHeight:number;\n\n\t\tpublic getElapsedFrameCount():number { return this.elapsedFrameCount; }\n\t\tprivate elapsedFrameCount:number;\n\n\t\tpublic getElapsedTime():number { return this.elapsedTime; }\n\t\tprivate elapsedTime:number;\n\n\t\tpublic getCanvas():JQuery<HTMLCanvasElement> { return this.canvas; }\n\t\tprivate canvas:JQuery<HTMLCanvasElement>;\n\n\t\tpublic getIsAutoResizeEnabled():boolean { return this.isAutoResizeEnabled; }\n\t\tpublic setIsAutoResizeEnabled(value:boolean):void { this.isAutoResizeEnabled = value; }\n\t\tprivate isAutoResizeEnabled:boolean;\n\n\t\tprivate startTime:number;\n\t\tprivate mousePointerId:string;\n\t}\n}"]}