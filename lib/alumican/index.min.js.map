{"version":3,"sources":["../src/alumican/alm/util/Time.ts","../src/alumican/cmd/Parallel.ts","../src/alumican/scn/SceneManagerRequireSceneEvent.ts","../src/alumican/index.ts","../src/alumican/alm/debug/Logger.ts","../src/alumican/alm/math/Easing.ts","../src/alumican/alm/browser/QueryString.ts","../src/alumican/alm/debug/FpsMonitor.ts","../src/alumican/alm/event/Event.ts","../src/alumican/alm/event/EventDispatcher.ts","../src/alumican/cmd/CommandState.ts","../src/alumican/cmd/CommandEvent.ts","../src/alumican/cmd/Command.ts","../src/alumican/cmd/CommandList.ts","../src/alumican/cmd/Break.ts","../src/alumican/cmd/Return.ts","../src/alumican/cmd/Log.ts","../src/alumican/cmd/Wait.ts","../src/alumican/cmd/Func.ts","../src/alumican/cmd/Listen.ts","../src/alumican/cmd/Tween.ts","../src/alumican/cmd/If.ts","../src/alumican/cmd/Serial.ts","../src/alumican/alm/geom/Vector2.ts","../src/alumican/alm/geom/Vector3.ts","../src/alumican/alm/geom/Rectangle.ts","../src/alumican/alm/geom/Boxer.ts","../src/alumican/alm/util/Obj.ts","../src/alumican/alm/util/Arr.ts","../src/alumican/alm/util/Num.ts","../src/alumican/alm/util/Str.ts","../src/alumican/alm/util/Cmd.ts","../src/alumican/alm/util/Dom.ts","../src/alumican/alm/util/Cvs.ts","../src/alumican/alm/util/CssVar.ts","../src/alumican/alm/util/Sensor.ts","../src/alumican/alm/resource/ObjectPool.ts","../src/alumican/alm/state/Lottery.ts","../src/alumican/alm/state/Switcher.ts","../src/alumican/alm/state/SwitcherEvent.ts","../src/alumican/alm/state/LoHi.ts","../src/alumican/alm/state/LoHiEvent.ts","../src/alumican/alm/math/EasingValue.ts","../src/alumican/alm/math/SpringValue.ts","../src/alumican/alm/math/MinMax.ts","../src/alumican/alm/math/SimpleAverage.ts","../src/alumican/alm/math/SimpleMovingAverage.ts","../src/alumican/alm/math/MaxValue.ts","../src/alumican/alm/math/Circular.ts","../src/alumican/alm/math/BinarySearch.ts","../src/alumican/alm/math/MersenneTwister.ts","../src/alumican/alm/time/AnimationFrameTicker.ts","../src/alumican/alm/time/AnimationFrameTickerEvent.ts","../src/alumican/alm/time/Timer.ts","../src/alumican/alm/time/TimerEvent.ts","../src/alumican/alm/io/FileLoader.ts","../src/alumican/alm/io/FileLoaderProgressEvent.ts","../src/alumican/alm/io/FileLoaderSuccessEvent.ts","../src/alumican/alm/io/FileLoaderErrorEvent.ts","../src/alumican/alm/io/FileQuery.ts","../src/alumican/alm/io/ImageFileHandler.ts","../src/alumican/alm/view/ViewEvent.ts","../src/alumican/alm/view/View.ts","../src/alumican/alm/view/ButtonBehavior.ts","../src/alumican/alm/view/SelectionBehavior.ts","../src/alumican/alm/browser/DeviceInfo.ts","../src/alumican/alm/browser/LocalStorage.ts","../src/alumican/alm/browser/SessionStorage.ts","../src/alumican/alm/browser/KeyWatcher.ts","../src/alumican/alm/browser/KeyWatcherEvent.ts","../src/alumican/alm/browser/WinWatcher.ts","../src/alumican/alm/browser/WinWatcherEvent.ts","../src/alumican/alm/browser/ScrollSectionTriggerEvent.ts","../src/alumican/alm/browser/ScrollSectionTrigger.ts","../src/alumican/alm/browser/ResponsiveObserver.ts","../src/alumican/alm/browser/ResponsiveObserverEvent.ts","../src/alumican/alm/browser/Kiosk.ts","../src/alumican/scn/Scene.ts","../src/alumican/scn/SceneEvent.ts","../src/alumican/scn/SceneTransferInfo.ts","../src/alumican/scn/SceneState.ts","../src/alumican/scn/core/Direction.ts","../src/alumican/scn/core/Waypoint.ts","../src/alumican/scn/core/RootScene.ts","../src/alumican/scn/SceneManager.ts","../src/alumican/scn/SceneManagerTransferEvent.ts"],"names":["cmd","scn","alm","trace","messages","debug","Logger","info","apply","caller","arguments","throwWarn","target","message","condition","warnIf","throwError","errorIf","util","Time","now","window","performance","Date","constructor","math","Easing","linear","t","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","easeInSine","Math","cos","PI","easeOutSine","sin","easeInOutSine","easeInExpo","pow","easeOutExpo","easeInOutExpo","easeInCirc","sqrt","easeOutCirc","easeInOutCirc","createEaseInElastic","s","let","p","a","asin","createEaseOutElastic","createEaseInOutElastic","easeInElastic","defaultEaseInElastic","easeOutElastic","defaultEaseOutElastic","easeInOutElastic","defaultEaseInOutElastic","createEaseInBack","createEaseOutBack","createEaseInOutBack","easeInBack","defaultEaseInBack","easeOutBack","defaultEaseOutBack","easeInOutBack","defaultEaseInOutBack","easeInBounce","easeOutBounce","easeInOutBounce","browser","QueryString","url","this","set","search","index","pair","indexOf","substring","location","hash","pairs","split","i","getString","key","defaultValue","value","undefined","getInt","parseInt","isNaN","getFloat","parseFloat","getBool","getHash","setHash","setParam","removeParam","hasParam","getReplacedQueryStringUrl","regExp","RegExp","separator","match","replace","replaceQueryString","href","state","history","replaceState","LoggerLevel","NullLogging","verbose","prefix","warn","error","ConsoleLogging","console","Array","prototype","slice","call","concat","log","DOMLogging","dom","html","print","line","join","innerHTML","innerText","ParallelLogging","loggers","n","length","setLevelByQuery","level","silent","setNamespace","namespace","logger","stackTrace","FpsMonitor","reset","frameRate","frameCount","startTime","actualFrameRate","dummyFrameRate","update","currentTime","elapsedTime","setDummyFrameRate","clearDummyFrameRate","getFrameRate","event","Event","type","data","event_1","EventDispatcher","listeners","addEventListener","eventType","listener","numListeners","push","removeEventListener","result","splice","removeAllEventListener","hasEventListener","dispatchEvent","dispatchEventType","eventTarget","CommandState","CommandEvent","super","clone","toString","complete","Command","executeFunction","interruptFunction","destroyFunction","setExecuteFunction","setInterruptFunction","setDestroyFunction","sleeping","self","parent","execute","Error","executing","getExecuteFunction","interrupt","interrupting","getInterruptFunction","destroy","getDestroyFunction","notifyComplete","implExecuteFunction","command","implInterruptFunction","implDestroyFunction","func","getState","getParent","setParent","getSelf","CommandList","commands","addCommand","preProcess","getCommands","insertCommand","insertCommandAt","addCommandArray","insertCommandArray","insertCommandArrayAt","getLength","getCommandByIndex","numCommands","Func","Break","Return","Log","getMessages","setMessages","Wait","time","completeHandler","timerId","setTimeout","cancel","clearTimeout","getTime","setTime","args","eventDispatcher","getFunction","setFunction","getArguments","setArguments","getEventDispatcher","setEventDispatcher","getEventType","setEventType","Listen","Tween","to","from","duration","easing","onStart","onUpdate","onComplete","intervalHandler","progressTime","progressValue","tweenTarget","internalFrom","setInterval","updateInterval","clearInterval","timeRatio","value0","getTarget","setTarget","getDuration","setDuration","getTo","setTo","getFrom","setFrom","getEasing","setEasing","getOnStart","setOnStart","getOnUpdate","setOnUpdate","getOnComplete","setOnComplete","getProgressTime","getProgressValue","getUpdateInterval","setUpdateInterval","milliseconds","If","then","reject","selectedCommand","getCondition","setCondition","getThen","setThen","getReject","setReject","Serial","currentCommand","position","next","isPaused","isCompleteOnPaused","implNotifyBreak","implNotifyReturn","getPosition","Parallel","completeCount","getCompleteCount","geom","Vector2","x","y","copyTo","point","getClone","zero","normalize","l","getSquareDistance","dx","dy","getDistance","Vector3","z","dz","Rectangle","width","height","rect","getTop","getBottom","getLeft","getRight","getTopLeft","getTopRight","getBottomLeft","getBottomRight","Align","ScaleMode","Boxer","resize","bounds","scaleMode","showAll","align","middleCenter","tw","th","bx","by","bw","bh","noBorder","ratioW","ratioH","ratio","exactFit","tx","topLeft","middleLeft","bottomLeft","topRight","middleRight","bottomRight","ty","topCenter","bottomCenter","Obj","each","Object","keys","forEach","get","Arr","sequence","count","init","step","v","unique","list","filter","duplicated","lastIndexOf","roundRobin","list1","list2","callback","j","m","swap","index1","index2","tmp","shuffle","floor","random","sort","asc","b","choose","clean","Boolean","f","Num","map","srcA","srcB","dstA","dstB","clamp","ease","min","max","clampAbs","minAbs","maxAbs","abs","lerp","randomInt","randomAbs","randomSign","dist","x1","y1","x2","y2","squared","radToDeg","radian","RAD2DEG","degToRad","degree","DEG2RAD","turn","PI3","PI2","PI4","PI5","PI6","PI_2","PI_3","PI_4","PI_6","Str","toTimeString","hours","minutes","seconds","h","substr","Cmd","stop","c","single","Dom","instantiate","templateId","removeId","template","document","getElementById","element","cloneNode","removeAttribute","addPointerDownListener","options","addPointerMoveListener","addPointerUpListener","addPointerEnterListener","addPointerLeaveListener","addPointerOverListener","addPointerOutListener","removePointerDownListener","removePointerMoveListener","removePointerUpListener","removePointerEnterListener","removePointerLeaveListener","removePointerOverListener","removePointerOutListener","addRootClass","root","documentElement","classList","add","removeRootClass","remove","addRootAttribute","setAttribute","removeRootAttribute","getRootCss","property","style","getPropertyValue","setRootCss","setProperty","scrollTo","scrollTop","useTransition","scrollTween","scrollPosition","applyScrollPosition","scroll","setupSmoothAnchorLink","tags","getElementsByTagName","tagCount","setAnchorLinkAction","item","tag","getAttribute","hasAttribute","anchorLinkClickHandler","getViewportRect","getBoundingClientRect","left","top","geDocumentRect","scrollX","scrollY","currentTarget","targetId","targetScrollPosition","pageYOffset","Cvs","getHighDpiContext2d","canvas","dpr","round","devicePixelRatio","context","getContext","scale","CssVar","suffix","cancelAnimation","numberPattern","exec","isNeedApply","getProperty","getValue","setValue","getSuffix","setSuffix","animate","tween","animateTo","Sensor","wakeUpDeviceMotion","Promise","resolve","DeviceMotionEvent","permissionState","catch","wakeUpDeviceOrientation","DeviceOrientationEvent","resource","ObjectPool","onRequireItem","onDestroyItem","initCount","growthCount","items","getItem","unshift","returnItem","reduce","shift","Lottery","values","initValues","restValues","restCount","isEmpty","onCheck","isAutoResetEnabled","getRestCount","getIsEmply","getIsAutoResetEnabled","setIsAutoResetEnabled","enabled","createIndices","Switcher","isLoopEnabled","itemCount","itemIds","itemIndexById","onChange","onPrev","onNext","setupById","ids","setup","setupByCount","currentItemIndex","currentItemId","oldItemIndex","oldItemId","gotoByIndex","itemIndex","dispatchPagerEvent","SwitcherEvent","change","gotoById","itemId","hasOwnProperty","prev","getPrevItemIndex","getNextItemIndex","getPrevItemId","getNextItemId","getIsLoopEnabled","setIsLoopEnabled","getItemCount","getCurrentItemIndex","getOldItemIndex","getCurrentItemId","getOldItemId","getItemIds","LoHi","lowThreshold","highThreshold","initValue","isHigh","_set","getIsHigh","getLowThreshold","getHighThreshold","setLowThreshold","threshold","setHighThreshold","LoHiEvent","low","high","EasingValue","tolerance","d","SpringValue","spring","friction","acceleration","velocity","MinMax","_min","Number","MAX_VALUE","_max","SimpleAverage","_value","_count","SimpleMovingAverage","maxCount","_maxCount","latest","oldest","MaxValue","maxLatestCount","_maxLatestCount","Circular","angle","setAngle","setVelocity","getAngle","getVelocity","getSin","getCos","getTan","tan","getMagnitude","getVector","xy","BinarySearch","setList","searchNearest","lowIndex","highIndex","midIndex","estimated","leapNearest","nearestIndex","nearestValue","lowValue","highValue","index0","MersenneTwister","seed","_mt","setSeed","_mulUint32","a2","b2","_toNumber","ceil","mt","_index","TypeError","k","_nextInt","N","M","sup","AnimationFrameTicker","updateHandler","requestId","requestAnimationFrame","targetFrameRate","frameStartTime","interval","toleranceDuration","AnimationFrameTickerEvent","tick","isRunning","start","cancelAnimationFrame","getIsRunning","getTargetFrameRate","getInterval","getTolerance","getToleranceDuration","ticker","listenerCount","Timer","repeatCount","timerHandler","tStartTime","elapsedCount","isCompleted","tInterval","startInterval","dispatch","TimerEvent","tId","tRestTime","stopInterval","restart","getElapsedTime","getRestTime","getElapsedCount","getRepeatCount","setRepeatCount","io","FileLoader","totalThreadCount","fileLoadCompleteHandler","query","content","currentThreadCount","isLoading","isLoadComplete","param","onLoad","FileLoaderSuccessEvent","success","fileLoadErrorHandler","onError","FileLoaderErrorEvent","isLoading_","currentCount","totalCount","loadingQueries","loadingQueryIndex","queriesByQueryId","queriesByUrl","handlersByType","require","id","addQuery","FileQuery","String","load","progress","FileLoaderProgressEvent","handler","addHandler","getType","getQueryByQueryId","queryId","getQueryByUrl","getCurrentCount","getTotalCount","getContentByUrl","getContentByQueryId","textureId","getCurrentThreadCount","getTotalThreadCount","loadedCount","ImageFileHandler","crossOrigin","image","Image","src","onabort","onerror","onload","view","ViewEvent","initializeBegin","initializeEnd","finalizeBegin","finalizeEnd","readyBegin","readyEnd","showBegin","showEnd","hideBegin","hideEnd","view_1","View","viewCount","name","autoHideWithInit","isInitializing","isInitialized","isFinalizing","isFinalized","isReadying","isReadied","isShowing","isShown","isHiding","viewsById","initialize","implInitialize","hide","ready","implReady","finalize","implFinalize","show","getShowCommand","getHideCommand","showCommand","hideCommand","implShow","implHide","getIsInitializing","getIsInitialized","getIsReadying","getIsReadied","getIsShowing","getIsShown","getIsHiding","getIsHidden","getIsFinalizing","getIsFinalized","getId","getView","getName","setName","getAutoHideWithInit","setAutoHideWithInit","getViewById","ButtonBehavior","hitArea","isHoverCursorEnabled","isPreventDefaultEnabled","isStopPropagationEnabled","mouseOverHandler","preventDefault","stopPropagation","over","applyMouseCursor","mouseOutHandler","out","mouseDownHandler","down","mouseUpHandler","up","clickHandler","click","touchStartHandler","touchEndHandler","touchCancelHandler","isEnabled","isOver","isDown","isOverInternal","isDownInternal","defaultMouseCursor","setHitArea","implButtonOver","_out","checkEnabled","implButtonOut","implButtonDown","_up","implButtonUp","implButtonClick","on","off","getIsEnabled","setIsEnabled","implButtonChangeEnabled","getIsOver","getIsDown","getHitArea","clearHitArea","getIsPreventDefaultEnabled","setIsPreventDefaultEnabled","getIsStopPropagationEnabled","setIsStopPropagationEnabled","getIsHoverCursorEnabled","setIsHoverCursorEnabled","cursor","SelectionBehavior","select","isSelected","implSelectionChanged","deselect","getIsSelected","DeviceInfo","u","navigator","userAgent","toLowerCase","isTablet","isMobile","isDesktop","isIOS","isAndroid","isIE","isEdge","isChrome","isSafari","isFireFox","isOpera","isUnknownBrowser","langFull","languages","language","lang","exception","isTouchEnabled","ontouchstart","isDownloadEnabled","createElement","webGlContext","isWebGlEnabled","WebGLRenderingContext","getShaderPrecisionFormat","e","isRetina","getIsDesktop","getIsTablet","getIsMobile","getIsIOS","getIsAndroid","getIsIE","getIsEdge","getIsChrome","getIsSafari","getIsFireFox","getIsOpera","getIsUnknownBrowser","getLang","getLangFull","getIsTouchEnabled","getIsDownloadEnabled","getIsWebGlEnabled","getIsRetina","getDevicePixelRatio","getDpi","dpi","div","body","appendChild","offsetHeight","removeChild","LocalStorage","save","expiredAt","isAvailable","record","JSON","stringify","localStorage","setItem","saveWithTerm","parse","removeItem","isAvailable_","toMilliseconds","dates","SessionStorage","sessionStorage","KeyCode","KeyWatcher","windowKeyDownHandler","windowKeyUpHandler","getIsAnyKeyPressed","pressedKeyCount","getIsKeyPressed","keyCode","isKeyPressedByKeyCode","getIsContinuousPressEnabled","isContinuousPressEnabled","setIsContinuousPressEnabled","KeyWatcherEvent","keyDown","keyUp","isLongPressed","originalEvent","altKey","ctrlKey","shiftKey","WinWatcher","windowResizeHandler","windowScrollHandler","innerWidth","innerHeight","scrollBottom","calcScrolledPosition","calcScrolledPositionRatio","WinWatcherEvent","getWindow","getScrollTop","getScrollBottom","getWidth","getHeight","getIsMobileOrientationResize","isMobileOrientationResize","setIsMobileOrientationResize","windowOrientationChangeHandler","ScrollSectionTriggerEvent","currentSectionIndex","prevSectionIndex","ScrollSectionTrigger","updateScrollPosition","check","updateThresholdPosition","triggerPositions","thresholdRatio","thresholdPosition","getCurrentIndex","getPrevIndex","getTriggerPositions","setTriggerPositions","positions","getThreshold","setThreshold","nearestTriggerIndex","nearestScrolledTriggerPosition","nearestDistance","triggerPositionCount","scrolledTriggerPosition","distance","sectionIndex","ResponsiveObserver","breakPoints","breakPointCount","currentIndex","prevIndex","setBreakpoints","getBreakPoints","getBreakPointCount","windowWidth","ResponsiveObserverEvent","Kiosk","disableInteraction","isInteractionDisabled","doubleClickHandler","passive","contextMenuHandler","setStageSize","aspectRatio","normalizedByCoverWidth","normalizedByCoverHeight","normalizedByContainWidth","normalizedByContainHeight","ratioX","xPixel","ratioY","yPixel","coverRatioX","coverRatioY","containRatioX","containRatioY","getAspectRatio","getNormalizedByCoverWidth","getNormalizedByCoverHeight","getNormalizedByContainWidth","getNormalizedByContainHeight","Scene","SceneState","idling","childrenByName","numChildren","transferInfo","onUnload","onArrive","onLeave","onAscend","onDescend","addChild","child","childName","addChildren","children","addedChildren","removeChildren","removedChildren","removeAllChildren","contains","getLastState","lastState","getChildByName","getChildrenByName","getNumChildren","getManager","getPath","manager","names","scene","getScenePathByNames","getTransferInfo","gotoScene","path","goto","_load","loading","SceneEvent","implOnLoad","loadComplete","_unload","unloading","unload","implOnUnload","unloadComplete","_arrive","arriving","arrive","implOnArrive","arriveComplete","_leave","leaving","leave","implOnLeave","leaveComplete","_ascend","ascending","ascend","implOnAscend","ascendComplete","_descend","descending","descend","implOnDescend","descendComplete","SceneTransferInfo","transferId","departurePath","destinationPath","getTransferId","getDeparturePath","getDestinationPath","getSceneStateString","Direction","core","getDirectionString","direction","Static","Sibling","Ascend","Descend","Waypoint","getLevel","_setFrom","_setTo","RootScene","SceneManager","rootSceneClass","sceneLoadCompleteHandler","currentScene","eventIndex","checkState","sceneUnloadCompleteHandler","sceneArriveCompleteHandler","sceneLeaveCompleteHandler","sceneAscendCompleteHandler","sceneDescendCompleteHandler","waypoints","waypointIndex","resolvePath","newWaypoints","createWaypoints","isDestinationChanged","setDirection","dumpWaypoint","SceneManagerTransferEvent","transferStart","normalized","pop","addSceneAt","getSceneNamesByPath","getRoot","getSceneByPath","getSceneBySceneNames","getParentSceneByPath","getSceneLevelByNames","departureNames","destinationNames","turningLevel","turningNames","turningPath","prevPath","dumpAllPath","_dumpAllPath","tmpTransferId","transferComplete","currentWaypoint","currentWaypointPath","SceneManagerRequireSceneEvent","requireScene","scenePath","getVersion"],"mappings":"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","file":"index.min.js","sourcesContent":["/// <reference path='../../index.ts' />\n\nnamespace alm.util {\n\n\texport class Time {\n\n\t\t/**\n\t\t * ()\n\t\t * @returns {number} UNIX\n\t\t */\n\t\tpublic static now():number {\n\t\t\treturn (window.performance || Date).now();\n\t\t}\n\n\t\tprivate constructor() {}\n\t}\n}\n","/// <reference path='../index.ts' />\n\nnamespace cmd {\n\n\timport Event = alm.event.Event;\n\n\texport class Parallel extends CommandList {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(...commands:(Command|Function)[]) {\n\t\t\tsuper(...commands);\n\t\t\tthis.completeCount = 0;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic addCommand(...commands:(Command|Function)[]):void {\n\t\t\tsuper.addCommand(...commands);\n\t\t}\n\n\t\tpublic insertCommand(...commands:(Command|Function)[]):void {\n\t\t\tthis.addCommand(...commands);\n\t\t}\n\n\t\tpublic addCommandArray(commands:(Command|Function)[]):void {\n\t\t\tthis.addCommand(...commands);\n\t\t}\n\n\t\tpublic insertCommandArray(commands:(Command|Function)[]):void {\n\t\t\tthis.addCommand(...commands);\n\t\t}\n\n\t\tprivate completeHandler = (event:Event<Command>):void => {\n\t\t\tif (++this.completeCount >= this.getLength()) {\n\t\t\t\tthis.notifyComplete();\n\t\t\t}\n\t\t};\n\n\t\tprotected implExecuteFunction(command:Command):void {\n\t\t\tthis.completeCount = 0;\n\t\t\tconst length:number = this.getLength();\n\t\t\tif (length > 0) {\n\t\t\t\tconst commands:Command[] = this.getCommands();\n\t\t\t\tlet command:Command;\n\t\t\t\tfor (let i:number = 0; i < length; ++i) {\n\t\t\t\t\tcommand = commands[i];\n\t\t\t\t\tcommand.addEventListener(CommandEvent.complete, this.completeHandler);\n\t\t\t\t\tcommand.execute();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.notifyComplete();\n\t\t\t}\n\t\t}\n\n\t\tprotected implInterruptFunction(command:Command):void {\n\t\t\tconst length:number = this.getLength();\n\t\t\tif (length > 0) {\n\t\t\t\tconst commands:Command[] = this.getCommands();\n\t\t\t\tlet command:Command;\n\t\t\t\tfor (let i:number = 0; i < length; ++i) {\n\t\t\t\t\tcommand = commands[i];\n\t\t\t\t\tcommand.removeEventListener(CommandEvent.complete, this.completeHandler);\n\t\t\t\t\tcommand.interrupt();\n\t\t\t\t}\n\t\t\t}\n\t\t\tsuper.implInterruptFunction(command);\n\t\t}\n\n\t\tprotected implDestroyFunction(command:Command):void {\n\t\t\tconst length:number = this.getLength();\n\t\t\tif (length > 0) {\n\t\t\t\tconst commands:Command[] = this.getCommands();\n\t\t\t\tlet command:Command;\n\t\t\t\tfor (let i:number = 0; i < length; ++i) {\n\t\t\t\t\tcommand = commands[i];\n\t\t\t\t\tcommand.removeEventListener(CommandEvent.complete, this.completeHandler);\n\t\t\t\t\tcommand.destroy();\n\t\t\t\t}\n\t\t\t}\n\t\t\tsuper.implDestroyFunction(command);\n\t\t}\n\n\t\tprotected implNotifyBreak():void {\n\t\t\tconst length:number = this.getLength();\n\t\t\tif (length > 0) {\n\t\t\t\tconst commands:Command[] = this.getCommands();\n\t\t\t\tlet command:Command;\n\t\t\t\tfor (let i:number = 0; i < length; ++i) {\n\t\t\t\t\tcommand = commands[i];\n\t\t\t\t\tif (command.getState() == CommandState.executing) {\n\t\t\t\t\t\tcommand.removeEventListener(CommandEvent.complete, this.completeHandler);\n\t\t\t\t\t\tcommand.interrupt();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.notifyComplete();\n\t\t}\n\n\t\tprotected implNotifyReturn():void {\n\t\t\tconst length:number = this.getLength();\n\t\t\tif (length > 0) {\n\t\t\t\tconst commands:Command[] = this.getCommands();\n\t\t\t\tlet command:Command;\n\t\t\t\tfor (let i:number = 0; i < length; ++i) {\n\t\t\t\t\tcommand = commands[i];\n\t\t\t\t\tif (command.getState() == CommandState.executing) {\n\t\t\t\t\t\tcommand.removeEventListener(CommandEvent.complete, this.completeHandler);\n\t\t\t\t\t\tcommand.interrupt();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst func:Function = this.getParent()['notifyReturn'];\n\t\t\tif (func) func();\n\t\t\tthis.destroy();\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprotected getCompleteCount():number { return this.completeCount; }\n\t\tprivate completeCount:number;\n\n\t\tprivate currentCommand:Command;\n\t\tprivate isPaused:boolean;\n\t\tprivate isCompleteOnPaused:boolean;\n\t}\n}\n","/// <reference path='../index.ts' />\n\nnamespace scn {\n\n\timport Event = alm.event.Event;\n\n\texport class SceneManagerRequireSceneEvent extends Event<SceneManager> {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// EVENT\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic static readonly requireScene:string = 'SceneManagerRequireSceneEvent.requireScene';\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(eventType:string, eventTarget:SceneManager, scenePath:string) {\n\t\t\tsuper(eventType, eventTarget);\n\t\t\tthis.scenePath = scenePath;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic clone():SceneManagerRequireSceneEvent {\n\t\t\treturn new SceneManagerRequireSceneEvent(this.type, this.target, this.scenePath);\n\t\t}\n\n\t\tpublic toString():string {\n\t\t\treturn '[SceneManagerRequireSceneEvent] type = ' + this.type + ', scenePath = ' + this.scenePath;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic readonly scenePath:string;\n\t}\n}\n","/* ---------- project dependencies ---------- */\n\n\n/* ---------- project scripts ---------- */\n\n/// <reference path='alm/util/Time.ts' />\n/// <reference path='alm/math/Easing.ts' />\n/// <reference path='alm/browser/QueryString.ts' />\n\n/// <reference path='alm/debug/Logger.ts' />\n/// <reference path='alm/debug/FpsMonitor.ts' />\n\n/// <reference path='alm/event/Event.ts' />\n/// <reference path='alm/event/EventListener.ts' />\n/// <reference path='alm/event/EventDispatcher.ts' />\n/// <reference path='alm/event/IEventDispatcher.ts' />\n\n/// <reference path='cmd/CommandState.ts' />\n/// <reference path='cmd/CommandEvent.ts' />\n/// <reference path='cmd/Command.ts' />\n/// <reference path='cmd/CommandList.ts' />\n/// <reference path='cmd/Break.ts' />\n/// <reference path='cmd/Return.ts' />\n/// <reference path='cmd/Log.ts' />\n/// <reference path='cmd/Wait.ts' />\n/// <reference path='cmd/Func.ts' />\n/// <reference path='cmd/Listen.ts' />\n/// <reference path='cmd/Tween.ts' />\n/// <reference path='cmd/If.ts' />\n/// <reference path='cmd/Serial.ts' />\n/// <reference path='cmd/Parallel.ts' />\n\n/// <reference path='alm/geom/Vector2.ts' />\n/// <reference path='alm/geom/Vector3.ts' />\n/// <reference path='alm/geom/Rectangle.ts' />\n/// <reference path='alm/geom/Boxer.ts' />\n\n/// <reference path='alm/util/Hash.ts' />\n/// <reference path='alm/util/Obj.ts' />\n/// <reference path='alm/util/Arr.ts' />\n/// <reference path='alm/util/Num.ts' />\n/// <reference path='alm/util/Str.ts' />\n/// <reference path='alm/util/Cmd.ts' />\n/// <reference path='alm/util/Dom.ts' />\n/// <reference path='alm/util/Cvs.ts' />\n/// <reference path='alm/util/CssVar.ts' />\n/// <reference path='alm/util/Sensor.ts' />\n/// <reference path='alm/util/Time.ts' />\n\n/// <reference path='alm/resource/ObjectPool.ts' />\n\n/// <reference path='alm/state/Lottery.ts' />\n/// <reference path='alm/state/Switcher.ts' />\n/// <reference path='alm/state/SwitcherEvent.ts' />\n/// <reference path='alm/state/LoHi.ts' />\n/// <reference path='alm/state/LoHiEvent.ts' />\n\n/// <reference path='alm/math/EasingValue.ts' />\n/// <reference path='alm/math/SpringValue.ts' />\n/// <reference path='alm/math/MinMax.ts' />\n/// <reference path='alm/math/SimpleAverage.ts' />\n/// <reference path='alm/math/SimpleMovingAverage.ts' />\n/// <reference path='alm/math/MaxValue.ts' />\n/// <reference path='alm/math/Circular.ts' />\n/// <reference path='alm/math/BinarySearch.ts' />\n/// <reference path='alm/math/MersenneTwister.ts' />\n\n/// <reference path='alm/time/AnimationFrameTicker.ts' />\n/// <reference path='alm/time/AnimationFrameTickerEvent.ts' />\n/// <reference path='alm/time/Timer.ts' />\n/// <reference path='alm/time/TimerEvent.ts' />\n\n/// <reference path='alm/io/FileLoader.ts' />\n/// <reference path='alm/io/FileLoaderProgressEvent.ts' />\n/// <reference path='alm/io/FileLoaderSuccessEvent.ts' />\n/// <reference path='alm/io/FileLoaderErrorEvent.ts' />\n/// <reference path='alm/io/FileQuery.ts' />\n/// <reference path='alm/io/IFileHandler.ts' />\n/// <reference path='alm/io/ImageFileHandler.ts' />\n\n/// <reference path='alm/view/IView.ts' />\n/// <reference path='alm/view/ViewEvent.ts' />\n/// <reference path='alm/view/View.ts' />\n/// <reference path='alm/view/ButtonBehavior.ts' />\n/// <reference path='alm/view/IButton.ts' />\n/// <reference path='alm/view/SelectionBehavior.ts' />\n/// <reference path='alm/view/ISelection.ts' />\n\n/// <reference path='alm/browser/DeviceInfo.ts' />\n/// <reference path='alm/browser/LocalStorage.ts' />\n/// <reference path='alm/browser/SessionStorage.ts' />\n/// <reference path='alm/browser/KeyWatcher.ts' />\n/// <reference path='alm/browser/KeyWatcherEvent.ts' />\n/// <reference path='alm/browser/WinWatcher.ts' />\n/// <reference path='alm/browser/WinWatcherEvent.ts' />\n/// <reference path=\"alm/browser/ScrollSectionTriggerEvent.ts\" />\n/// <reference path=\"alm/browser/ScrollSectionTrigger.ts\" />\n/// <reference path=\"alm/browser/ResponsiveObserver.ts\" />\n/// <reference path=\"alm/browser/ResponsiveObserverEvent.ts\" />\n/// <reference path=\"alm/browser/Kiosk.ts\" />\n\n/// <reference path='scn/Scene.ts' />\n/// <reference path='scn/SceneEvent.ts' />\n/// <reference path='scn/SceneTransferInfo.ts' />\n/// <reference path='scn/SceneState.ts' />\n/// <reference path='scn/core/Direction.ts' />\n/// <reference path='scn/core/Waypoint.ts' />\n/// <reference path='scn/core/IRootScene.ts' />\n/// <reference path='scn/core/RootScene.ts' />\n/// <reference path='scn/SceneManager.ts' />\n/// <reference path='scn/SceneManagerTransferEvent.ts' />\n/// <reference path='scn/SceneManagerRequireSceneEvent.ts' />\n\n\n/* ---------- init ---------- */\n\nnamespace alm {\n\n\t// Library version info\n\texport function getVersion():string {\n\t\treturn '0.0.1';\n\t}\n\n\t// Credit info\n\tconst style:string = 'color:#999;';\n\tconst print:Function = console.debug;\n\tprint('%c+ + + + + + + + + + + + + + + + + + + + + + + + + +', style);\n\tprint('%c+ alumican.js', style);\n\tprint('%c+ version ' + getVersion(), style);\n\tprint('%c+ http://alumican.net', style);\n\tprint('%c+ https://github.com/alumican/alumican.js', style);\n\tprint('%c+ + + + + + + + + + + + + + + + + + + + + + + + + +', style);\n\tprint('');\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.debug {\n\n\timport QueryString = alm.browser.QueryString;\n\n\texport enum LoggerLevel {\n\t\tverbose = 0,\n\t\tinfo = 1,\n\t\twarn = 2,\n\t\terror = 3,\n\t\tsilent = 4,\n\t}\n\n\n\n\n\n\texport interface ILogging {\n\n\t\tverbose(prefix:string, messages:any[]):void;\n\t\tinfo(prefix:string, messages:any[]):void;\n\t\twarn(prefix:string, messages:any[]):void;\n\t\terror(prefix:string, messages:any[]):void;\n\t}\n\n\n\n\n\n\texport class NullLogging implements ILogging {\n\n\t\tpublic verbose(prefix:string, messages:any[]):void {\n\t\t}\n\n\t\tpublic info(prefix:string, messages:any[]):void {\n\t\t}\n\n\t\tpublic warn(prefix:string, messages:any[]):void {\n\t\t}\n\n\t\tpublic error(prefix:string, messages:any[]):void {\n\t\t}\n\t}\n\n\n\n\n\n\texport class ConsoleLogging implements ILogging {\n\n\t\tpublic verbose(prefix:string, messages:any[]):void {\n\t\t\tconsole.debug.apply(console, Array.prototype.slice.call([prefix].concat(messages)));\n\t\t}\n\n\t\tpublic info(prefix:string, messages:any[]):void {\n\t\t\tconsole.log.apply(console, Array.prototype.slice.call([prefix].concat(messages)));\n\t\t}\n\n\t\tpublic warn(prefix:string, messages:any[]):void {\n\t\t\tconsole.warn.apply(console, Array.prototype.slice.call([prefix].concat(messages)));\n\t\t}\n\n\t\tpublic error(prefix:string, messages:any[]):void {\n\t\t\tconsole.error.apply(console, Array.prototype.slice.call([prefix].concat(messages)));\n\t\t}\n\t}\n\n\n\n\n\n\texport class DOMLogging implements ILogging {\n\n\t\tconstructor(dom:HTMLElement, html:boolean) {\n\t\t\tthis.dom = dom;\n\t\t\tthis.html = html;\n\t\t}\n\n\t\tpublic verbose(prefix:string, messages:any[]):void {\n\t\t\tthis.print(prefix, messages);\n\t\t}\n\n\t\tpublic info(prefix:string, messages:any[]):void {\n\t\t\tthis.print(prefix, messages);\n\t\t}\n\n\t\tpublic warn(prefix:string, messages:any[]):void {\n\t\t\tthis.print(prefix, messages);\n\t\t}\n\n\t\tpublic error(prefix:string, messages:any[]):void {\n\t\t\tthis.print(prefix, messages);\n\t\t}\n\n\t\tprivate print(prefix:string, messages:any[]):void {\n\t\t\tconst line:string = prefix + messages.join(', ');\n\t\t\tif (this.html) {\n\t\t\t\tthis.dom.innerHTML = line + '<br>\\n' + this.dom.innerHTML;\n\t\t\t} else {\n\t\t\t\tthis.dom.innerText = line + '\\n' + this.dom.innerText;\n\t\t\t}\n\t\t}\n\n\t\tprivate dom:HTMLElement;\n\t\tprivate html:boolean;\n\t}\n\n\n\n\n\n\texport class ParallelLogging implements ILogging {\n\n\t\tconstructor(loggers:ILogging[]) {\n\t\t\tthis.loggers = loggers;\n\t\t}\n\n\t\tpublic verbose(prefix:string, messages:any[]):void {\n\t\t\tconst n:number = this.loggers.length;\n\t\t\tfor (let i:number = 0; i < n; ++i) {\n\t\t\t\tthis.loggers[i].verbose(prefix, messages);\n\t\t\t}\n\t\t}\n\n\t\tpublic info(prefix:string, messages:any[]):void {\n\t\t\tconst n:number = this.loggers.length;\n\t\t\tfor (let i:number = 0; i < n; ++i) {\n\t\t\t\tthis.loggers[i].info(prefix, messages);\n\t\t\t}\n\t\t}\n\n\t\tpublic warn(prefix:string, messages:any[]):void {\n\t\t\tconst n:number = this.loggers.length;\n\t\t\tfor (let i:number = 0; i < n; ++i) {\n\t\t\t\tthis.loggers[i].warn(prefix, messages);\n\t\t\t}\n\t\t}\n\n\t\tpublic error(prefix:string, messages:any[]):void {\n\t\t\tconst n:number = this.loggers.length;\n\t\t\tfor (let i:number = 0; i < n; ++i) {\n\t\t\t\tthis.loggers[i].error(prefix, messages);\n\t\t\t}\n\t\t}\n\n\t\tprivate loggers:ILogging[];\n\t}\n\n\n\n\n\n\texport class Logger {\n\n\t\tpublic static level:number = LoggerLevel.verbose;\n\t\tpublic static logger:ILogging = new ConsoleLogging();\n\t\tprivate static namespace:string = '';\n\n\t\tpublic static setLevelByQuery(key:string):void {\n\t\t\tconst level:number = new QueryString().getInt(key, LoggerLevel.silent);\n\t\t\tLogger.level = isNaN(level) ? LoggerLevel.silent : level;\n\t\t}\n\n\t\tpublic static setNamespace(namespace:string):void {\n\t\t\tLogger.namespace = namespace != '' ? (namespace + ' ') : '';\n\t\t}\n\n\t\tpublic static verbose(...messages:any[]):void {\n\t\t\tif (Logger.level <= LoggerLevel.verbose) {\n\t\t\t\tLogger.logger.verbose('[' + Logger.namespace + 'Verbose] ', messages);\n\t\t\t}\n\t\t}\n\n\t\tpublic static info(...messages:any[]):void {\n\t\t\tif (Logger.level <= LoggerLevel.info) {\n\t\t\t\tLogger.logger.info('[' + Logger.namespace + 'Info] ', messages);\n\t\t\t}\n\t\t}\n\n\t\tpublic static warn(...messages:any[]):void {\n\t\t\tif (Logger.level <= LoggerLevel.warn) {\n\t\t\t\tLogger.logger.warn('[' + Logger.namespace + 'Warn] ', messages);\n\t\t\t\t//Logger.stackTrace();\n\t\t\t}\n\t\t}\n\n\t\tpublic static error(...messages:any[]):void {\n\t\t\tif (Logger.level <= LoggerLevel.error) {\n\t\t\t\tLogger.logger.error('[' + Logger.namespace + 'Error] ', messages);\n\t\t\t\t//Logger.stackTrace();\n\t\t\t}\n\t\t}\n\n\t\tpublic static warnIf(target:any, message:string, condition:boolean = true):void {\n\t\t\tif (Logger.level <= LoggerLevel.warn && condition) {\n\t\t\t\tLogger.logger.warn('[' + Logger.namespace + 'Warn] ', [message + ' : ' + target]);\n\t\t\t\t//Logger.stackTrace();\n\t\t\t}\n\t\t}\n\n\t\tpublic static errorIf(target:any, message: string, condition:boolean = true):void {\n\t\t\tif (Logger.level <= LoggerLevel.error && condition) {\n\t\t\t\tLogger.logger.error('[' + Logger.namespace + 'Error] ', [message + ' : ' + target]);\n\t\t\t\t//Logger.stackTrace();\n\t\t\t}\n\t\t}\n\n\t\tpublic static stackTrace():void {\n\t\t\tconsole.trace();\n\t\t}\n\n\t\tprivate constructor() {}\n\t}\n}\n\nfunction trace(...messages:any[]):void {\n\talm.debug.Logger.info.apply(trace.caller, arguments);\n}\n\nfunction throwWarn(target:any, message:string, condition:boolean = true):void {\n\talm.debug.Logger.warnIf.apply(null, arguments);\n}\n\nfunction throwError(target:any, message:string, condition:boolean = true):void {\n\talm.debug.Logger.errorIf.apply(null, arguments);\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.math {\n\n\texport type EasingFunction = (t:number)=>number;\n\n\texport class Easing {\n\n\t\tpublic static linear(t:number):number {\n\t\t\treturn t;\n\t\t}\n\n\n\n\n\n\t\tpublic static easeInQuad(t:number):number {\n\t\t\treturn (t /= 1) * t;\n\t\t}\n\n\t\tpublic static easeOutQuad(t:number):number {\n\t\t\treturn -(t /= 1) * (t - 2);\n\t\t}\n\n\t\tpublic static easeInOutQuad(t:number):number {\n\t\t\tif ((t /= 0.5) < 1) return 0.5 * t * t;\n\t\t\treturn -0.5 * ((--t) * (t - 2) - 1);\n\t\t}\n\n\n\n\n\n\t\tpublic static easeInCubic(t:number):number {\n\t\t\treturn (t /= 1) * t * t;\n\t\t}\n\n\t\tpublic static easeOutCubic(t:number):number {\n\t\t\treturn (t = t - 1) * t * t + 1;\n\t\t}\n\n\t\tpublic static easeInOutCubic(t:number):number {\n\t\t\tif ((t /= 0.5) < 1) return 0.5 * t * t * t;\n\t\t\treturn 0.5 * ((t -= 2) * t * t + 2);\n\t\t}\n\n\n\n\n\n\t\tpublic static easeInQuart(t:number):number {\n\t\t\treturn (t /= 1) * t * t * t;\n\t\t}\n\n\t\tpublic static easeOutQuart(t:number):number {\n\t\t\treturn -((t = t - 1) * t * t * t - 1);\n\t\t}\n\n\t\tpublic static easeInOutQuart(t:number):number {\n\t\t\tif ((t /= 0.5) < 1) return 0.5 * t * t * t * t;\n\t\t\treturn -0.5 * ((t -= 2) * t * t * t - 2);\n\t\t}\n\n\n\n\n\n\t\tpublic static easeInQuint(t:number):number {\n\t\t\treturn (t /= 1) * t * t * t * t;\n\t\t}\n\n\t\tpublic static easeOutQuint(t:number):number {\n\t\t\treturn ((t = t - 1) * t * t * t * t + 1);\n\t\t}\n\n\t\tpublic static easeInOutQuint(t:number):number {\n\t\t\tif ((t /= 0.5) < 1) return 0.5 * t * t * t * t * t;\n\t\t\treturn 0.5 * ((t -= 2) * t * t * t * t + 2);\n\t\t}\n\n\n\n\n\n\t\tpublic static easeInSine(t:number):number {\n\t\t\treturn -Math.cos(t * (Math.PI / 2)) + 1;\n\t\t}\n\n\t\tpublic static easeOutSine(t:number):number {\n\t\t\treturn Math.sin(t * (Math.PI / 2));\n\t\t}\n\n\t\tpublic static easeInOutSine(t:number):number {\n\t\t\treturn -0.5 * (Math.cos(Math.PI * t) - 1);\n\t\t}\n\n\n\n\n\n\t\tpublic static easeInExpo(t:number):number {\n\t\t\tif (t == 0) return 0;\n\t\t\treturn Math.pow(2, 10 * (t - 1));\n\t\t}\n\n\t\tpublic static easeOutExpo(t:number):number {\n\t\t\tif (t == 1) return 1;\n\t\t\treturn -Math.pow(2, -10 * t) + 1;\n\t\t}\n\n\t\tpublic static easeInOutExpo(t:number):number {\n\t\t\tif (t == 0) return 0;\n\t\t\tif (t == 1) return 1;\n\t\t\tif ((t /= 0.5) < 1) return 0.5 * Math.pow(2, 10 * (t - 1));\n\t\t\treturn 0.5 * (-Math.pow(2, -10 * --t) + 2);\n\t\t}\n\n\n\n\n\n\t\tpublic static easeInCirc(t:number):number {\n\t\t\treturn -(Math.sqrt(1 - (t /= 1) * t) - 1);\n\t\t}\n\n\t\tpublic static easeOutCirc(t:number):number {\n\t\t\treturn Math.sqrt(1 - (t = t - 1) * t);\n\t\t}\n\n\t\tpublic static easeInOutCirc(t:number):number {\n\t\t\tif ((t /= 0.5) < 1) return -0.5 * (Math.sqrt(1 - t * t) - 1);\n\t\t\treturn 0.5 * (Math.sqrt(1 - (t -= 2) * t) + 1);\n\t\t}\n\n\n\n\n\n\t\tpublic static createEaseInElastic(s:number = 1.70158):EasingFunction {\n\t\t\treturn function (t:number) {\n\t\t\t\tlet p:number = 0;\n\t\t\t\tlet a:number = 1;\n\t\t\t\tif (t == 0) return 0;\n\t\t\t\tif ((t /= 1) == 1) return 1;\n\t\t\t\tif (p == 0) p = 0.3;\n\t\t\t\tif (a < 1) {\n\t\t\t\t\ta = 1;\n\t\t\t\t\ts = p / 4;\n\t\t\t\t} else {\n\t\t\t\t\ts = p / (2 * Math.PI) * Math.asin(1 / a);\n\t\t\t\t}\n\t\t\t\treturn -a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t - s) * (2 * Math.PI) / p);\n\t\t\t}\n\t\t}\n\n\t\tpublic static createEaseOutElastic(s:number = 1.70158):EasingFunction {\n\t\t\treturn function (t:number) {\n\t\t\t\tlet p:number = 0;\n\t\t\t\tlet a:number = 1;\n\t\t\t\tif (t == 0) return 0;\n\t\t\t\tif ((t /= 1) == 1) return 1;\n\t\t\t\tif (p == 0) p = 0.3;\n\t\t\t\tif (a < 1) {\n\t\t\t\t\ta = 1;\n\t\t\t\t\ts = p / 4;\n\t\t\t\t} else {\n\t\t\t\t\ts = p / (2 * Math.PI) * Math.asin(1 / a);\n\t\t\t\t}\n\t\t\t\treturn a * Math.pow(2, -10 * t) * Math.sin((t - s) * (2 * Math.PI) / p) + 1;\n\t\t\t}\n\t\t}\n\n\t\tpublic static createEaseInOutElastic(s:number = 1.70158):EasingFunction {\n\t\t\treturn function (t:number) {\n\t\t\t\tlet p:number = 0;\n\t\t\t\tlet a:number = 1;\n\t\t\t\tif (t == 0) return 0;\n\t\t\t\tif ((t /= 0.5) == 2) return 1;\n\t\t\t\tif (p == 0) p = 0.3 * 1.5;\n\t\t\t\tif (a < 1) {\n\t\t\t\t\ta = 1;\n\t\t\t\t\ts = p / 4;\n\t\t\t\t} else {\n\t\t\t\t\ts = p / (2 * Math.PI) * Math.asin(1 / a);\n\t\t\t\t}\n\t\t\t\tif (t < 1) return -0.5 * a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t - s) * (2 * Math.PI) / p);\n\t\t\t\treturn a * Math.pow(2, -10 * (t -= 1)) * Math.sin((t - s) * (2 * Math.PI) / p) * 0.5 + 1;\n\t\t\t}\n\t\t}\n\n\t\tpublic static easeInElastic(t:number):number {\n\t\t\treturn Easing.defaultEaseInElastic(t);\n\t\t}\n\n\t\tpublic static easeOutElastic(t:number):number {\n\t\t\treturn Easing.defaultEaseOutElastic(t);\n\t\t}\n\n\t\tpublic static easeInOutElastic(t:number):number {\n\t\t\treturn Easing.defaultEaseInOutElastic(t);\n\t\t}\n\n\t\tprivate static defaultEaseInElastic:EasingFunction = Easing.createEaseInElastic();\n\t\tprivate static defaultEaseOutElastic:EasingFunction = Easing.createEaseOutElastic();\n\t\tprivate static defaultEaseInOutElastic:EasingFunction = Easing.createEaseInOutElastic();\n\n\n\n\n\n\t\tpublic static createEaseInBack(s:number = 1.70158):EasingFunction {\n\t\t\treturn function (t:number) {\n\t\t\t\treturn (t /= 1) * t * ((s + 1) * t - s);\n\t\t\t}\n\t\t}\n\n\t\tpublic static createEaseOutBack(s:number = 1.70158):EasingFunction {\n\t\t\treturn function (t:number) {\n\t\t\t\treturn (t = t - 1) * t * ((s + 1) * t + s) + 1;\n\t\t\t}\n\t\t}\n\n\t\tpublic static createEaseInOutBack(s:number = 1.70158):EasingFunction {\n\t\t\treturn function (t:number) {\n\t\t\t\tif ((t /= 0.5) < 1) return 0.5 * t * t * (((s *= 1.525) + 1) * t - s);\n\t\t\t\treturn 0.5 * ((t -= 2) * t * (((s *= 1.525) + 1) * t + s) + 2);\n\t\t\t}\n\t\t}\n\n\t\tpublic static easeInBack(t:number):number {\n\t\t\treturn Easing.defaultEaseInBack(t);\n\t\t}\n\n\t\tpublic static easeOutBack(t:number):number {\n\t\t\treturn Easing.defaultEaseOutBack(t);\n\t\t}\n\n\t\tpublic static easeInOutBack(t:number):number {\n\t\t\treturn Easing.defaultEaseInOutBack(t);\n\t\t}\n\n\t\tprivate static defaultEaseInBack:EasingFunction = Easing.createEaseInBack();\n\t\tprivate static defaultEaseOutBack:EasingFunction = Easing.createEaseOutBack();\n\t\tprivate static defaultEaseInOutBack:EasingFunction = Easing.createEaseInOutBack();\n\n\n\n\n\n\t\tpublic static easeInBounce(t:number):number {\n\t\t\treturn 1 - Easing.easeOutBounce(1 - t);\n\t\t}\n\n\t\tpublic static easeOutBounce(t:number):number {\n\t\t\tif ((t /= 1) < (1 / 2.75)) {\n\t\t\t\treturn 7.5625 * t * t;\n\t\t\t} else if (t < (2 / 2.75)) {\n\t\t\t\treturn 7.5625 * (t -= (1.5 / 2.75)) * t + 0.75;\n\t\t\t} else if (t < (2.5 / 2.75)) {\n\t\t\t\treturn 7.5625 * (t -= (2.25 / 2.75)) * t + 0.9375;\n\t\t\t} else {\n\t\t\t\treturn 7.5625 * (t -= (2.625 / 2.75)) * t + 0.984375;\n\t\t\t}\n\t\t}\n\n\t\tpublic static easeInOutBounce(t:number):number {\n\t\t\tif (t < 0.5) return Easing.easeInBounce(t * 2) * 0.5;\n\t\t\treturn Easing.easeOutBounce(t * 2 - 1) * 0.5 + 0.5;\n\t\t}\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.browser {\n\n\timport Hash = alm.util.Hash;\n\n\texport class QueryString {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(url:string = '') {\n\t\t\tthis.set(url);\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic set(url:string = ''):void {\n\t\t\t// normalize url\n\t\t\tlet search:string = '';\n\t\t\tif (url != '') {\n\t\t\t\tconst index:number = url.indexOf('?');\n\t\t\t\tif (index != -1) {\n\t\t\t\t\tsearch = url.substring(index);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tsearch = location.search;\n\t\t\t}\n\t\t\t// parse query\n\t\t\tthis.hash = {};\n\t\t\tconst pairs:string[] = search.substring(1).split('&');\n\t\t\tlet pair:string[];\n\t\t\tfor(let i:number = 0; pairs[i]; ++i) {\n\t\t\t\tpair = pairs[i].split('=');\n\t\t\t\tthis.hash[pair[0]] = pair[1];\n\t\t\t}\n\t\t}\n\n\t\t// 'abc' -> 'abc'\n\t\tpublic getString(key:string, defaultValue:string):string {\n\t\t\tconst value:string = this.hash[key];\n\t\t\treturn value === undefined ? defaultValue : value;\n\t\t}\n\n\t\t// '123' -> 123\n\t\tpublic getInt(key:string, defaultValue:number):number {\n\t\t\tconst value:number = parseInt(this.hash[key]);\n\t\t\treturn isNaN(value) ? defaultValue : value;\n\t\t}\n\n\t\t// '1.23' -> 1.23\n\t\tpublic getFloat(key:string, defaultValue:number):number {\n\t\t\tconst value:number = parseFloat(this.hash[key]);\n\t\t\treturn isNaN(value) ? defaultValue : value;\n\t\t}\n\n\t\t// '0' -> false, otherwise true\n\t\tpublic getBool(key:string, defaultValue:boolean):boolean {\n\t\t\tconst value:string = this.hash[key];\n\t\t\treturn value === undefined ? defaultValue : (<any>value == true);\n\t\t}\n\n\t\tpublic getHash():Hash<string> {\n\t\t\treturn this.hash;\n\t\t}\n\n\t\tpublic setHash(hash:Hash<string>):void {\n\t\t\tthis.hash = hash;\n\t\t}\n\n\t\tpublic setParam(key:string, value:any):void {\n\t\t\tthis.hash[key] = value;\n\t\t}\n\n\t\tpublic removeParam(key:string):void {\n\t\t\tdelete this.hash[key];\n\t\t}\n\n\t\tpublic hasParam(key:string):boolean {\n\t\t\treturn this.hash[key] !== undefined;\n\t\t}\n\n\n\n\n\n\t\tpublic static getReplacedQueryStringUrl(url:string, key:string, value:string):string {\n\t\t\tconst regExp = new RegExp('([?&])' + key + '=.*?(&|$)', 'i');\n\t\t\tconst separator = url.indexOf('?') !== -1 ? '&' : '?';\n\t\t\tif (url.match(regExp)) {\n\t\t\t\treturn url.replace(regExp, '$1' + key + '=' + value + '$2');\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn url + separator + key + '=' + value;\n\t\t\t}\n\t\t}\n\n\t\tpublic static replaceQueryString(key:string, value:string):void {\n\t\t\tconst url = QueryString.getReplacedQueryStringUrl(window.location.href, key, value);\n\t\t\tconst state = url.match(/^https?:\\/{2,}.*?(\\/.*)/)[1];\n\t\t\twindow.history.replaceState(null, null, state);\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprivate hash:Hash<string>;\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.debug {\n\n\timport Time = alm.util.Time;\n\n\texport class FpsMonitor {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor() {\n\t\t\tthis.reset();\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic reset():void {\n\t\t\tthis.frameRate = 0;\n\t\t\tthis.frameCount = 0;\n\t\t\tthis.startTime = Time.now();\n\t\t\tthis.actualFrameRate = -1;\n\t\t\tthis.dummyFrameRate = -1;\n\t\t}\n\n\t\tpublic update():void {\n\t\t\t++this.frameCount;\n\t\t\tconst currentTime:number = Time.now();\n\t\t\tconst elapsedTime:number = currentTime - this.startTime;\n\t\t\tif (elapsedTime >= 1000) {\n\t\t\t\tthis.actualFrameRate = 1000 * this.frameCount / elapsedTime;\n\t\t\t\tthis.frameCount = 0;\n\t\t\t\tthis.startTime = currentTime;\n\t\t\t\tif (this.dummyFrameRate < 0) {\n\t\t\t\t\tthis.frameRate = this.actualFrameRate;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tpublic setDummyFrameRate(frameRate:number):void {\n\t\t\tthis.dummyFrameRate = frameRate;\n\t\t\tthis.frameRate = this.dummyFrameRate;\n\t\t}\n\n\t\tpublic clearDummyFrameRate():void {\n\t\t\tthis.dummyFrameRate = -1;\n\t\t\tthis.frameRate = this.actualFrameRate;\n\t\t}\n\n\t\tpublic getFrameRate():number {\n\t\t\treturn this.frameRate;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprivate frameRate:number;\n\t\tprivate frameCount:number;\n\t\tprivate startTime:number;\n\t\tprivate actualFrameRate:number;\n\t\tprivate dummyFrameRate:number;\n\t}\n}\n","/// <reference path='../../index.ts' />\r\n\r\nnamespace alm.event {\r\n\r\n\texport class Event<Target = object, Data = any> {\r\n\r\n\t\t// --------------------------------------------------\r\n\t\t//\r\n\t\t// CONSTRUCTOR\r\n\t\t//\r\n\t\t// --------------------------------------------------\r\n\r\n\t\tconstructor(type:string, target:Target, data:Data = null) {\r\n\t\t\tthis.type = type;\r\n\t\t\tthis.target = target;\r\n\t\t\tthis.data = data;\r\n\t\t}\r\n\r\n\r\n\r\n\r\n\r\n\t\t// --------------------------------------------------\r\n\t\t//\r\n\t\t// MEMBER\r\n\t\t//\r\n\t\t// --------------------------------------------------\r\n\r\n\t\tpublic readonly type:string;\r\n\t\tpublic readonly target:Target;\r\n\t\tpublic readonly data:Data;\r\n\t}\r\n}\r\n","/// <reference path='../../index.ts' />\n\nnamespace alm.event {\n\n\timport Logger = alm.debug.Logger;\n\n\texport class EventDispatcher implements IEventDispatcher {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(target:EventDispatcher = null) {\n\t\t\tthis.target = target || this;\n\t\t\tthis.listeners = {};\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic addEventListener(eventType:string, listener:EventListener):boolean {\n\t\t\tif (typeof(listener) != 'function') {\n\t\t\t\tLogger.warn('[EventDispatcher] addEventListener : listener is not function, eventType = \\'' + eventType + '\\', listener = ' + listener);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tlet listeners:EventListener[] = this.listeners[eventType];\n\t\t\tif (listeners) {\n\t\t\t\tconst numListeners:number = listeners.length;\n\t\t\t\tfor (let i:number = 0; i < numListeners; ++i) {\n\t\t\t\t\tif (listener == listeners[i]) return false;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.listeners[eventType] = listeners = [];\n\t\t\t}\n\t\t\tlisteners.push(listener);\n\t\t\treturn true;\n\t\t}\n\n\t\tpublic removeEventListener(eventType:string, listener:EventListener):boolean {\n\t\t\tif (typeof(listener) != 'function') {\n\t\t\t\tLogger.warn('[EventDispatcher] removeEventListener : listener is not function, eventType = \\'' + eventType + '\\', listener = ' + listener);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tlet result = false;\n\t\t\tlet listeners:EventListener[] = this.listeners[eventType];\n\t\t\tif (listeners) {\n\t\t\t\tconst numListeners:number = listeners.length;\n\t\t\t\tfor (let i:number = 0; i < numListeners; ++i) {\n\t\t\t\t\tif (listener == listeners[i]) {\n\t\t\t\t\t\tlisteners.splice(i,  1);\n\t\t\t\t\t\tresult = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (listeners.length == 0) {\n\t\t\t\t\tdelete this.listeners[eventType];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\n\t\tpublic removeAllEventListener(eventType:string = null):void {\n\t\t\tif (eventType) {\n\t\t\t\tdelete this.listeners[eventType];\n\t\t\t} else {\n\t\t\t\tthis.listeners = {};\n\t\t\t}\n\t\t}\n\n\t\tpublic hasEventListener(eventType:string):boolean {\n\t\t\treturn this.listeners[eventType] != null;\n\t\t}\n\n\t\tpublic dispatchEvent(event:Event):void {\n\t\t\tlet listeners:EventListener[] = this.listeners[event.type];\n\t\t\tif (listeners) {\n\t\t\t\tlisteners = listeners.concat();\n\t\t\t\tconst numListeners:number = listeners.length;\n\t\t\t\tfor (let i:number = 0; i < numListeners; ++i) {\n\t\t\t\t\tlisteners[i].call(this.target, event);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tpublic dispatchEventType<T = any>(eventType:string, eventTarget:object = null, data:T = null):void {\n\t\t\tthis.dispatchEvent(new Event<object, T>(eventType, eventTarget, data));\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprivate target:any;\n\t\tprivate listeners:util.Hash<EventListener[]>;\n\t}\n}\n","/// <reference path='../index.ts' />\n\nnamespace cmd {\n\n\texport enum CommandState {\n\t\tsleeping     = 0,\n\t\texecuting    = 1,\n\t\tinterrupting = 2,\n\t}\n}\n","/// <reference path='../index.ts' />\n\nnamespace cmd {\n\n\timport Event = alm.event.Event;\n\n\texport class CommandEvent extends Event<Command> {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// EVENT\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic static readonly complete:string = 'CommandEvent.complete';\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(eventType:string, eventTarget:Command) {\n\t\t\tsuper(eventType, eventTarget);\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic clone():CommandEvent {\n\t\t\treturn new CommandEvent(this.type, this.target);\n\t\t}\n\n\t\tpublic toString():string {\n\t\t\treturn '[CommandEvent] type = ' + this.type;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\t}\n}\n","/// <reference path='../index.ts' />\n\nnamespace cmd {\n\n\timport EventDispatcher = alm.event.EventDispatcher;\n\n\texport class Command extends EventDispatcher {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(executeFunction:Function = null, interruptFunction:Function = null, destroyFunction:Function = null) {\n\t\t\tsuper();\n\n\t\t\tthis.setExecuteFunction(executeFunction);\n\t\t\tthis.setInterruptFunction(interruptFunction);\n\t\t\tthis.setDestroyFunction(destroyFunction);\n\n\t\t\tthis.state = CommandState.sleeping;\n\t\t\tthis.self = this;\n\t\t\tthis.parent = null;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic execute():void {\n\t\t\tif (this.state > CommandState.sleeping) {\n\t\t\t\tthrow new Error('[Command.execute] + Command is already executing.');\n\t\t\t}\n\t\t\tthis.state = CommandState.executing;\n\t\t\tthis.getExecuteFunction().call(this, this);\n\t\t}\n\n\t\tpublic interrupt():void {\n\t\t\tif (this.state == CommandState.executing) {\n\t\t\t\tthis.state = CommandState.interrupting;\n\t\t\t\tthis.getInterruptFunction().call(this, this);\n\t\t\t}\n\t\t}\n\n\t\tpublic destroy():void {\n\t\t\tthis.state = CommandState.sleeping;\n\t\t\tthis.getDestroyFunction().call(this, this);\n\t\t\tthis.parent = null;\n\t\t\tthis.executeFunction = null;\n\t\t\tthis.interruptFunction = null;\n\t\t\tthis.destroyFunction = null;\n\t\t}\n\n\t\tprotected notifyComplete():void {\n\t\t\tswitch (this.state) {\n\t\t\t\tcase CommandState.sleeping:\n\t\t\t\t\tbreak;\n\t\t\t\tcase CommandState.executing:\n\t\t\t\t\tthis.dispatchEvent(new CommandEvent(CommandEvent.complete, this));\n\t\t\t\t\tthis.destroy();\n\t\t\t\t\tbreak;\n\t\t\t\tcase CommandState.interrupting:\n\t\t\t\t\tthis.dispatchEvent(new CommandEvent(CommandEvent.complete, this));\n\t\t\t\t\tthis.destroy();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tprotected implExecuteFunction(command:Command):void {\n\t\t\tthis.notifyComplete();\n\t\t}\n\t\tprotected implInterruptFunction(command:Command):void {\n\t\t}\n\n\t\tprotected implDestroyFunction(command:Command):void {\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic getExecuteFunction():Function { return this.executeFunction || this.implExecuteFunction };\n\t\tpublic setExecuteFunction(func:Function):void { this.executeFunction = func; }\n\t\tprivate executeFunction:Function;\n\n\t\tpublic getInterruptFunction():Function { return this.interruptFunction || this.implInterruptFunction };\n\t\tpublic setInterruptFunction(func:Function):void { this.interruptFunction = func; }\n\t\tprivate interruptFunction:Function;\n\n\t\tpublic getDestroyFunction():Function { return this.destroyFunction || this.implDestroyFunction };\n\t\tpublic setDestroyFunction(func:Function):void { this.destroyFunction = func; }\n\t\tprivate destroyFunction:Function;\n\n\t\tpublic getState():CommandState { return this.state; }\n\t\tprivate state:CommandState;\n\n\t\tpublic getParent():Command { return this.parent; }\n\t\tpublic setParent(parent:Command):void { this.parent = parent; }\n\t\tprivate parent:Command;\n\n\t\tpublic getSelf():Command { return this.self; }\n\t\tprivate self:Command;\n\t}\n}\n","/// <reference path='../index.ts' />\n\nnamespace cmd {\n\n\texport abstract class CommandList extends Command {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(...commands:(Command|Function)[]) {\n\t\t\tsuper();\n\t\t\tthis.commands = [];\n\t\t\tthis.addCommand(...commands);\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic addCommand(...commands:(Command|Function)[]):void {\n\t\t\tif (commands.length > 0) {\n\t\t\t\tthis.preProcess(commands);\n\t\t\t\tthis.commands = this.getCommands().concat(<Command[]>commands);\n\t\t\t}\n\t\t}\n\n\t\tpublic insertCommand(...commands:(Command|Function)[]):void {\n\t\t\tthis.insertCommandAt(0, ...commands);\n\t\t}\n\n\t\tprotected insertCommandAt(index:number, ...commands:(Command|Function)[]):void {\n\t\t\tif (commands.length > 0) {\n\t\t\t\tthis.preProcess(commands);\n\t\t\t\tArray.prototype.splice.apply(this.getCommands(), (<any[]>[index, 0]).concat(commands));\n\t\t\t}\n\t\t}\n\n\t\tpublic addCommandArray(commands:(Command|Function)[]):void {\n\t\t\tthis.addCommand(...commands);\n\t\t}\n\n\t\tpublic insertCommandArray(commands:(Command|Function)[]):void {\n\t\t\tthis.insertCommand(...commands);\n\t\t}\n\n\t\tprotected insertCommandArrayAt(index:number, commands:(Command|Function)[]):void {\n\t\t\tthis.insertCommandAt(index, ...commands);\n\t\t}\n\n\t\tpublic getLength():number {\n\t\t\treturn this.commands.length;\n\t\t}\n\n\t\tpublic getCommandByIndex(index:number):Command { return this.commands[index]; }\n\t\tpublic getCommands():Command[] { return this.commands; }\n\n\t\tprivate preProcess(commands:(Command|Function)[]):void {\n\t\t\tconst numCommands:number = commands.length;\n\t\t\tlet command:Command|Function;\n\t\t\tfor (let i:number = 0; i < numCommands; ++i) {\n\t\t\t\tcommand = commands[i];\n\t\t\t\tif (typeof(command) == 'function') commands[i] = command = new Func(command);\n\t\t\t\tcommand.setParent(this);\n\t\t\t}\n\t\t}\n\n\t\tprotected implExecuteFunction(command:Command):void {\n\t\t\tthis.notifyComplete();\n\t\t}\n\n\t\tprotected implInterruptFunction(command:Command):void {\n\t\t}\n\n\t\tprotected implDestroyFunction(command:Command):void {\n\t\t}\n\n\t\tprotected abstract implNotifyBreak():void;\n\t\tprotected abstract implNotifyReturn():void;\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprivate commands:Command[];\n\t}\n}\n","/// <reference path='../index.ts' />\n\nnamespace cmd {\n\n\texport class Break extends Command {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor() {\n\t\t\tsuper();\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprotected implExecuteFunction(command:Command):void {\n\t\t\tconst func:Function = this.getParent()['notifyBreak'];\n\t\t\tif (func) func();\n\t\t\tthis.notifyComplete();\n\t\t}\n\n\t\tprotected implInterruptFunction(command:Command):void {\n\t\t}\n\n\t\tprotected implDestroyFunction(command:Command):void {\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\t}\n}\n","/// <reference path='../index.ts' />\n\nnamespace cmd {\n\n\texport class Return extends Command {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor() {\n\t\t\tsuper();\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprotected implExecuteFunction(command:Command):void {\n\t\t\tconst func:Function = this.getParent()['notifyReturn'];\n\t\t\tif (func) func();\n\t\t\tthis.notifyComplete();\n\t\t}\n\n\t\tprotected implInterruptFunction(command:Command):void {\n\t\t}\n\n\t\tprotected implDestroyFunction(command:Command):void {\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\t}\n}\n","/// <reference path='../index.ts' />\n\nnamespace cmd {\n\n\texport class Log extends Command {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(...messages:any[]) {\n\t\t\tsuper();\n\t\t\tthis.messages = messages;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprotected implExecuteFunction(command:Command):void {\n\t\t\tconsole.log.apply(console, Array.prototype.slice.call(this.messages));\n\t\t\tthis.notifyComplete();\n\t\t}\n\n\t\tprotected implInterruptFunction(command:Command):void {\n\t\t}\n\n\t\tprotected implDestroyFunction(command:Command):void {\n\t\t\tthis.messages = null;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic getMessages():any[] { return this.messages; }\n\t\tpublic setMessages(messages:any[]):void { this.messages = messages; }\n\t\tprivate messages:any[];\n\t}\n}\n","/// <reference path='../index.ts' />\n\nnamespace cmd {\n\n\texport class Wait extends Command {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(time:number = 1000) {\n\t\t\tsuper();\n\t\t\tthis.time = time;\n\t\t\tthis.timerId = -1;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprotected implExecuteFunction(command:Command):void {\n\t\t\tthis.timerId = window.setTimeout(this.completeHandler, this.time);\n\t\t}\n\n\t\tprotected implInterruptFunction(command:Command):void {\n\t\t\tthis.cancel();\n\t\t}\n\n\t\tprotected implDestroyFunction(command:Command):void {\n\t\t\tthis.cancel();\n\t\t}\n\n\t\tprivate cancel():void {\n\t\t\tif (this.timerId != -1) {\n\t\t\t\tclearTimeout(this.timerId);\n\t\t\t\tthis.timerId = -1;\n\t\t\t}\n\t\t}\n\n\t\tprivate completeHandler = ():void => {\n\t\t\tthis.notifyComplete();\n\t\t};\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic getTime():number { return this.time; }\n\t\tpublic setTime(time:number):void { this.time = time; }\n\t\tprivate time:number;\n\n\t\tprivate timerId:number;\n\t}\n}\n","/// <reference path='../index.ts' />\n\nnamespace cmd {\n\n\timport Event = alm.event.Event;\n\timport EventDispatcher = alm.event.EventDispatcher;\n\n\texport class Func extends Command {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(func:Function = null, args:any[] = [], eventDispatcher:EventDispatcher = null, eventType:string = null) {\n\t\t\tsuper();\n\t\t\tthis.func = func;\n\t\t\tthis.args = args;\n\t\t\tthis.eventDispatcher = eventDispatcher;\n\t\t\tthis.eventType = eventType;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprotected implExecuteFunction(command:Command):void {\n\t\t\tif (this.eventDispatcher && this.eventType) {\n\t\t\t\tthis.eventDispatcher.addEventListener(this.eventType, this.completeHandler);\n\t\t\t\tif (this.args) {\n\t\t\t\t\tthis.func(...this.args);\n\t\t\t\t} else {\n\t\t\t\t\tthis.func();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (this.args) {\n\t\t\t\t\tthis.func(...this.args);\n\t\t\t\t} else {\n\t\t\t\t\tthis.func();\n\t\t\t\t}\n\t\t\t\tthis.notifyComplete();\n\t\t\t}\n\t\t}\n\n\t\tprotected implInterruptFunction(command:Command):void {\n\t\t\tif (this.eventDispatcher && this.eventType) {\n\t\t\t\tthis.eventDispatcher.removeEventListener(this.eventType, this.completeHandler);\n\t\t\t}\n\t\t}\n\n\t\tprotected implDestroyFunction(command:Command):void {\n\t\t\tif (this.eventDispatcher && this.eventType) {\n\t\t\t\tthis.eventDispatcher.removeEventListener(this.eventType, this.completeHandler);\n\t\t\t}\n\n\t\t\tthis.func = null;\n\t\t\tthis.args = null;\n\t\t\tthis.eventDispatcher = null;\n\t\t\tthis.eventType = null;\n\t\t}\n\n\t\tprivate completeHandler = (event:Event):void => {\n\t\t\tthis.notifyComplete();\n\t\t};\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic getFunction():Function { return this.func; }\n\t\tpublic setFunction(func:Function):void { this.func = func; }\n\t\tprivate func:Function;\n\n\t\tpublic getArguments():any[] { return this.args; }\n\t\tpublic setArguments(args:any[]):void { this.args = args; }\n\t\tprivate args:any[];\n\n\t\tpublic getEventDispatcher():EventDispatcher { return this.eventDispatcher; }\n\t\tpublic setEventDispatcher(eventDispatcher:EventDispatcher):void { this.eventDispatcher = eventDispatcher; }\n\t\tprivate eventDispatcher:EventDispatcher;\n\n\t\tpublic getEventType():string { return this.eventType; }\n\t\tpublic setEventType(eventType:string):void { this.eventType = eventType; }\n\t\tprivate eventType:string;\n\t}\n}\n","/// <reference path='../index.ts' />\n\nnamespace cmd {\n\n\timport Event = alm.event.Event;\n\timport EventDispatcher = alm.event.EventDispatcher;\n\n\texport class Listen extends Command {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(eventDispatcher:EventDispatcher = null, eventType:string = null) {\n\t\t\tsuper();\n\t\t\tthis.eventDispatcher = eventDispatcher;\n\t\t\tthis.eventType = eventType;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprotected implExecuteFunction(command:Command):void {\n\t\t\tif (this.eventDispatcher && this.eventType) {\n\t\t\t\tthis.eventDispatcher.addEventListener(this.eventType, this.completeHandler);\n\t\t\t}\n\t\t}\n\n\t\tprotected implInterruptFunction(command:Command):void {\n\t\t\tif (this.eventDispatcher && this.eventType) {\n\t\t\t\tthis.eventDispatcher.removeEventListener(this.eventType, this.completeHandler);\n\t\t\t}\n\t\t}\n\n\t\tprotected implDestroyFunction(command:Command):void {\n\t\t\tif (this.eventDispatcher && this.eventType) {\n\t\t\t\tthis.eventDispatcher.removeEventListener(this.eventType, this.completeHandler);\n\t\t\t}\n\n\t\t\tthis.eventType = null;\n\t\t\tthis.eventDispatcher = null;\n\t\t}\n\n\t\tprivate completeHandler = (event:Event):void => {\n\t\t\tthis.notifyComplete();\n\t\t};\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic getEventDispatcher():EventDispatcher { return this.eventDispatcher; }\n\t\tpublic setEventDispatcher(eventDispatcher:EventDispatcher):void { this.eventDispatcher = eventDispatcher; }\n\t\tprivate eventDispatcher:EventDispatcher;\n\n\t\tpublic getEventType():string { return this.eventType; }\n\t\tpublic setEventType(eventType:string):void { this.eventType = eventType; }\n\t\tprivate eventType:string;\n\t}\n}\n","/// <reference path='../index.ts' />\n\nnamespace cmd {\n\n\timport Easing = alm.math.Easing;\n\timport EasingFunction = alm.math.EasingFunction;\n\timport Time = alm.util.Time;\n\n\texport type TweenCallbackFunction = (progressTime:number, progressValue:number) => void;\n\n\texport class Tween extends Command {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(target:Object, to:Object, from:Object = null, duration:number = 1000, easing:EasingFunction = Easing.linear, onStart:TweenCallbackFunction = null, onUpdate:TweenCallbackFunction = null, onComplete:TweenCallbackFunction = null) {\n\t\t\tsuper();\n\t\t\tthis.tweenTarget = target;\n\t\t\tthis.to = to;\n\t\t\tthis.from = from;\n\t\t\tthis.duration = duration;\n\t\t\tthis.easing = easing;\n\t\t\tthis.onStart = onStart;\n\t\t\tthis.onUpdate = onUpdate;\n\t\t\tthis.onComplete = onComplete;\n\t\t\tthis.progressTime = 0;\n\t\t\tthis.progressValue = 0;\n\t\t\tthis.startTime = 0;\n\t\t\tthis.timerId = -1;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprotected implExecuteFunction(command:Command):void {\n\t\t\tthis.internalFrom = {};\n\t\t\tlet value0:number;\n\t\t\tlet value1:number;\n\t\t\tfor (let key in this.to) {\n\t\t\t\tvalue1 = this.to[key];\n\t\t\t\tif (this.from && this.from[key] != null) {\n\t\t\t\t\tthis.internalFrom[key] = this.from[key];\n\t\t\t\t} else {\n\t\t\t\t\tthis.internalFrom[key] = this.tweenTarget[key];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.duration > 0) {\n\t\t\t\tthis.timerId = window.setInterval(this.intervalHandler, Tween.updateInterval);\n\t\t\t\tthis.startTime = Time.now();\n\t\t\t\tthis.apply(0);\n\t\t\t\tif (this.onStart) this.onStart(this.progressTime, this.progressValue);\n\t\t\t} else {\n\t\t\t\tthis.apply(0);\n\t\t\t\tif (this.onStart) this.onStart(this.progressTime, this.progressValue);\n\t\t\t\tthis.apply(1);\n\t\t\t\tif (this.onUpdate) this.onUpdate(this.progressTime, this.progressValue);\n\t\t\t\tif (this.onComplete) this.onComplete(this.progressTime, this.progressValue);\n\t\t\t\tthis.notifyComplete();\n\t\t\t}\n\t\t}\n\n\t\tprotected implInterruptFunction(command:Command):void {\n\t\t\tthis.cancel();\n\t\t}\n\n\t\tprotected implDestroyFunction(command:Command):void {\n\t\t\tthis.cancel();\n\n\t\t\tthis.tweenTarget = null;\n\t\t\tthis.to = null;\n\t\t\tthis.from = null;\n\t\t\tthis.easing = null;\n\t\t\tthis.onStart = null;\n\t\t\tthis.onUpdate = null;\n\t\t\tthis.onComplete = null;\n\t\t\tthis.internalFrom = null;\n\t\t}\n\n\t\tprivate cancel():void {\n\t\t\tif (this.timerId != -1) {\n\t\t\t\tclearInterval(this.timerId);\n\t\t\t\tthis.timerId = -1;\n\t\t\t}\n\t\t}\n\n\t\tprivate apply(timeRatio:number):void {\n\t\t\tthis.progressTime = timeRatio;\n\t\t\tthis.progressValue = this.easing(this.progressTime);\n\t\t\tlet value0:number;\n\t\t\tfor (let key in this.to) {\n\t\t\t\tvalue0 = this.internalFrom[key];\n\t\t\t\tthis.tweenTarget[key] = value0 + (this.to[key] - value0) * this.progressValue;\n\t\t\t}\n\t\t}\n\n\t\tprivate intervalHandler = ():void => {\n\t\t\tconst elapsedTime = Time.now() - this.startTime;\n\t\t\tif (elapsedTime < this.duration) {\n\t\t\t\tthis.apply(elapsedTime / this.duration);\n\t\t\t\tif (this.onUpdate) this.onUpdate(this.progressTime, this.progressValue);\n\t\t\t} else {\n\t\t\t\tthis.apply(1);\n\t\t\t\tthis.cancel();\n\t\t\t\tif (this.onUpdate) this.onUpdate(this.progressTime, this.progressValue);\n\t\t\t\tif (this.onComplete) this.onComplete(this.progressTime, this.progressValue);\n\t\t\t\tthis.notifyComplete();\n\t\t\t}\n\t\t};\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic getTarget():Object { return this.tweenTarget; }\n\t\tpublic setTarget(target:Object):void { this.tweenTarget = target; }\n\t\tprivate tweenTarget:Object;\n\n\t\tpublic getDuration():number { return this.duration; }\n\t\tpublic setDuration(duration:number):void { this.duration = duration; }\n\t\tprivate duration:number;\n\n\t\tpublic getTo():Object { return this.to; }\n\t\tpublic setTo(to:Object):void { this.to = to; }\n\t\tprivate to:Object;\n\n\t\tpublic getFrom():Object { return this.from; }\n\t\tpublic setFrom(from:Object):void { this.from = from; }\n\t\tprivate from:Object;\n\n\t\tpublic getEasing():EasingFunction { return this.easing; }\n\t\tpublic setEasing(easing:EasingFunction):void { this.easing = easing; }\n\t\tprivate easing:EasingFunction;\n\n\t\tpublic getOnStart():TweenCallbackFunction { return this.onStart; }\n\t\tpublic setOnStart(func:TweenCallbackFunction):void { this.onStart = func; }\n\t\tprivate onStart:TweenCallbackFunction;\n\n\t\tpublic getOnUpdate():TweenCallbackFunction { return this.onUpdate; }\n\t\tpublic setOnUpdate(func:TweenCallbackFunction):void { this.onUpdate = func; }\n\t\tprivate onUpdate:TweenCallbackFunction;\n\n\t\tpublic getOnComplete():TweenCallbackFunction { return this.onComplete; }\n\t\tpublic setOnComplete(func:TweenCallbackFunction):void { this.onComplete = func; }\n\t\tprivate onComplete:TweenCallbackFunction;\n\n\t\tpublic getProgressTime():number { return this.progressTime; }\n\t\tprivate progressTime:number;\n\n\t\tpublic getProgressValue():number { return this.progressValue; }\n\t\tprivate progressValue:number;\n\n\t\tprivate startTime:number;\n\t\tprivate timerId:number;\n\t\tprivate internalFrom:Object;\n\n\t\tpublic getUpdateInterval():number { return Tween.updateInterval; }\n\t\tpublic setUpdateInterval(milliseconds:number):void { Tween.updateInterval = milliseconds; }\n\t\tprivate static updateInterval:number = 1000 / 60;\n\t}\n}\n","/// <reference path='../index.ts' />\n\nnamespace cmd {\n\n\texport type Condition = boolean | Function;\n\n\texport class If extends Command {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(condition:Condition = false, then:Command = null, reject:Command = null) {\n\t\t\tsuper();\n\t\t\tthis.condition = condition;\n\t\t\tthis.then = then;\n\t\t\tthis.reject = reject;\n\t\t\tthis.selectedCommand = null;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprotected implExecuteFunction(command:Command):void {\n\t\t\tlet result:boolean;\n\t\t\tif (typeof this.condition === 'function') {\n\t\t\t\tresult = this.condition();\n\t\t\t} else {\n\t\t\t\tresult = this.condition;\n\t\t\t}\n\n\t\t\tif (result) {\n\t\t\t\tif (this.then) {\n\t\t\t\t\tthis.selectedCommand = this.then;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (this.reject) {\n\t\t\t\t\tthis.selectedCommand = this.reject;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.selectedCommand) {\n\t\t\t\tthis.selectedCommand.addEventListener(CommandEvent.complete, this.completeHandler);\n\t\t\t\tthis.selectedCommand.execute();\n\t\t\t} else {\n\t\t\t\tthis.notifyComplete();\n\t\t\t}\n\t\t}\n\n\t\tprotected implInterruptFunction(command:Command):void {\n\t\t\tif (this.selectedCommand) {\n\t\t\t\tthis.selectedCommand.removeEventListener(CommandEvent.complete, this.completeHandler);\n\t\t\t\tthis.selectedCommand.interrupt();\n\t\t\t\tthis.selectedCommand = null;\n\t\t\t}\n\t\t}\n\n\t\tprotected implDestroyFunction(command:Command):void {\n\t\t\tif (this.selectedCommand) {\n\t\t\t\tthis.selectedCommand.removeEventListener(CommandEvent.complete, this.completeHandler);\n\t\t\t\tthis.selectedCommand.destroy();\n\t\t\t\tthis.selectedCommand = null;\n\t\t\t}\n\n\t\t\tthis.condition = null;\n\t\t\tthis.then = null;\n\t\t\tthis.reject = null;\n\t\t}\n\n\t\tprivate completeHandler = (event:CommandEvent):void => {\n\t\t\tthis.selectedCommand.removeEventListener(CommandEvent.complete, this.completeHandler);\n\t\t\tthis.selectedCommand = null;\n\t\t\tthis.notifyComplete();\n\t\t};\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic getCondition():Condition { return this.condition; }\n\t\tpublic setCondition(condition:Condition):void { this.condition = condition; }\n\t\tprivate condition:Condition;\n\n\t\tpublic getThen():Command { return this.then; }\n\t\tpublic setThen(then:Command):void { this.then = then; }\n\t\tprivate then:Command;\n\n\t\tpublic getReject():Command { return this.reject; }\n\t\tpublic setReject(reject:Command):void { this.reject = reject; }\n\t\tprivate reject:Command;\n\n\t\tprivate selectedCommand:Command;\n\t}\n}\n","/// <reference path='../index.ts' />\n\nnamespace cmd {\n\n\timport Event = alm.event.Event;\n\n\texport class Serial extends CommandList {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(...commands:(Command|Function)[]) {\n\t\t\tsuper(...commands);\n\t\t\tthis.currentCommand = null;\n\t\t\tthis.position = -1;\n\t\t\tthis.isPaused = false;\n\t\t\tthis.isCompleteOnPaused = false;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic addCommand(...commands:(Command|Function)[]):void {\n\t\t\tsuper.addCommand(...commands);\n\t\t}\n\n\t\tpublic insertCommand(...commands:(Command|Function)[]):void {\n\t\t\tsuper.insertCommandAt(this.position + 1, ...commands);\n\t\t}\n\n\t\tpublic addCommandArray(commands:(Command|Function)[]):void {\n\t\t\tthis.addCommand(...commands);\n\t\t}\n\n\t\tpublic insertCommandArray(commands:(Command|Function)[]):void {\n\t\t\tthis.insertCommand(...commands);\n\t\t}\n\n\t\tprivate next():void {\n\t\t\tthis.currentCommand = this.getCommandByIndex(this.position);\n\t\t\tthis.currentCommand.addEventListener(CommandEvent.complete, this.completeHandler);\n\t\t\tthis.currentCommand.execute();\n\t\t}\n\n\t\tprivate completeHandler = (event:Event<Command>):void => {\n\t\t\tthis.currentCommand.removeEventListener(CommandEvent.complete, this.completeHandler);\n\t\t\tthis.currentCommand = null;\n\t\t\tif (++this.position >= this.getLength()) {\n\t\t\t\tthis.notifyComplete();\n\t\t\t} else {\n\t\t\t\tthis.next();\n\t\t\t}\n\t\t};\n\n\t\tprotected implExecuteFunction(command:Command):void {\n\t\t\tthis.position = 0;\n\t\t\tif (this.getLength() > 0) {\n\t\t\t\tthis.next();\n\t\t\t} else {\n\t\t\t\tthis.notifyComplete();\n\t\t\t}\n\t\t}\n\n\t\tprotected implInterruptFunction(command:Command):void {\n\t\t\tif (this.currentCommand) {\n\t\t\t\tthis.currentCommand.removeEventListener(CommandEvent.complete, this.completeHandler);\n\t\t\t\tthis.currentCommand.interrupt();\n\t\t\t\tthis.currentCommand = null;\n\t\t\t}\n\t\t\tthis.position = -1;\n\t\t\tsuper.implInterruptFunction(command);\n\t\t}\n\n\t\tprotected implDestroyFunction(command:Command):void {\n\t\t\tif (this.currentCommand) {\n\t\t\t\tthis.currentCommand.removeEventListener(CommandEvent.complete, this.completeHandler);\n\t\t\t\tthis.currentCommand.destroy();\n\t\t\t\tthis.currentCommand = null;\n\t\t\t}\n\t\t\tthis.position = -1;\n\t\t\tthis.isPaused = false;\n\t\t\tthis.isCompleteOnPaused = false;\n\t\t\tsuper.implDestroyFunction(command);\n\t\t}\n\n\t\tprotected implNotifyBreak():void {\n\t\t\tif (this.currentCommand.getState() == CommandState.executing) {\n\t\t\t\tthis.currentCommand.removeEventListener(CommandEvent.complete, this.completeHandler);\n\t\t\t\tthis.currentCommand.interrupt();\n\t\t\t}\n\t\t\tthis.notifyComplete();\n\t\t}\n\n\t\tprotected implNotifyReturn():void {\n\t\t\tif (this.currentCommand.getState() == CommandState.executing) {\n\t\t\t\tthis.currentCommand.removeEventListener(CommandEvent.complete, this.completeHandler);\n\t\t\t\tthis.currentCommand.interrupt();\n\t\t\t}\n\t\t\tconst func:Function = this.getParent()['notifyReturn'];\n\t\t\tif (func) func();\n\t\t\tthis.destroy();\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprotected getPosition():number { return this.position; }\n\t\tprivate position:number;\n\n\t\tprivate currentCommand:Command;\n\t\tprivate isPaused:boolean;\n\t\tprivate isCompleteOnPaused:boolean;\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.geom {\n\n\texport class Vector2 {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(x:number = 0, y:number = 0) {\n\t\t\tthis.set(x, y);\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic set(x:number, y:number):void {\n\t\t\tthis.x = x;\n\t\t\tthis.y = y;\n\t\t}\n\n\t\tpublic copyTo(point:Vector2):void {\n\t\t\tpoint.set(this.x, this.y);\n\t\t}\n\n\t\tpublic getClone():Vector2 {\n\t\t\treturn new Vector2(this.x, this.y);\n\t\t}\n\n\t\tpublic zero():void {\n\t\t\tthis.set(0, 0);\n\t\t}\n\n\t\tpublic normalize():void {\n\t\t\tconst l:number = this.getLength();\n\t\t\tthis.x /= l;\n\t\t\tthis.y /= l;\n\t\t}\n\n\t\tpublic getLength():number {\n\t\t\treturn Math.sqrt(this.x * this.x + this.y * this.y);\n\t\t}\n\n\t\tpublic getSquareDistance(point:Vector2):number {\n\t\t\tconst dx:number = point.x - this.x;\n\t\t\tconst dy:number = point.y - this.y;\n\t\t\treturn dx * dx + dy * dy;\n\t\t}\n\n\t\tpublic getDistance(point:Vector2):number {\n\t\t\treturn Math.sqrt(this.getSquareDistance(point));\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic x:number;\n\t\tpublic y:number;\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.geom {\n\n\texport class Vector3 {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(x:number = 0, y:number = 0, z:number = 0) {\n\t\t\tthis.set(x, y, z);\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic set(x:number, y:number, z:number):void {\n\t\t\tthis.x = x;\n\t\t\tthis.y = y;\n\t\t\tthis.z = z;\n\t\t}\n\n\t\tpublic copyTo(point:Vector3):void {\n\t\t\tpoint.set(this.x, this.y, this.z);\n\t\t}\n\n\t\tpublic getClone():Vector3 {\n\t\t\treturn new Vector3(this.x, this.y, this.z);\n\t\t}\n\n\t\tpublic zero():void {\n\t\t\tthis.set(0, 0, 0);\n\t\t}\n\n\t\tpublic normalize():void {\n\t\t\tconst l:number = this.getLength();\n\t\t\tthis.x /= l;\n\t\t\tthis.y /= l;\n\t\t\tthis.z /= l;\n\t\t}\n\n\t\tpublic getLength():number {\n\t\t\treturn Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);\n\t\t}\n\n\t\tpublic getSquareDistance(point:Vector3):number {\n\t\t\tconst dx:number = point.x - this.x;\n\t\t\tconst dy:number = point.y - this.y;\n\t\t\tconst dz:number = point.z - this.z;\n\t\t\treturn dx * dx + dy * dy + dz * dz;\n\t\t}\n\n\t\tpublic getDistance(point:Vector3):number {\n\t\t\treturn Math.sqrt(this.getSquareDistance(point));\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic x:number;\n\t\tpublic y:number;\n\t\tpublic z:number;\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.geom {\n\n\texport class Rectangle {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(x:number = 0, y:number = 0, width:number = 0, height:number = 0) {\n\t\t\tthis.set(x, y, width, height);\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic set(x:number, y:number, width:number, height:number):void {\n\t\t\tthis.x = x;\n\t\t\tthis.y = y;\n\t\t\tthis.width = width;\n\t\t\tthis.height = height;\n\t\t}\n\n\t\tpublic copyTo(rect:Rectangle):void {\n\t\t\trect.set(this.x, this.y, this.width, this.height);\n\t\t}\n\n\t\tpublic getClone():Rectangle {\n\t\t\treturn new Rectangle(this.x, this.y, this.width, this.height);\n\t\t}\n\n\t\tpublic getTop():number {\n\t\t\treturn this.y;\n\t\t}\n\n\t\tpublic getBottom():number {\n\t\t\treturn this.y + this.height;\n\t\t}\n\n\t\tpublic getLeft():number {\n\t\t\treturn this.x;\n\t\t}\n\n\t\tpublic getRight():number {\n\t\t\treturn this.x + this.width;\n\t\t}\n\n\t\tpublic getTopLeft():Vector2 {\n\t\t\treturn new Vector2(this.getLeft(), this.getTop());\n\t\t}\n\n\t\tpublic getTopRight():Vector2 {\n\t\t\treturn new Vector2(this.getRight(), this.getTop());\n\t\t}\n\n\t\tpublic getBottomLeft():Vector2 {\n\t\t\treturn new Vector2(this.getLeft(), this.getBottom());\n\t\t}\n\n\t\tpublic getBottomRight():Vector2 {\n\t\t\treturn new Vector2(this.getRight(), this.getBottom());\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic x:number;\n\t\tpublic y:number;\n\t\tpublic width:number;\n\t\tpublic height:number;\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.geom {\n\n\texport enum Align {\n\t\ttopLeft,\n\t\ttopCenter,\n\t\ttopRight,\n\t\tmiddleLeft,\n\t\tmiddleCenter,\n\t\tmiddleRight,\n\t\tbottomLeft,\n\t\tbottomCenter,\n\t\tbottomRight\n\t}\n\n\texport enum ScaleMode {\n\t\texactFit,\n\t\tshowAll,\n\t\tnoBorder,\n\t\tnoScale,\n\t}\n\n\texport class Boxer {\n\n\t\tpublic static resize(target:geom.Rectangle, bounds:geom.Rectangle, scaleMode:ScaleMode = ScaleMode.showAll, align:Align = Align.middleCenter):geom.Rectangle {\n\t\t\tlet tx:number = target.x;\n\t\t\tlet ty:number = target.y;\n\t\t\tlet tw:number = target.width;\n\t\t\tlet th:number = target.height;\n\n\t\t\tconst bx:number = bounds.x;\n\t\t\tconst by:number = bounds.y;\n\t\t\tconst bw:number = bounds.width;\n\t\t\tconst bh:number = bounds.height;\n\n\t\t\tswitch (scaleMode) {\n\t\t\t\tcase ScaleMode.showAll:\n\t\t\t\tcase ScaleMode.noBorder:\n\t\t\t\t\tconst ratioW:number = bw / tw;\n\t\t\t\t\tconst ratioH:number = bh / th;\n\t\t\t\t\tconst ratio:number = scaleMode == ScaleMode.showAll ? (ratioW < ratioH ? ratioW : ratioH) : (ratioW > ratioH ? ratioW : ratioH);\n\t\t\t\t\ttw *= ratio;\n\t\t\t\t\tth *= ratio;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase ScaleMode.exactFit:\n\t\t\t\t\treturn new geom.Rectangle(bx, by, bw, bh);\n\t\t\t}\n\n\t\t\ttx = bx + ((align == Align.topLeft || align == Align.middleLeft || align == Align.bottomLeft) ? 0 :\n\t\t\t\t(align == Align.topRight || align == Align.middleRight || align == Align.bottomRight) ? (bw - tw) : (bw - tw) / 2);\n\t\t\tty = by + ((align == Align.topLeft || align == Align.topCenter || align == Align.topRight) ? 0 :\n\t\t\t\t(align == Align.bottomLeft || align == Align.bottomCenter || align == Align.bottomRight) ? (bh - th) : (bh - th) / 2);\n\n\t\t\treturn new geom.Rectangle(tx, ty, tw, th);\n\t\t}\n\n\t\tprivate constructor() {}\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.util {\n\n\texport class Obj {\n\n\t\tpublic static each(target:any, func:(key:string, value:any) => void):void {\n\t\t\tif (target == null) return;\n\t\t\tObject.keys(target).forEach((key:string):void => {\n\t\t\t\tfunc(key, target[key]);\n\t\t\t});\n\t\t}\n\n\t\tpublic static get(target:any, key:string, defaultValue:any):any {\n\t\t\tconst value:any = target[key];\n\t\t\treturn typeof value !== 'undefined' ? value : defaultValue;\n\t\t}\n\n\t\tprivate constructor() {}\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.util {\n\n\texport class Arr {\n\n\t\t/**\n\t\t * \n\t\t * @param {number} count \n\t\t * @param {number} init \n\t\t * @param {number} step \n\t\t * @returns {number[]} \n\t\t */\n\t\tpublic static sequence(count:number, init:number = 0, step:number = 1):number[] {\n\t\t\tconst result:number[] = new Array(count);\n\t\t\tlet v:number = init;\n\t\t\tfor (let i:number = 0; i < count; ++i) {\n\t\t\t\tresult[i] = v;\n\t\t\t\tv += step;\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\n\t\t/**\n\t\t * \n\t\t * @param list \n\t\t * @returns {T[]} \n\t\t */\n\t\tpublic static unique<T>(list:T[]):T[] {\n\t\t\treturn list.filter(function (x:T, i:number, self:T[]) {\n\t\t\t\treturn self.indexOf(x) === i;\n\t\t\t});\n\t\t}\n\n\t\t/**\n\t\t * \n\t\t * @param list \n\t\t * @param unique true\n\t\t * @returns {T[]} \n\t\t */\n\t\tpublic static duplicated<T>(list:T[], unique:boolean = false):T[] {\n\n\t\t\tif (unique) {\n\t\t\t\treturn list.filter(function (x:T, i:number, self:T[]) {\n\t\t\t\t\treturn self.indexOf(x) !== self.lastIndexOf(x);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\treturn list.filter(function (x:T, i:number, self:T[]) {\n\t\t\t\t\treturn (self.indexOf(x) === i) && (self.lastIndexOf(x) !== i);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * 2\n\t\t * @param {T[]} list1 1\n\t\t * @param {T[]} list2 2\n\t\t * @param {(count: number, index1: number, index2: number, element1: T, element2: T) => void} callback \n\t\t * @param callback.count \n\t\t * @param callback.index1 1\n\t\t * @param callback.index2 2\n\t\t * @param callback.element1 1\n\t\t * @param callback.element2 2\n\t\t */\n\t\tpublic static roundRobin<T>(list1:T[], list2:T[], callback:(count:number, index1:number, index2:number, element1:T, element2:T) => void):void {\n\t\t\tlet i:number, j:number, p:number = 1;\n\t\t\tconst m:number = list1.length;\n\t\t\tconst n:number = list2.length;\n\t\t\tfor (i = 0; i < m; ++i) {\n\t\t\t\tfor (j = i + 1; j < n; ++j) {\n\t\t\t\t\tcallback(p++, i, j, list1[i], list2[j]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * \n\t\t * @param list \n\t\t * @param index1 1\n\t\t * @param index2 2\n\t\t */\n\t\tpublic static swap<T>(list:T[], index1:number, index2:number):void {\n\t\t\tconst tmp = list[index1];\n\t\t\tlist[index1] = list[index2];\n\t\t\tlist[index2] = tmp;\n\t\t}\n\n\t\t/**\n\t\t * \n\t\t * by FisherYates\n\t\t * @param list \n\t\t */\n\t\tpublic static shuffle<T>(list:T[]):void {\n\t\t\tfor(let i = list.length - 1; i > 0; --i) {\n\t\t\t\tArr.swap(list, i, Math.floor(Math.random() * (i + 1)));\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * \n\t\t * @param list \n\t\t * @param asc true, false\n\t\t */\n\t\tpublic static sort(list:number[], asc:boolean = true):void {\n\t\t\tlist.sort(asc ? function(a, b) { return a - b; } : function(a, b) { return b - a; });\n\t\t}\n\n\t\t/**\n\t\t * 1\n\t\t * @param list \n\t\t * @returns {T} \n\t\t */\n\t\tpublic static choose<T>(list:T[]):T {\n\t\t\treturn list[Math.floor(Math.random() * list.length)];\n\t\t}\n\n\t\t/**\n\t\t * \n\t\t * Boolean0\n\t\t * @param list \n\t\t * @returns {T[]} \n\t\t */\n\t\tpublic static clean<T>(list:T[]):T[] {\n\t\t\treturn list.filter(Boolean);\n\t\t}\n\n\n\t\t/**\n\t\t * false\n\t\t * @param list \n\t\t * @param f false\n\t\t */\n\t\tpublic static update<T>(list:T[], f:(item:T) => (void | boolean)):void {\n\t\t\tlet n = list.length;\n\t\t\tfor (let i = 0; i < n; ++i) {\n\t\t\t\tconst item = list[i];\n\t\t\t\tif (f(item) === false) {\n\t\t\t\t\tlist.splice(i, 1);\n\t\t\t\t\t--i;\n\t\t\t\t\t--n;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\n\t\tprivate constructor() {}\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.util {\n\n\timport EasingFunction = alm.math.EasingFunction;\n\n\texport class Num {\n\n\t\t/**\n\t\t * \n\t\t * @param {number} value \n\t\t * @param {number} srcA A\n\t\t * @param {number} srcB B\n\t\t * @param {number} dstA A\n\t\t * @param {number} dstB B\n\t\t * @param {boolean} clamp true[srcA, srcB]\n\t\t * @returns {number} \n\t\t */\n\t\tpublic static map(value:number, srcA:number, srcB:number, dstA:number, dstB:number, clamp:boolean = true):number {\n\t\t\tif (srcA === srcB) return dstA;\n\t\t\tif (clamp) {\n\t\t\t\tif (srcA < srcB) {\n\t\t\t\t\tif (value < srcA) value = srcA;\n\t\t\t\t\telse if (value > srcB) value = srcB;\n\t\t\t\t} else {\n\t\t\t\t\tif (value < srcB) value = srcB;\n\t\t\t\t\telse if (value > srcA) value = srcA;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn (value - srcA) * (dstB - dstA) / (srcB - srcA) + dstA;\n\t\t}\n\n\t\t/**\n\t\t * \n\t\t * @param {number} value \n\t\t * @param {number} srcA A\n\t\t * @param {number} srcB B\n\t\t * @param {number} dstA A\n\t\t * @param {number} dstB B\n\t\t * @param {EasingFunction} easing \n\t\t * @returns {number} \n\t\t */\n\t\tpublic static ease(value:number, srcA:number, srcB:number, dstA:number, dstB:number, easing:EasingFunction):number {\n\t\t\tif (srcA === srcB) return dstA;\n\t\t\tif (srcA < srcB) {\n\t\t\t\tif (value < srcA) value = srcA;\n\t\t\t\telse if (value > srcB) value = srcB;\n\t\t\t\treturn easing((value - srcA) / (srcB - srcA)) * (dstB - dstA) + dstA;\n\t\t\t} else {\n\t\t\t\tif (value < srcB) value = srcB;\n\t\t\t\telse if (value > srcA) value = srcA;\n\t\t\t\treturn easing((value - srcB) / (srcA - srcB)) * (dstB - dstA) + dstA;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * \n\t\t * @param {number} value \n\t\t * @param {number} min \n\t\t * @param {number} max \n\t\t * @returns {number} \n\t\t */\n\t\tpublic static clamp(value:number, min:number, max:number):number {\n\t\t\treturn value < min ? min : (value > max ? max : value);\n\t\t}\n\n\t\t/**\n\t\t * \n\t\t * @param {number} value \n\t\t * @param {number} minAbs \n\t\t * @param {number} maxAbs \n\t\t * @returns {number} \n\t\t */\n\t\tpublic static clampAbs(value:number, minAbs:number, maxAbs:number):number {\n\t\t\tif (value > 0) {\n\t\t\t\treturn value < minAbs ? minAbs : (value > maxAbs ? maxAbs : value);\n\t\t\t} else {\n\t\t\t\tvalue = Math.abs(value);\n\t\t\t\treturn -(value < minAbs ? minAbs : (value > maxAbs ? maxAbs : value));\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * 2\n\t\t * @param {number} t \n\t\t * @param {number} a \n\t\t * @param {number} b \n\t\t * @param {boolean} clamp true[a, b]\n\t\t * @returns {number}  (t=0a, t=1b)\n\t\t */\n\t\tpublic static lerp(t:number, a:number, b:number, clamp:boolean = true):number {\n\t\t\tif (clamp) {\n\t\t\t\tif (t < 0) t = 0;\n\t\t\t\telse if (t > 1) t = 1;\n\t\t\t}\n\t\t\treturn a * (1 - t) + b * t;\n\t\t}\n\n\t\t/**\n\t\t * \n\t\t * @param {number} min \n\t\t * @param {number} max \n\t\t * @returns {number} \n\t\t */\n\t\tpublic static random(min:number = 0, max:number = 1):number {\n\t\t\treturn min + (max - min) * Math.random();\n\t\t}\n\n\t\t/**\n\t\t * \n\t\t * @param {number} min \n\t\t * @param {number} max \n\t\t * @returns {number} \n\t\t */\n\t\tpublic static randomInt(min:number = 0, max:number = 1):number {\n\t\t\treturn Math.floor(Num.random(min, max + 1));\n\t\t}\n\n\t\t/**\n\t\t * \n\t\t * @param {number} min \n\t\t * @param {number} max \n\t\t * @returns {number} \n\t\t */\n\t\tpublic static randomAbs(min:number = 0, max:number = 1):number {\n\t\t\treturn Num.random(min, max) * Num.randomSign();\n\t\t}\n\n\t\t/**\n\t\t * +1-1\n\t\t * @returns {number} \n\t\t */\n\t\tpublic static randomSign():number {\n\t\t\treturn Math.random() < 0.5 ? 1 : -1;\n\t\t}\n\n\t\t/**\n\t\t * 2\n\t\t * @param {number} x1 1x\n\t\t * @param {number} y1 1y\n\t\t * @param {number} x2 2x\n\t\t * @param {number} y2 2y\n\t\t * @param {boolean} squared true2\n\t\t * @returns {number} \n\t\t */\n\t\tpublic static dist(x1:number, y1:number, x2:number, y2:number, squared:boolean = false):number {\n\t\t\tconst dx:number = x2 - x1;\n\t\t\tconst dy:number = y2 - y1;\n\t\t\treturn squared ? (dx * dx + dy * dy) : Math.sqrt(dx * dx + dy * dy);\n\t\t}\n\n\t\t/**\n\t\t * \n\t\t * @param {number} radian \n\t\t * @returns {number} \n\t\t */\n\t\tpublic static radToDeg(radian:number):number {\n\t\t\treturn radian * Num.RAD2DEG;\n\t\t}\n\n\t\t/**\n\t\t * \n\t\t * @param {number} radian \n\t\t * @returns {number} \n\t\t */\n\t\tpublic static degToRad(degree:number):number {\n\t\t\treturn degree * Num.DEG2RAD;\n\t\t}\n\n\t\t/**\n\t\t * \n\t\t * @param {number} from \n\t\t * @param {number} to \n\t\t * @param {boolean} radian true\n\t\t * @returns {number} \n\t\t */\n\t\tpublic static turn(from:number, to:number, radian:boolean = true):number {\n\t\t\treturn radian ? ((to - from + Num.PI3) % Num.PI2 - Math.PI) : ((to - from + 540) % 360 - 180);\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONST\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic static readonly PI2:number = Math.PI * 2;\n\t\tpublic static readonly PI3:number = Math.PI * 3;\n\t\tpublic static readonly PI4:number = Math.PI * 4;\n\t\tpublic static readonly PI5:number = Math.PI * 5;\n\t\tpublic static readonly PI6:number = Math.PI * 6;\n\t\tpublic static readonly PI_2:number = Math.PI / 2;\n\t\tpublic static readonly PI_3:number = Math.PI / 3;\n\t\tpublic static readonly PI_4:number = Math.PI / 4;\n\t\tpublic static readonly PI_6:number = Math.PI / 6;\n\n\t\tprivate static RAD2DEG:number = 180 / Math.PI;\n\t\tprivate static DEG2RAD:number = Math.PI / 180;\n\n\n\n\n\n\t\tprivate constructor() {}\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.util {\n\n\texport class Str {\n\n\t\t/**\n\t\t *  h:mm:ss \n\t\t * @param {number} hours \n\t\t * @param {number} minutes \n\t\t * @param {number} seconds \n\t\t * @returns {string} h:mm:ss \n\t\t */\n\t\tpublic static toTimeString(hours:number = 0, minutes:number = 0, seconds:number = 0):string {\n\t\t\tseconds += minutes * 60 + hours * 3600;\n\t\t\tlet h:string = Math.floor(seconds / 3600).toString();\n\t\t\tlet m:string = Math.floor((seconds / 60) % 60).toString();\n\t\t\tlet s:string = ('0' + Math.floor(seconds % 60)).substr(-2, 2);\n\t\t\tif (h != '0') {\n\t\t\t\treturn h + ':' + ('0' + m).substr(-2, 2) + ':' + s;\n\t\t\t} else {\n\t\t\t\treturn m + ':' + s;\n\t\t\t}\n\t\t}\n\n\t\tprivate constructor() {}\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.util {\n\n\texport class Cmd {\n\n\t\tpublic static stop(command:cmd.Command):any {\n\t\t\tif (command) command.interrupt();\n\t\t\treturn null;\n\t\t}\n\n\t\tpublic static sequence(execute:boolean, ...commands:(cmd.Command|Function)[]):cmd.Serial {\n\t\t\tconst c:cmd.Serial = new cmd.Serial();\n\t\t\tc.addCommand(...commands);\n\t\t\tif (execute) c.execute();\n\t\t\treturn c;\n\t\t}\n\n\t\tpublic static single(execute:boolean, command:cmd.Command):cmd.Command {\n\t\t\tif (execute && command) command.execute();\n\t\t\treturn command;\n\t\t}\n\n\t\tprivate constructor() {}\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.util {\n\n\timport Easing = alm.math.Easing;\n\n\texport class Dom {\n\n\t\tpublic static instantiate(templateId:string, removeId:boolean = true, verbose:boolean = true):HTMLElement {\n\t\t\tconst template = document.getElementById(templateId);\n\t\t\tif (template) {\n\t\t\t\tconst element = <HTMLElement>template.cloneNode(true);\n\t\t\t\tif (removeId) {\n\t\t\t\t\telement.removeAttribute('id');\n\t\t\t\t}\n\t\t\t\treturn element;\n\t\t\t} else {\n\t\t\t\tif (verbose) {\n\t\t\t\t\tconsole.warn('[Dom.instantiate] template (id = ' + templateId + ' ) is not found.');\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\n\n\n\n\t\tpublic static addPointerDownListener(target:HTMLElement | Window, listener:(event:PointerEvent) => void, options:AddEventListenerOptions = null):void {\n\t\t\ttarget.addEventListener('pointerdown', listener, options);\n\t\t}\n\n\t\tpublic static addPointerMoveListener(target:HTMLElement | Window, listener:(event:PointerEvent) => void, options:AddEventListenerOptions = null):void {\n\t\t\ttarget.addEventListener('pointermove', listener, options);\n\t\t}\n\n\t\tpublic static addPointerUpListener(target:HTMLElement | Window, listener:(event:PointerEvent) => void, options:AddEventListenerOptions = null):void {\n\t\t\ttarget.addEventListener('pointerup', listener, options);\n\t\t}\n\n\t\tpublic static addPointerEnterListener(target:HTMLElement | Window, listener:(event:PointerEvent) => void, options:AddEventListenerOptions = null):void {\n\t\t\ttarget.addEventListener('pointerenter', listener, options);\n\t\t}\n\n\t\tpublic static addPointerLeaveListener(target:HTMLElement | Window, listener:(event:PointerEvent) => void, options:AddEventListenerOptions = null):void {\n\t\t\ttarget.addEventListener('pointerleave', listener, options);\n\t\t}\n\n\t\tpublic static addPointerOverListener(target:HTMLElement | Window, listener:(event:PointerEvent) => void, options:AddEventListenerOptions = null):void {\n\t\t\ttarget.addEventListener('pointerover', listener, options);\n\t\t}\n\n\t\tpublic static addPointerOutListener(target:HTMLElement | Window, listener:(event:PointerEvent) => void, options:AddEventListenerOptions = null):void {\n\t\t\ttarget.addEventListener('pointerout', listener, options);\n\t\t}\n\n\t\tpublic static removePointerDownListener(target:HTMLElement | Window, listener:(event:PointerEvent) => void, options:EventListenerOptions = null):void {\n\t\t\ttarget.removeEventListener('pointerdown', listener, options);\n\t\t}\n\n\t\tpublic static removePointerMoveListener(target:HTMLElement | Window, listener:(event:PointerEvent) => void, options:EventListenerOptions = null):void {\n\t\t\ttarget.removeEventListener('pointermove', listener, options);\n\t\t}\n\n\t\tpublic static removePointerUpListener(target:HTMLElement | Window, listener:(event:PointerEvent) => void, options:EventListenerOptions = null):void {\n\t\t\ttarget.removeEventListener('pointerup', listener, options);\n\t\t}\n\n\t\tpublic static removePointerEnterListener(target:HTMLElement | Window, listener:(event:PointerEvent) => void, options:EventListenerOptions = null):void {\n\t\t\ttarget.removeEventListener('pointerenter', listener, options);\n\t\t}\n\n\t\tpublic static removePointerLeaveListener(target:HTMLElement | Window, listener:(event:PointerEvent) => void, options:EventListenerOptions = null):void {\n\t\t\ttarget.removeEventListener('pointerleave', listener, options);\n\t\t}\n\n\t\tpublic static removePointerOverListener(target:HTMLElement | Window, listener:(event:PointerEvent) => void, options:EventListenerOptions = null):void {\n\t\t\ttarget.removeEventListener('pointerover', listener, options);\n\t\t}\n\n\t\tpublic static removePointerOutListener(target:HTMLElement | Window, listener:(event:PointerEvent) => void, options:EventListenerOptions = null):void {\n\t\t\ttarget.removeEventListener('pointerout', listener, options);\n\t\t}\n\n\n\n\n\n\t\tpublic static addRootClass(value:string):void {\n\t\t\tif (Dom.root === null) {\n\t\t\t\tDom.root = document.documentElement;\n\t\t\t}\n\t\t\tDom.root.classList.add(value);\n\t\t}\n\n\t\tpublic static removeRootClass(value:string):void {\n\t\t\tif (Dom.root === null) {\n\t\t\t\tDom.root = document.documentElement;\n\t\t\t}\n\t\t\tDom.root.classList.remove(value);\n\t\t}\n\n\t\tpublic static addRootAttribute(key:string, value:string):void {\n\t\t\tif (Dom.root === null) {\n\t\t\t\tDom.root = document.documentElement;\n\t\t\t}\n\t\t\tDom.root.setAttribute(key, value);\n\t\t}\n\n\t\tpublic static removeRootAttribute(key:string, value:string):void {\n\t\t\tif (Dom.root === null) {\n\t\t\t\tDom.root = document.documentElement;\n\t\t\t}\n\t\t\tDom.root.removeAttribute(key);\n\t\t}\n\n\n\n\n\n\t\tpublic static getRootCss(property:string):string {\n\t\t\tif (Dom.root === null) {\n\t\t\t\tDom.root = document.documentElement;\n\t\t\t}\n\t\t\treturn Dom.root.style.getPropertyValue(property);\n\t\t}\n\n\t\tpublic static setRootCss(property:string, value:string):void {\n\t\t\tif (Dom.root === null) {\n\t\t\t\tDom.root = document.documentElement;\n\t\t\t}\n\t\t\tDom.root.style.setProperty(property, value);\n\t\t}\n\n\n\n\n\n\t\tpublic static scrollTo(scrollTop:number, useTransition:boolean = true):void {\n\t\t\tDom.scrollTween = Cmd.stop(Dom.scrollTween);\n\t\t\tif (useTransition) {\n\t\t\t\tDom.scrollTween = new cmd.Tween(Dom, {scrollPosition:scrollTop}, null, 1000, Easing.easeOutQuart, null, ():void => {\n\t\t\t\t\tDom.applyScrollPosition();\n\t\t\t\t});\n\t\t\t\tDom.scrollTween.execute();\n\t\t\t} else {\n\t\t\t\tDom.scrollPosition = scrollTop;\n\t\t\t\tDom.applyScrollPosition();\n\t\t\t}\n\t\t}\n\n\t\tprivate static applyScrollPosition():void {\n\t\t\twindow.scroll(0, Dom.scrollPosition);\n\t\t}\n\n\n\n\n\n\t\tpublic static setupSmoothAnchorLink():void {\n\t\t\tconst tags = document.getElementsByTagName('a');\n\t\t\tconst tagCount = tags.length;\n\t\t\tfor (let i = 0; i < tagCount; ++i) {\n\t\t\t\tDom.setAnchorLinkAction(tags.item(i));\n\t\t\t}\n\t\t}\n\n\t\tprivate static setAnchorLinkAction(tag:HTMLElement):void {\n\t\t\tconst href = tag.getAttribute('href');\n\t\t\tif ((href.indexOf('#')) == 0 && !tag.hasAttribute('data-smooth-anchor-target')) {\n\t\t\t\ttag.setAttribute('data-smooth-anchor-target', href.slice(1));\n\t\t\t\ttag.setAttribute('href', 'javascript:void(0)');\n\t\t\t\ttag.addEventListener('click', Dom.anchorLinkClickHandler);\n\t\t\t}\n\t\t}\n\n\t\tprivate static anchorLinkClickHandler = (event:MouseEvent):void => {\n\t\t\tconst tag = <HTMLElement>event.currentTarget;\n\n\t\t\tconst targetId = tag.getAttribute('data-smooth-anchor-target');\n\t\t\tconst target = document.getElementById(targetId);\n\t\t\tlet targetScrollPosition = window.pageYOffset + target.getBoundingClientRect().top;\n\n\t\t\tif (tag.hasAttribute('data-smooth-anchor-offset')) {\n\t\t\t\ttargetScrollPosition += parseFloat(tag.getAttribute('data-smooth-anchor-offset'));\n\t\t\t}\n\n\t\t\tDom.scrollTo(targetScrollPosition);\n\t\t};\n\n\n\n\n\n\t\tpublic static getViewportRect(element:Element):{ x:number, y:number, width:number, height:number } {\n\t\t\tconst rect = element.getBoundingClientRect();\n\t\t\treturn { x: rect.left, y: rect.top, width: rect.width, height: rect.height };\n\t\t}\n\n\t\tpublic static geDocumentRect(element:Element):{ x:number, y:number, width:number, height:number } {\n\t\t\tconst rect = Dom.getViewportRect(element);\n\t\t\treturn { x: rect.x + window.scrollX, y: rect.y + window.scrollY, width: rect.width, height: rect.height };\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprivate static root:HTMLElement = null;\n\t\tprivate static scrollTween:cmd.Tween = null;\n\t\tprivate static scrollPosition:number;\n\n\n\n\n\n\t\tprivate constructor() {\n\t\t}\n\t}\n}\n","/// <reference path=\"../../index.ts\" />\n\nnamespace alm.util {\n\n\texport class Cvs {\n\n\t\tpublic static getHighDpiContext2d(canvas:HTMLCanvasElement):CanvasRenderingContext2D {\n\t\t\tconst dpr = Math.round(window.devicePixelRatio) || 1;\n\t\t\tconst rect = canvas.getBoundingClientRect();\n\n\t\t\tcanvas.width = rect.width * dpr;\n\t\t\tcanvas.height = rect.height * dpr;\n\n\t\t\tconst context = canvas.getContext('2d');\n\t\t\tcontext.scale(dpr, dpr);\n\n\t\t\treturn context;\n\t\t}\n\n\n\n\n\n\t\tprivate constructor() {}\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.util {\n\n\timport Dom = alm.util.Dom;\n\timport Cmd = alm.util.Cmd;\n\timport EasingFunction = alm.math.EasingFunction;\n\timport Easing = alm.math.Easing;\n\n\texport class CssVar {\n\n\t\tpublic static readonly numberPattern:RegExp = new RegExp(/([+-]?\\d*\\.?\\d*)(.*)/);\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(property:string, defaultValue:number = null, suffix:string = null) {\n\t\t\tthis.reset(property, defaultValue, suffix);\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic reset(property:string, value:number = null, suffix:string = null):void {\n\t\t\tthis.property = property;\n\t\t\tthis.value = value;\n\t\t\tthis.suffix = suffix;\n\n\t\t\tthis.cancelAnimation();\n\n\t\t\tif ((this.value === null) || (this.suffix === null)) {\n\t\t\t\tconst result = CssVar.numberPattern.exec(Dom.getRootCss(this.property));\n\t\t\t\tlet isNeedApply = false;\n\n\t\t\t\tif (this.value === null) {\n\t\t\t\t\tthis.value = parseFloat(result[1]);\n\t\t\t\t\tif (isNaN(this.value)) {\n\t\t\t\t\t\tthis.value = 0;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tisNeedApply = true;\n\t\t\t\t}\n\n\t\t\t\tif (this.value === null) {\n\t\t\t\t\tthis.suffix = result[2] !== '' ? result[2] : '';\n\t\t\t\t} else {\n\t\t\t\t\tisNeedApply = true;\n\t\t\t\t}\n\n\t\t\t\tif (isNeedApply) {\n\t\t\t\t\tthis.apply();\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\tthis.apply();\n\t\t\t}\n\t\t}\n\n\t\tpublic getProperty():string {\n\t\t\treturn this.property;\n\t\t}\n\n\t\tpublic setProperty(property:string):void {\n\t\t\tthis.cancelAnimation();\n\t\t\tif (this.property !== property) {\n\t\t\t\tthis.property = property;\n\t\t\t\tthis.apply();\n\t\t\t}\n\t\t}\n\n\t\tpublic getValue():number {\n\t\t\treturn this.value;\n\t\t}\n\n\t\tpublic setValue(value:number):void {\n\t\t\tthis.cancelAnimation();\n\t\t\tif (this.value !== value) {\n\t\t\t\tthis.value = value;\n\t\t\t\tthis.apply();\n\t\t\t}\n\t\t}\n\n\t\tpublic getSuffix():string {\n\t\t\treturn this.suffix;\n\t\t}\n\n\t\tpublic setSuffix(suffix:string):void {\n\t\t\tthis.cancelAnimation();\n\t\t\tif (this.suffix !== suffix) {\n\t\t\t\tthis.suffix = suffix;\n\t\t\t\tthis.apply();\n\t\t\t}\n\t\t}\n\n\t\tpublic animate(to:number, from:number, duration:number = 1000, easing:EasingFunction = Easing.linear, execute:boolean = true):cmd.Tween {\n\t\t\tthis.cancelAnimation();\n\t\t\tthis.tween = new cmd.Tween(this, { value: to }, from !== null ? { value: from } : null, duration, easing, null, ():void => {\n\t\t\t\tthis.apply();\n\t\t\t}, ():void => {\n\t\t\t\tthis.tween = null;\n\t\t\t});\n\t\t\tif (execute) {\n\t\t\t\tthis.tween.execute();\n\t\t\t}\n\t\t\treturn this.tween;\n\t\t}\n\n\t\tpublic cancelAnimation():void {\n\t\t\tif (this.tween) {\n\t\t\t\tthis.tween = Cmd.stop(this.tween);\n\t\t\t}\n\t\t}\n\n\t\tpublic animateTo(to:number, duration:number = 1000, easing:EasingFunction = Easing.linear, execute:boolean = true):cmd.Tween {\n\t\t\treturn this.animate(to, null, duration, easing, execute);\n\t\t}\n\n\t\tpublic apply():void {\n\t\t\tDom.setRootCss(this.property, this.value + this.suffix);\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprivate property:string;\n\t\tprivate value:number;\n\t\tprivate suffix:string;\n\t\tprivate tween:cmd.Tween;\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.util {\n\n\texport class Sensor {\n\n\t\tpublic static wakeUpDeviceMotion():Promise<void> {\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tconsole.debug('[DeviceMotion] check');\n\t\t\t\tif (DeviceMotionEvent) {\n\t\t\t\t\tif (typeof DeviceMotionEvent['requestPermission'] === 'function') {\n\t\t\t\t\t\tconsole.debug('[DeviceMotion] iOS');\n\t\t\t\t\t\tDeviceMotionEvent['requestPermission']()\n\t\t\t\t\t\t\t.then(permissionState => {\n\t\t\t\t\t\t\t\tif (permissionState === 'granted') {\n\t\t\t\t\t\t\t\t\tconsole.debug('[DeviceMotion] allowed on iOS');\n\t\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tconsole.debug('[DeviceMotion] not allowed, state :', permissionState);\n\t\t\t\t\t\t\t\t\treject();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.catch((error) => {\n\t\t\t\t\t\t\t\tconsole.error('[DeviceMotion] error', error);\n\t\t\t\t\t\t\t\treject();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.debug('[DeviceMotion] allowed on PC / Android');\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconsole.debug('[DeviceMotion] not available');\n\t\t\t\t\treject();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tpublic static wakeUpDeviceOrientation():Promise<void> {\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tconsole.debug('[DeviceOrientation] check');\n\t\t\t\tif (DeviceOrientationEvent) {\n\t\t\t\t\tif (typeof DeviceOrientationEvent['requestPermission'] === 'function') {\n\t\t\t\t\t\tconsole.debug('[checkDeviceOrientation] iOS');\n\t\t\t\t\t\tDeviceOrientationEvent['requestPermission']()\n\t\t\t\t\t\t\t.then(permissionState => {\n\t\t\t\t\t\t\t\tif (permissionState === 'granted') {\n\t\t\t\t\t\t\t\t\tconsole.debug('[DeviceOrientation] allowed on iOS');\n\t\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tconsole.debug('[DeviceOrientation] not allowed, state :', permissionState);\n\t\t\t\t\t\t\t\t\treject();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.catch((error) => {\n\t\t\t\t\t\t\t\tconsole.error('[DeviceOrientation] error', error);\n\t\t\t\t\t\t\t\treject();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.debug('[DeviceOrientation] allowed on PC / Android');\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconsole.debug('[DeviceOrientation] not available');\n\t\t\t\t\treject();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\n\n\n\n\t\tprivate constructor() {\n\t\t}\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.resource {\n\n\texport class ObjectPool<T> {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\t/**\n\t\t * ObjectPool class.\n\t\t * @class\n\t\t * @param {function} onRequireItem This callback function is called when new item is required.\n\t\t * @param {function} onDestroyItem This callback function is called when item is disposed.\n\t\t * @param {number} initCount Init item count.\n\t\t * @param {number} growthCount Growth item count.\n\t\t *\n\t\t * @property {number} initCount Init item count.\n\t\t * @property {number} growthCount Growth item count.\n\t\t * @property {function} onRequireItem This callback function is called when new item is required.\n\t\t * @property {function} onDestroyItem This callback function is called when item is disposed.\n\t\t * @property {Array} items Array of items.\n\t\t * @property {number} index Current index of items.\n\t\t *\n\t\t * @return void\n\t\t */\n\t\tconstructor(onRequireItem:() => T, onDestroyItem:(item:T) => void, initCount:number = 100, growthCount:number = 50) {\n\t\t\tthis.onRequireItem = onRequireItem;\n\t\t\tthis.onDestroyItem = onDestroyItem;\n\t\t\tthis.growthCount = growthCount;\n\t\t\tthis.items = new Array(initCount);\n\t\t\tfor (let i = 0; i < initCount; ++i) {\n\t\t\t\tthis.items[i] = this.onRequireItem();\n\t\t\t}\n\t\t\tthis.index = initCount;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\t/**\n\t\t * Get item from object pool.\n\t\t * @return {T} Item\n\t\t */\n\t\tpublic getItem():T {\n\t\t\tif (this.index > 0) {\n\t\t\t\treturn this.items[--this.index];\n\t\t\t}\n\t\t\tfor (let i = 0; i < this.growthCount; ++i) {\n\t\t\t\tthis.items.unshift(this.onRequireItem());\n\t\t\t}\n\t\t\tthis.index = this.growthCount;\n\t\t\treturn this.getItem();\n\t\t}\n\n\t\t/**\n\t\t * Return item to object pool.\n\t\t * @param {T} Item.\n\t\t * @return void\n\t\t */\n\t\tpublic returnItem(item:T):void {\n\t\t\tthis.items[this.index++] = item;\n\t\t}\n\n\t\t/**\n\t\t * Optimize object pool size.\n\t\t * @return void\n\t\t */\n\t\tpublic reduce():void {\n\t\t\tconst n = this.index;\n\t\t\tfor (let i = 0; i < n; ++i) {\n\t\t\t\tthis.onDestroyItem(this.items.shift());\n\t\t\t}\n\t\t\tthis.index = 0;\n\t\t}\n\n\t\t/**\n\t\t * Destroy object pool.\n\t\t * @return void\n\t\t */\n\t\tpublic destroy():void {\n\t\t\tconst n = this.items.length;\n\t\t\tfor (let i = 0; i < n; ++i) {\n\t\t\t\tthis.onDestroyItem(this.items[i]);\n\t\t\t}\n\t\t\tthis.index = 0;\n\t\t\tthis.items = null;\n\t\t\tthis.onRequireItem = null;\n\t\t\tthis.onDestroyItem = null;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprivate items:T[];\n\t\tprivate index:number;\n\t\tprivate growthCount:number;\n\n\t\tpublic onRequireItem:() => T;\n\t\tpublic onDestroyItem:(item:T) => void;\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.state {\n\n\texport class Lottery<T = any> {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(values:T[] = null) {\n\t\t\tif (values) {\n\t\t\t\tthis.set(values);\n\t\t\t} else {\n\t\t\t\tthis.initValues = this.restValues = null;\n\t\t\t\tthis.restCount = this.restValues.length;\n\t\t\t\tthis.isEmpty = true;\n\t\t\t}\n\t\t\tthis.onCheck = null;\n\t\t\tthis.isAutoResetEnabled = false;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic set(values:T[]):void {\n\t\t\tthis.initValues = values.concat();\n\t\t\tthis.reset();\n\t\t}\n\n\t\tpublic get():T {\n\t\t\tif (this.isEmpty && this.isAutoResetEnabled) {\n\t\t\t\tthis.reset();\n\t\t\t}\n\t\t\tconst index:number = Math.floor(Math.random() * this.restCount);\n\t\t\tconst value:T = this.restValues[index];\n\t\t\tlet result:boolean = true;\n\t\t\tif (this.onCheck) result = this.onCheck(value);\n\t\t\tif (result) {\n\t\t\t\tthis.restValues.splice(index, 1);\n\t\t\t\tthis.restCount = this.restValues.length;\n\t\t\t\tthis.isEmpty = this.restCount == 0;\n\t\t\t}\n\t\t\treturn value;\n\t\t}\n\n\t\tpublic add(value:T, reset:boolean = false):void {\n\t\t\tthis.initValues.push(value);\n\t\t\tthis.restValues.push(value);\n\t\t\tthis.restCount = this.restValues.length;\n\t\t\tthis.isEmpty = this.restCount == 0;\n\t\t\tif (reset) {\n\t\t\t\tthis.reset();\n\t\t\t}\n\t\t}\n\n\t\tpublic reset():void {\n\t\t\tthis.restValues = this.initValues.concat();\n\t\t\tthis.restCount = this.restValues.length;\n\t\t\tthis.isEmpty = this.restCount == 0;\n\t\t}\n\n\t\tpublic getRestCount():number {\n\t\t\treturn this.restCount;\n\t\t}\n\n\t\tpublic getIsEmply():boolean {\n\t\t\treturn this.isEmpty;\n\t\t}\n\n\t\tpublic getIsAutoResetEnabled():boolean {\n\t\t\treturn this.isAutoResetEnabled;\n\t\t}\n\n\t\tpublic setIsAutoResetEnabled(enabled:boolean):void {\n\t\t\tthis.isAutoResetEnabled = enabled;\n\t\t}\n\n\t\tpublic static createIndices(count:number):Lottery<number> {\n\t\t\tconst values:number[] = new Array(count);\n\t\t\tfor (let i:number = 0; i < count; ++i) values[i] = i;\n\t\t\treturn new Lottery<number>(values);\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic onCheck:(value:T) => boolean;\n\n\t\tprivate isAutoResetEnabled:boolean;\n\t\tprivate isEmpty:boolean;\n\t\tprivate restCount:number;\n\t\tprivate restValues:T[];\n\t\tprivate initValues:T[];\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.state {\n\n\timport Hash = alm.util.Hash;\n\n\texport class Switcher<T = string> extends alm.event.EventDispatcher {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor() {\n\t\t\tsuper();\n\n\t\t\tthis.isLoopEnabled = true;\n\n\t\t\tthis.itemCount = 0;\n\t\t\tthis.itemIds = null;\n\t\t\tthis.itemIndexById = null;\n\n\t\t\tthis.onChange = null;\n\t\t\tthis.onPrev = null;\n\t\t\tthis.onNext = null;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic setupById(ids:T[]):void {\n\t\t\tthis.itemCount = ids.length;\n\t\t\tthis.itemIds = ids;\n\n\t\t\tthis.itemIndexById = {};\n\t\t\tfor (let i:number = 0; i < this.itemCount; ++i) {\n\t\t\t\tthis.itemIndexById[this.itemIds[i] as unknown as string] = i;\n\t\t\t}\n\n\t\t\tthis.setup();\n\t\t}\n\n\t\tpublic setupByCount(itemCount:number):void {\n\t\t\tthis.itemCount = itemCount;\n\n\t\t\tthis.itemIds = null;\n\t\t\tthis.itemIndexById = null;\n\n\t\t\tthis.setup();\n\t\t}\n\n\t\tprivate setup():void {\n\t\t\tthis.currentItemIndex = -1;\n\t\t\tthis.currentItemId = null;\n\n\t\t\tthis.oldItemIndex = -1;\n\t\t\tthis.oldItemId = null;\n\t\t}\n\n\t\tpublic gotoByIndex(itemIndex:number, useTransition:boolean = true):boolean {\n\t\t\tif (itemIndex < 0 || itemIndex >= this.itemCount) itemIndex = -1;\n\t\t\tif (itemIndex == this.currentItemIndex) return false;\n\n\t\t\tthis.oldItemIndex = this.currentItemIndex;\n\t\t\tthis.currentItemIndex = itemIndex;\n\n\t\t\tif (this.itemIds) {\n\t\t\t\tthis.oldItemId = this.oldItemIndex != -1 ? this.itemIds[this.oldItemIndex] : null;\n\t\t\t\tthis.currentItemId = this.currentItemIndex != -1 ? this.itemIds[this.currentItemIndex] : null;\n\t\t\t}\n\n\t\t\tthis.dispatchPagerEvent(SwitcherEvent.change, this.onChange, useTransition);\n\n\t\t\treturn true;\n\t\t}\n\n\t\tpublic gotoById(itemId:string, useTransition:boolean = true):boolean {\n\t\t\tconst itemIndex:number = this.itemIndexById.hasOwnProperty(itemId) ? this.itemIndexById[itemId] : -1;\n\t\t\treturn this.gotoByIndex(itemIndex, useTransition);\n\t\t}\n\n\t\tpublic prev(useTransition:boolean = true):boolean {\n\t\t\tlet itemIndex = this.getPrevItemIndex();\n\n\t\t\tconst result:boolean = this.gotoByIndex(itemIndex, useTransition);\n\t\t\tif (result) {\n\t\t\t\tthis.dispatchPagerEvent(SwitcherEvent.prev, this.onPrev, useTransition);\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}\n\n\t\tpublic next(useTransition:boolean = true):boolean {\n\t\t\tlet itemIndex = this.getNextItemIndex();\n\n\t\t\tconst result:boolean = this.gotoByIndex(itemIndex, useTransition);\n\t\t\tif (result) {\n\t\t\t\tthis.dispatchPagerEvent(SwitcherEvent.next, this.onNext, useTransition);\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}\n\n\t\tpublic getPrevItemIndex():number {\n\t\t\tlet itemIndex = this.currentItemIndex - 1;\n\t\t\tif (this.isLoopEnabled && itemIndex < 0) itemIndex = this.itemCount - 1;\n\t\t\treturn itemIndex;\n\t\t}\n\n\t\tpublic getPrevItemId():T {\n\t\t\treturn this.itemIds[this.getPrevItemIndex()];\n\t\t}\n\n\t\tpublic getNextItemIndex():number {\n\t\t\tlet itemIndex = this.currentItemIndex + 1;\n\t\t\tif (this.isLoopEnabled && itemIndex >= this.itemCount) itemIndex = 0;\n\t\t\treturn itemIndex;\n\t\t}\n\n\t\tpublic getNextItemId():T {\n\t\t\treturn this.itemIds[this.getNextItemIndex()];\n\t\t}\n\n\t\tprivate dispatchPagerEvent(eventType:string, callback:(event:SwitcherEvent<T>) => void, useTransition:boolean):void {\n\t\t\tconst event:SwitcherEvent<T> = new SwitcherEvent<T>(eventType, this, this.currentItemIndex, this.oldItemIndex, this.currentItemId, this.oldItemId, useTransition);\n\t\t\tif (callback) {\n\t\t\t\tcallback(event);\n\t\t\t}\n\t\t\tthis.dispatchEvent(event);\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic getIsLoopEnabled():boolean { return this.isLoopEnabled; }\n\t\tpublic setIsLoopEnabled(value:boolean):void { this.isLoopEnabled = value; }\n\t\tprivate isLoopEnabled:boolean;\n\n\t\tpublic getItemCount():number { return this.itemCount; }\n\t\tprivate itemCount:number;\n\n\t\tpublic getCurrentItemIndex():number { return this.currentItemIndex; }\n\t\tprivate currentItemIndex:number;\n\n\t\tpublic getOldItemIndex():number { return this.oldItemIndex; }\n\t\tprivate oldItemIndex:number;\n\n\t\tpublic getCurrentItemId():T { return this.currentItemId; }\n\t\tprivate currentItemId:T;\n\n\t\tpublic getOldItemId():T { return this.oldItemId; }\n\t\tprivate oldItemId:T;\n\n\t\tpublic getItemIds():T[] { return this.itemIds; }\n\t\tprivate itemIds:T[];\n\n\t\tprivate itemIndexById:Hash<number>;\n\n\t\tpublic onChange:(event:SwitcherEvent<T>) => void;\n\t\tpublic onPrev:(event:SwitcherEvent<T>) => void;\n\t\tpublic onNext:(event:SwitcherEvent<T>) => void;\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.state {\n\n\texport class SwitcherEvent<T = string> extends alm.event.Event<Switcher<T>> {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// EVENT\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic static readonly change:string = 'SwitcherEvent.change';\n\t\tpublic static readonly prev:string = 'SwitcherEvent.prev';\n\t\tpublic static readonly next:string = 'SwitcherEvent.next';\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(eventType:string, eventTarget:Switcher<T>, currentItemIndex:number, oldItemIndex:number, currentItemId:T, oldItemId:T, useTransition:boolean) {\n\t\t\tsuper(eventType, eventTarget);\n\t\t\tthis.currentItemIndex = currentItemIndex;\n\t\t\tthis.oldItemIndex = oldItemIndex;\n\t\t\tthis.currentItemId = currentItemId;\n\t\t\tthis.oldItemId = oldItemId;\n\t\t\tthis.useTransition = useTransition;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic clone():SwitcherEvent<T> {\n\t\t\treturn new SwitcherEvent<T>(this.type, this.target, this.currentItemIndex, this.oldItemIndex, this.currentItemId, this.oldItemId, this.useTransition);\n\t\t}\n\n\t\tpublic toString():string {\n\t\t\treturn '[SwitcherEvent] type = ' + this.type + ', ' + this.oldItemIndex + ' -> ' + this.currentItemIndex + ', transition = ' + this.useTransition;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic readonly currentItemIndex:number;\n\t\tpublic readonly oldItemIndex:number;\n\t\tpublic readonly currentItemId:T;\n\t\tpublic readonly oldItemId:T;\n\t\tpublic readonly useTransition:boolean;\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.state {\n\n\timport EventDispatcher = alm.event.EventDispatcher;\n\n\texport class LoHi extends EventDispatcher {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(lowThreshold:number, highThreshold:number, initValue:number = 0) {\n\t\t\tsuper();\n\n\t\t\tthis.lowThreshold = lowThreshold;\n\t\t\tthis.highThreshold = highThreshold;\n\t\t\tthis.isHigh = false;\n\t\t\tthis._set(initValue, false);\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\t/**\n\t\t * \n\t\t * @param {number} value \n\t\t * @returns {boolean} true\n\t\t */\n\t\tpublic set(value:number):boolean {\n\t\t\treturn this._set(value, true);\n\t\t}\n\n\t\tpublic getIsHigh():boolean {\n\t\t\treturn this.isHigh;\n\t\t}\n\n\t\tpublic getValue():number {\n\t\t\treturn this.value;\n\t\t}\n\n\t\tpublic getLowThreshold():number {\n\t\t\treturn this.lowThreshold;\n\t\t}\n\n\t\tpublic getHighThreshold():number {\n\t\t\treturn this.highThreshold;\n\t\t}\n\n\t\tpublic setLowThreshold(threshold:number):void {\n\t\t\tthis.lowThreshold = threshold;\n\t\t\tthis._set(this.value, true);\n\t\t}\n\n\t\tpublic setHighThreshold(threshold:number):void {\n\t\t\tthis.highThreshold = threshold;\n\t\t\tthis._set(this.value, true);\n\t\t}\n\n\t\tprivate _set(value:number, dispatchEvent:boolean):boolean {\n\t\t\tthis.value = value;\n\t\t\tif (this.isHigh && this.value < this.lowThreshold) {\n\t\t\t\tthis.isHigh = false;\n\t\t\t\tif (dispatchEvent) {\n\t\t\t\t\tthis.dispatchEvent(new LoHiEvent(LoHiEvent.low, this, this.isHigh));\n\t\t\t\t\tthis.dispatchEvent(new LoHiEvent(LoHiEvent.change, this, this.isHigh));\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t} else if (!this.isHigh && this.value > this.highThreshold) {\n\t\t\t\tthis.isHigh = true;\n\t\t\t\tif (dispatchEvent) {\n\t\t\t\t\tthis.dispatchEvent(new LoHiEvent(LoHiEvent.high, this, this.isHigh));\n\t\t\t\t\tthis.dispatchEvent(new LoHiEvent(LoHiEvent.change, this, this.isHigh));\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprivate lowThreshold:number;\n\t\tprivate highThreshold:number;\n\t\tprivate value:number;\n\t\tprivate isHigh:boolean;\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.state {\n\n\texport class LoHiEvent extends alm.event.Event<LoHi> {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// EVENT\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic static readonly change:string = 'LoHiEvent.change';\n\t\tpublic static readonly low:string = 'LoHiEvent.low';\n\t\tpublic static readonly high:string = 'LoHiEvent.high';\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(eventType:string, eventTarget:LoHi, isHigh:boolean) {\n\t\t\tsuper(eventType, eventTarget);\n\t\t\tthis.isHigh = isHigh;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic clone():LoHiEvent {\n\t\t\treturn new LoHiEvent(this.type, this.target, this.isHigh);\n\t\t}\n\n\t\tpublic toString():string {\n\t\t\treturn '[LoHiEvent] type = ' + this.type + ', isHigh = ' + this.isHigh;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic readonly isHigh:boolean;\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.math {\n\n\texport class EasingValue {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(initValue:number, easing:number = 0.1, tolerance:number = 0) {\n\t\t\tthis.value = this.target = initValue;\n\t\t\tthis.easing = easing;\n\t\t\tthis.tolerance = tolerance;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic update(useTransition:boolean = true):number {\n\t\t\tif (useTransition) {\n\t\t\t\tconst d:number = this.target - this.value;\n\t\t\t\tif (this.tolerance > 0 && Math.abs(d) <= this.tolerance) {\n\t\t\t\t\tthis.value = this.target;\n\t\t\t\t} else {\n\t\t\t\t\tthis.value += d * this.easing;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.value = this.target;\n\t\t\t}\n\n\t\t\treturn this.value;\n\t\t}\n\n\t\tpublic clone():EasingValue {\n\t\t\tconst v:EasingValue = new EasingValue(this.value, this.easing, this.tolerance);\n\t\t\tv.target = this.target;\n\t\t\treturn v;\n\t\t}\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic value:number;\n\t\tpublic target:number;\n\t\tpublic easing:number;\n\t\tpublic tolerance:number;\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.math {\n\n\texport class SpringValue {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(initValue:number, spring:number = 0.1, friction:number = 0.9) {\n\t\t\tthis.acceleration = 0;\n\t\t\tthis.velocity = 0;\n\t\t\tthis.value = this.target = initValue;\n\t\t\tthis.spring = spring;\n\t\t\tthis.friction = friction;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic update(useTransition:boolean = true):number {\n\t\t\tif (useTransition) {\n\t\t\t\tthis.acceleration = (this.target - this.value) * this.spring;\n\t\t\t\tthis.velocity += this.acceleration;\n\t\t\t\tthis.velocity *= this.friction;\n\t\t\t\tthis.value += this.velocity;\n\t\t\t} else {\n\t\t\t\tthis.acceleration = 0;\n\t\t\t\tthis.velocity = 0;\n\t\t\t\tthis.value = this.target;\n\t\t\t}\n\n\t\t\treturn this.value;\n\t\t}\n\n\t\tpublic clone():SpringValue {\n\t\t\tconst v:SpringValue = new SpringValue(this.value, this.spring, this.friction);\n\t\t\tv.acceleration = this.acceleration;\n\t\t\tv.velocity = this.velocity;\n\t\t\tv.target = this.target;\n\t\t\treturn v;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic value:number;\n\t\tpublic target:number;\n\t\tpublic velocity:number;\n\t\tpublic acceleration:number;\n\t\tpublic spring:number;\n\t\tpublic friction:number;\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.math {\n\n\t/**\n\t * \n\t */\n\texport class MinMax {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor() {\n\t\t\tthis.min = this._min = Number.MAX_VALUE;\n\t\t\tthis.max = this._max = -Number.MAX_VALUE;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic add(n:number):void {\n\t\t\tif (n < this._min) {\n\t\t\t\tthis._min = n;\n\t\t\t}\n\t\t\tif (n > this._max) {\n\t\t\t\tthis._max = n;\n\t\t\t}\n\t\t\tthis.min = this._min;\n\t\t\tthis.max = this._max;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic min:number;\n\t\tpublic max:number;\n\n\t\tprivate _min:number;\n\t\tprivate _max:number;\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.math {\n\n\texport class SimpleAverage {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor() {\n\t\t\tthis.reset();\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic add(n:number):number {\n\t\t\tthis._value = (this._value * this._count + n) / ++this._count;\n\n\t\t\tthis.value = this._value;\n\t\t\tthis.count = this._count;\n\n\t\t\treturn this._value;\n\t\t}\n\n\t\tpublic reset():void {\n\t\t\tthis.value = this._value = 0;\n\t\t\tthis.count = this._count = 0;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic value:number;\n\t\tpublic count:number;\n\n\t\tprivate _value:number;\n\t\tprivate _count:number;\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.math {\n\n\texport class SimpleMovingAverage {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(maxCount:number) {\n\t\t\tthis.maxCount = this._maxCount = maxCount;\n\t\t\tthis.reset();\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic add(n:number):number {\n\t\t\tif (++this._count > this._maxCount) {\n\t\t\t\tthis._count = this._maxCount;\n\n\t\t\t\tconst oldest:number = this.values.shift();\n\t\t\t\tthis._value -= oldest;\n\n\t\t\t\tconst latest:number = n / this._maxCount;\n\t\t\t\tthis._value += latest;\n\n\t\t\t\tthis.values.push(latest);\n\n\t\t\t} else {\n\t\t\t\tthis._value *= (this._count - 1);\n\t\t\t\tthis._value += n;\n\t\t\t\tthis._value /= this._count;\n\n\t\t\t\tthis.values.push(n / this._maxCount);\n\t\t\t}\n\n\t\t\t/*\n\t\t\tthis._values.push(n);\n\n\t\t\tif (++this._count > this._maxCount) {\n\t\t\t\tthis._values.shift();\n\t\t\t\tthis._count = this._maxCount;\n\t\t\t}\n\n\t\t\tthis._value = 0;\n\t\t\tfor (let i:number = 0; i < this._count; ++i) {\n\t\t\t\tthis._value += this._values[i];\n\t\t\t}\n\t\t\tthis._value /= this._count;\n\t\t\t*/\n\n\t\t\tthis.value = this._value;\n\t\t\tthis.count = this._count;\n\n\t\t\treturn this._value;\n\t\t}\n\n\t\tpublic reset():void {\n\t\t\tthis.value = this._value = 0;\n\t\t\tthis.count = this._count = 0;\n\t\t\tthis.values = [];\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic value:number;\n\t\tpublic maxCount:number;\n\t\tpublic count:number;\n\n\t\tprivate _value:number;\n\t\tprivate _maxCount:number;\n\t\tprivate _count:number;\n\n\t\tprivate values:number[];\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.math {\n\n\t/**\n\t * N\n\t */\n\texport class MaxValue {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(maxLatestCount:number = 0) {\n\t\t\tthis.maxLatestCount = this._maxLatestCount = maxLatestCount;\n\t\t\tthis.value = this._value = -Number.MAX_VALUE;\n\t\t\tthis.count = this._count = 0;\n\t\t\tthis.values = [];\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic add(n:number):number {\n\t\t\tif (this._maxLatestCount > 0) {\n\t\t\t\tif (++this._count > this._maxLatestCount) {\n\t\t\t\t\tthis._count = this._maxLatestCount;\n\n\t\t\t\t\tthis.values.push(n);\n\t\t\t\t\tconst oldest:number = this.values.shift();\n\t\t\t\t\tif (this._value > oldest) {\n\t\t\t\t\t\tif (this._value < n) {\n\t\t\t\t\t\t\tthis._value = n;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._value = -Number.MAX_VALUE;\n\t\t\t\t\t\tfor (let i:number = 0; i < this._count; ++i) {\n\t\t\t\t\t\t\tconst v:number = this.values[i];\n\t\t\t\t\t\t\tif (this._value < v) {\n\t\t\t\t\t\t\t\tthis._value = v;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\t\t\t\t\tthis.values.push(n);\n\t\t\t\t\tif (this._value < n) {\n\t\t\t\t\t\tthis._value = n;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t++this._count;\n\t\t\t\tif (this._value < n) {\n\t\t\t\t\tthis._value = n;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.value = this._value;\n\t\t\tthis.count = this._count;\n\n\t\t\treturn this._value;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic value:number;\n\t\tpublic maxLatestCount:number;\n\t\tpublic count:number;\n\n\t\tprivate _value:number;\n\t\tprivate _maxLatestCount:number;\n\t\tprivate _count:number;\n\n\t\tprivate values:number[];\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.math {\n\n\texport class Circular {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(angle:number = 0, velocity:number = 0, radian:boolean = true) {\n\t\t\tthis.setAngle(angle, radian);\n\t\t\tthis.setVelocity(velocity, radian);\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic getAngle(radian:boolean = true):number {\n\t\t\treturn radian ? this.angle : (this.angle * 180 / Math.PI);\n\t\t}\n\n\t\tpublic setAngle(angle:number, radian:boolean = true):void {\n\t\t\tthis.angle = radian ? angle : (angle * Math.PI / 180);\n\t\t}\n\n\t\tpublic getVelocity(radian:boolean = true):number {\n\t\t\treturn radian ? this.velocity : (this.velocity * 180 / Math.PI);\n\t\t}\n\n\t\tpublic setVelocity(velocity:number, radian:boolean = true):void {\n\t\t\tthis.velocity = radian ? velocity : (velocity * Math.PI / 180);\n\t\t}\n\n\t\tpublic update():void {\n\t\t\tthis.angle += this.velocity;\n\t\t}\n\n\t\tpublic getSin(length:number = 1):number {\n\t\t\treturn length * Math.sin(this.angle);\n\t\t}\n\n\t\tpublic getCos(length:number = 1):number {\n\t\t\treturn length * Math.cos(this.angle);\n\t\t}\n\n\t\tpublic getTan(length:number = 1):number {\n\t\t\treturn length * Math.tan(this.angle);\n\t\t}\n\n\t\tpublic getMagnitude(length:number = 1):number {\n\t\t\treturn length * (1 + Math.sin(this.angle)) / 2;\n\t\t}\n\n\t\tpublic getVector(length:number = 1, xy:{ x:number, y:number } = null):{ x:number, y:number } {\n\t\t\tif (xy != null) {\n\t\t\t\txy.x = this.getCos(length);\n\t\t\t\txy.y = this.getSin(length);\n\t\t\t} else {\n\t\t\t\treturn { x: this.getCos(length), y: this.getSin(length) };\n\t\t\t}\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprivate angle:number;\n\t\tprivate velocity:number;\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.math {\n\n\texport class BinarySearch {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(list:number[] = null) {\n\t\t\tthis.setList(list);\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic setList(list:number[]):void {\n\t\t\tthis.list = list;\n\t\t}\n\n\t\tpublic searchNearest(value:number):number {\n\t\t\tlet lowIndex = 0;\n\t\t\tlet highIndex = this.list.length - 1;\n\t\t\tlet midIndex;\n\t\t\tlet estimated;\n\t\t\twhile (lowIndex <= highIndex) {\n\t\t\t\tmidIndex = Math.floor((lowIndex + highIndex) / 2);\n\t\t\t\testimated = this.list[midIndex];\n\t\t\t\tif (estimated == value) {\n\t\t\t\t\treturn midIndex;\n\t\t\t\t} else if (estimated > value) {\n\t\t\t\t\thighIndex = midIndex - 1;\n\t\t\t\t} else {\n\t\t\t\t\tlowIndex = midIndex + 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn midIndex;\n\t\t}\n\n\t\tpublic leapNearest(value:number):{ index0:number, index1:number, ratio:number } {\n\t\t\tconst nearestIndex = this.searchNearest(value);\n\t\t\tconst nearestValue = this.list[nearestIndex];\n\n\t\t\tlet lowIndex;\n\t\t\tlet lowValue;\n\t\t\tlet highIndex;\n\t\t\tlet highValue;\n\t\t\tif (nearestValue <= value) {\n\t\t\t\tlowIndex = nearestIndex;\n\t\t\t\tlowValue = nearestValue;\n\t\t\t\thighIndex = nearestIndex + 1;\n\t\t\t\tif (highIndex >= this.list.length) {\n\t\t\t\t\thighIndex = this.list.length - 1;\n\t\t\t\t}\n\t\t\t\thighValue = this.list[highIndex];\n\t\t\t} else {\n\t\t\t\tlowIndex = nearestIndex - 1;\n\t\t\t\tif (lowIndex < 0) {\n\t\t\t\t\tlowIndex = 0;\n\t\t\t\t}\n\t\t\t\tlowValue = this.list[lowIndex];\n\t\t\t\thighIndex = nearestIndex;\n\t\t\t\thighValue = nearestValue;\n\t\t\t}\n\n\t\t\tconst d = highValue - lowValue;\n\t\t\tif (d > 0) {\n\t\t\t\treturn { index0: lowIndex, index1: highIndex, ratio: (value - lowValue) / (highValue - lowValue) };\n\t\t\t} else {\n\t\t\t\treturn { index0: lowIndex, index1: highIndex, ratio: 0 };\n\t\t\t}\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprivate list:number[];\n\t}\n}\n","/// <reference path='../../index.ts' />\n\n// https://magicant.github.io/sjavascript/mt.html\n// mt.js 0.2.4 (2005-12-23)\n\n/*\nMersenne Twister in JavaScript based on \"mt19937ar.c\"\n\n * JavaScript version by Magicant: Copyright (C) 2005 Magicant\n\n\n * Original C version by Makoto Matsumoto and Takuji Nishimura\n   http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/mt.html\n\nCopyright (C) 1997 - 2002, Makoto Matsumoto and Takuji Nishimura,\nAll rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions\nare met:\n\n  1. Redistributions of source code must retain the above copyright\n     notice, this list of conditions and the following disclaimer.\n\n  2. Redistributions in binary form must reproduce the above copyright\n     notice, this list of conditions and the following disclaimer in the\n     documentation and/or other materials provided with the distribution.\n\n  3. The names of its contributors may not be used to endorse or promote\n     products derived from this software without specific prior written\n     permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n\"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\nLIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\nA PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR\nCONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,\nEXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,\nPROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\nPROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF\nLIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\nNEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n\n// Methods whose name starts with \"_\" are private methods.\n// Don't call them externally!\n\nnamespace alm.math {\n\n\texport class MersenneTwister {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\t/**\n\t\t * Constructor: MersenneTwister([integer/Array<integer> seed])\n\t\t * initializes the object with the given seed.\n\t\t * The seed may be an integer or an array of integers.\n\t\t * If the seed is not given, the object will be initialized with the current\n\t\t * time: new Date().getTime().\n\t\t * See also: setSeed(seed).\n\t\t */\n\t\tconstructor(seed:number) {\n\t\t\tif (arguments.length == 0) {\n\t\t\t\tseed = new Date().getTime();\n\t\t\t}\n\n\t\t\tthis._mt = new Array(624);\n\t\t\tthis.setSeed(seed);\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\t/** multiplies two uint32 values and returns a uint32 result. */\n\t\tprivate static _mulUint32(a:number, b:number):number {\n\t\t\tconst a1 = a >>> 16, a2 = a & 0xffff;\n\t\t\tconst b1 = b >>> 16, b2 = b & 0xffff;\n\t\t\treturn (((a1 * b2 + a2 * b1) << 16) + a2 * b2) >>> 0;\n\t\t};\n\n\t\t/** returns ceil(value) if value is finite number, otherwise 0. */\n\t\tprivate static _toNumber(x:any):number {\n\t\t\treturn (typeof x == 'number' && !isNaN(x)) ? Math.ceil(x) : 0;\n\t\t};\n\n\t\t/**\n\t\t * Method: setSeed(integer/Array<integer> seed)\n\t\t * resets the seed. The seed may be an integer or an array of integers.\n\t\t * Elements in the seed array that are not numbers will be treated as 0.\n\t\t * Numbers that are not integers will be rounded down.\n\t\t * The integer(s) should be greater than or equal to 0 and less than 2^32.\n\t\t * This method is compatible with init_genrand and init_by_array function of\n\t\t * the original C version.\n\t\t */\n\t\tpublic setSeed(seed:number|number[]) {\n\t\t\tconst mt = this._mt;\n\t\t\tif (typeof seed == 'number') {\n\t\t\t\tmt[0] = seed >>> 0;\n\t\t\t\tfor (let i = 1; i < mt.length; i++) {\n\t\t\t\t\tconst x = mt[i-1] ^ (mt[i-1] >>> 30);\n\t\t\t\t\tmt[i] = MersenneTwister._mulUint32(1812433253, x) + i;\n\t\t\t\t}\n\t\t\t\tthis._index = mt.length;\n\t\t\t} else if (seed instanceof Array) {\n\t\t\t\tlet i = 1, j = 0;\n\t\t\t\tthis.setSeed(19650218);\n\t\t\t\tfor (let k = Math.max(mt.length, seed.length); k > 0; k--) {\n\t\t\t\t\tlet x = mt[i-1] ^ (mt[i-1] >>> 30);\n\t\t\t\t\tx = MersenneTwister._mulUint32(x, 1664525);\n\t\t\t\t\tmt[i] = (mt[i] ^ x) + (seed[j] >>> 0) + j;\n\t\t\t\t\tif (++i >= mt.length) {\n\t\t\t\t\t\tmt[0] = mt[mt.length-1];\n\t\t\t\t\t\ti = 1;\n\t\t\t\t\t}\n\t\t\t\t\tif (++j >= seed.length) {\n\t\t\t\t\t\tj = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (let k = mt.length - 1; k > 0; k--) {\n\t\t\t\t\tlet x = mt[i-1] ^ (mt[i-1] >>> 30);\n\t\t\t\t\tx = MersenneTwister._mulUint32(x, 1566083941);\n\t\t\t\t\tmt[i] = (mt[i] ^ x) - i;\n\t\t\t\t\tif (++i >= mt.length) {\n\t\t\t\t\t\tmt[0] = mt[mt.length-1];\n\t\t\t\t\t\ti = 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tmt[0] = 0x80000000;\n\t\t\t} else {\n\t\t\t\tthrow new TypeError('MersenneTwister: illegal seed.');\n\t\t\t}\n\t\t};\n\n\t\t/** returns the next random Uint32 value. */\n\t\tprivate _nextInt():number {\n\t\t\tconst mt = this._mt;\n\t\t\tlet value:number;\n\n\t\t\tif (this._index >= mt.length) {\n\t\t\t\tlet k = 0;\n\t\t\t\tconst N = mt.length, M = 397;\n\t\t\t\tdo {\n\t\t\t\t\tvalue = (mt[k] & 0x80000000) | (mt[k+1] & 0x7fffffff);\n\t\t\t\t\tmt[k] = mt[k+M] ^ (value >>> 1) ^ ((value & 1) ? 0x9908b0df : 0);\n\t\t\t\t} while (++k < N-M);\n\t\t\t\tdo {\n\t\t\t\t\tvalue = (mt[k] & 0x80000000) | (mt[k+1] & 0x7fffffff);\n\t\t\t\t\tmt[k] = mt[k+M-N] ^ (value >>> 1) ^ ((value & 1) ? 0x9908b0df : 0);\n\t\t\t\t} while (++k < N-1);\n\t\t\t\tvalue = (mt[N-1] & 0x80000000) | (mt[0] & 0x7fffffff);\n\t\t\t\tmt[N-1] = mt[M-1] ^ (value >>> 1) ^ ((value & 1) ? 0x9908b0df : 0);\n\t\t\t\tthis._index = 0;\n\t\t\t}\n\n\t\t\tvalue = mt[this._index++];\n\t\t\tvalue ^=  value >>> 11;\n\t\t\tvalue ^= (value <<   7) & 0x9d2c5680;\n\t\t\tvalue ^= (value <<  15) & 0xefc60000;\n\t\t\tvalue ^=  value >>> 18;\n\t\t\treturn value >>> 0;\n\t\t};\n\n\t\t/**\n\t\t * Method: nextInt([[number min,] number max])\n\t\t * returns a random integer that is greater than or equal to min and less than\n\t\t * max. The value of (max - min) must be positive number less or equal to 2^32.\n\t\t * If min is not given or not a number, this method uses 0 for min.\n\t\t * If neither of min and max is given or max is out of range, this method\n\t\t * uses 2^32 for max.\n\t\t * This method is compatible with genrand_int32 function of the original C\n\t\t * version for min=0 & max=2^32, but not with genrand_int31 function.\n\t\t */\n\t\tpublic getInt():number {\n\t\t\tlet min:number, sup:number;\n\t\t\tswitch (arguments.length) {\n\t\t\t\tcase 0:\n\t\t\t\t\treturn this._nextInt();\n\t\t\t\tcase 1:\n\t\t\t\t\tmin = 0;\n\t\t\t\t\tsup = MersenneTwister._toNumber(arguments[0]);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tmin = MersenneTwister._toNumber(arguments[0]);\n\t\t\t\t\tsup = MersenneTwister._toNumber(arguments[1]) - min;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (!(0 < sup && sup < 0x100000000))\n\t\t\t\treturn this._nextInt() + min;\n\t\t\tif ((sup & (~sup + 1)) == sup)\n\t\t\t\treturn ((sup - 1) & this._nextInt()) + min;\n\n\t\t\tlet value:number;\n\t\t\tdo {\n\t\t\t\tvalue = this._nextInt();\n\t\t\t} while (sup > 4294967296 - (value - (value %= sup)));\n\t\t\treturn value + min;\n\t\t};\n\n\t\t/**\n\t\t * Method: next()\n\t\t * returns a random number that is greater than or equal to 0 and less than 1.\n\t\t * This method is compatible with genrand_res53 function of the original C\n\t\t * version.\n\t\t */\n\t\tpublic getFloat():number {\n\t\t\tconst a = this._nextInt() >>> 5, b = this._nextInt() >>> 6;\n\t\t\treturn (a * 0x4000000 + b) / 0x20000000000000;\n\t\t};\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprivate _mt:number[];\n\t\tprivate _index:number;\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.time {\n\n\timport EventDispatcher = alm.event.EventDispatcher;\n\timport Time = alm.util.Time;\n\timport EventListener = alm.event.EventListener;\n\n\texport class AnimationFrameTicker extends EventDispatcher {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\t/**\n\t\t * requestAnimationFrameFPS\n\t\t * @param {number} frameRate 0\n\t\t * @param {number} tolerance frameRate\n\t\t */\n\t\tconstructor(frameRate:number = 0, tolerance:number = 0.1) {\n\t\t\tsuper();\n\n\t\t\tthis.targetFrameRate = frameRate;\n\t\t\tthis.interval = 1000 / this.targetFrameRate;\n\n\t\t\tthis.tolerance = tolerance;\n\t\t\tthis.toleranceDuration = this.interval * this.tolerance;\n\n\t\t\tthis.isRunning = false;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic start():void {\n\t\t\tif (this.isRunning) return;\n\t\t\tthis.isRunning = true;\n\n\t\t\tthis.frameStartTime = Time.now();\n\t\t\tthis.requestId = window.requestAnimationFrame(this.updateHandler);\n\t\t}\n\n\t\tpublic stop():void {\n\t\t\tif (!this.isRunning) return;\n\t\t\tthis.isRunning = false;\n\n\t\t\twindow.cancelAnimationFrame(this.requestId);\n\t\t}\n\n\t\tpublic getIsRunning():boolean {\n\t\t\treturn this.isRunning;\n\t\t}\n\n\t\tpublic getTargetFrameRate():number {\n\t\t\treturn this.targetFrameRate;\n\t\t}\n\n\t\tpublic getInterval():number {\n\t\t\treturn this.interval;\n\t\t}\n\n\t\tpublic getTolerance():number {\n\t\t\treturn this.tolerance;\n\t\t}\n\n\t\tpublic getToleranceDuration():number {\n\t\t\treturn this.toleranceDuration;\n\t\t}\n\n\t\tprivate updateHandler = ():void => {\n\t\t\tthis.requestId = window.requestAnimationFrame(this.updateHandler);\n\t\t\tif (this.targetFrameRate > 0) {\n\t\t\t\tconst currentTime:number = Time.now();\n\t\t\t\tconst elapsedTime:number = currentTime - this.frameStartTime;\n\t\t\t\tif (elapsedTime >= this.interval - this.toleranceDuration) {\n\t\t\t\t\t//trace('[AnimationFrameTicker] frameRate : ' + (1000 / elapsedTime));\n\t\t\t\t\tthis.frameStartTime = currentTime;\n\t\t\t\t\tthis.dispatchEvent(new AnimationFrameTickerEvent(AnimationFrameTickerEvent.tick, this));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.dispatchEvent(new AnimationFrameTickerEvent(AnimationFrameTickerEvent.tick, this));\n\t\t\t}\n\t\t};\n\n\n\n\n\n\t\tpublic static addEventListener(listener:alm.event.EventListener):void {\n\t\t\tconst result = AnimationFrameTicker.ticker.addEventListener(AnimationFrameTickerEvent.tick, listener);\n\t\t\tif (result) {\n\t\t\t\t++AnimationFrameTicker.listenerCount;\n\t\t\t\tif (AnimationFrameTicker.listenerCount === 1) {\n\t\t\t\t\tAnimationFrameTicker.ticker.start();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tpublic static removeEventListener(listener:EventListener):void {\n\t\t\tconst result = AnimationFrameTicker.ticker.removeEventListener(AnimationFrameTickerEvent.tick, listener);\n\t\t\tif (result) {\n\t\t\t\t--AnimationFrameTicker.listenerCount;\n\t\t\t\tif (AnimationFrameTicker.listenerCount === 0) {\n\t\t\t\t\tAnimationFrameTicker.ticker.stop();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprivate isRunning:boolean;\n\t\tprivate requestId:number;\n\t\tprivate targetFrameRate:number;\n\t\tprivate interval:number;\n\t\tprivate tolerance:number;\n\t\tprivate toleranceDuration:number;\n\t\tprivate frameStartTime:number;\n\n\t\tprivate static ticker = new AnimationFrameTicker();\n\t\tprivate static listenerCount = 0;\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.time {\n\n\timport Event = alm.event.Event;\n\n\texport class AnimationFrameTickerEvent extends Event<AnimationFrameTicker> {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// EVENT\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic static readonly tick:string = 'AnimationFrameTickerEvent.tick';\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(eventType:string, eventTarget:AnimationFrameTicker) {\n\t\t\tsuper(eventType, eventTarget);\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic clone():AnimationFrameTickerEvent {\n\t\t\treturn new AnimationFrameTickerEvent(this.type, this.target);\n\t\t}\n\n\t\tpublic toString():string {\n\t\t\treturn '[AnimationFrameTickerEvent] type = ' + this.type;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.time {\n\n\timport EventDispatcher = alm.event.EventDispatcher;\n\timport Time = alm.util.Time;\n\n\texport class Timer extends EventDispatcher {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(interval:number = 1000, repeatCount:number = 0) {\n\t\t\tsuper();\n\t\t\tthis.interval = interval;\n\t\t\tthis.repeatCount = repeatCount;\n\t\t\tthis.isRunning = false;\n\t\t\tthis.tId = -1;\n\t\t\tthis.reset();\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic start():void {\n\t\t\tif (this.isRunning) return;\n\t\t\tthis.isRunning = true;\n\t\t\tthis.tStartTime = Time.now();\n\t\t\tthis.startInterval(this.tRestTime != -1 ? this.tRestTime : this.interval);\n\t\t}\n\n\t\tpublic stop():void {\n\t\t\tif (!this.isRunning) return;\n\t\t\tthis.isRunning = false;\n\t\t\tthis.tRestTime = Time.now() - this.tStartTime;\n\t\t\tthis.stopInterval();\n\t\t}\n\n\t\tpublic reset():void {\n\t\t\tthis.stop();\n\t\t\tthis.elapsedCount = 0;\n\t\t\tthis.tRestTime = -1;\n\t\t}\n\n\t\tpublic restart():void {\n\t\t\tthis.reset();\n\t\t\tthis.start();\n\t\t}\n\n\n\n\n\n\t\tprivate startInterval(interval:number):void {\n\t\t\tthis.stopInterval();\n\t\t\tthis.tInterval = interval;\n\t\t\tthis.tId = window.setInterval(this.timerHandler, this.tInterval);\n\t\t}\n\n\t\tprivate stopInterval():void {\n\t\t\tif (this.tId != -1) {\n\t\t\t\tclearInterval(this.tId);\n\t\t\t\tthis.tId = -1;\n\t\t\t}\n\t\t}\n\n\t\tprivate dispatch(eventType:string):void {\n\t\t\tthis.dispatchEvent(new TimerEvent(eventType, this, this.elapsedCount, this.repeatCount, this.getRestCount()));\n\t\t}\n\n\t\tprivate timerHandler = ():void => {\n\t\t\tthis.tStartTime = Time.now();\n\t\t\t++this.elapsedCount;\n\t\t\tlet isCompleted:boolean = false;\n\t\t\tif (this.repeatCount > 0 && this.elapsedCount >= this.repeatCount) {\n\t\t\t\tisCompleted = true;\n\t\t\t\tthis.stop();\n\t\t\t} else if (this.tInterval != this.interval) {\n\t\t\t\tthis.startInterval(this.interval);\n\t\t\t}\n\t\t\tthis.dispatch(TimerEvent.tick);\n\t\t\tif (isCompleted) {\n\t\t\t\tthis.dispatch(TimerEvent.complete);\n\t\t\t}\n\t\t};\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic getIsRunning():boolean { return this.isRunning; }\n\t\tprivate isRunning:boolean;\n\n\t\tpublic getInterval():number { return this.interval; }\n\t\tpublic setInterval(interval:number):void { this.interval = interval; }\n\t\tprivate interval:number;\n\n\t\tpublic getElapsedTime():number { return Time.now() - this.tStartTime; }\n\n\t\tpublic getRestTime():number { return this.interval - this.getElapsedTime(); }\n\n\t\tpublic getElapsedCount():number { return this.elapsedCount; }\n\t\tprivate elapsedCount:number;\n\n\t\tpublic getRepeatCount():number { return this.repeatCount; }\n\t\tpublic setRepeatCount(count:number):void { this.repeatCount = count; }\n\t\tprivate repeatCount:number;\n\n\t\tpublic getRestCount():number { return this.repeatCount - this.elapsedCount; }\n\n\t\tprivate tStartTime:number;\n\t\tprivate tRestTime:number;\n\t\tprivate tInterval:number;\n\t\tprivate tId:number;\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.time {\n\n\timport Event = alm.event.Event;\n\n\texport class TimerEvent extends Event<Timer> {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// EVENT\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic static readonly tick:string = 'TimerEvent.tick';\n\t\tpublic static readonly complete:string = 'TimerEvent.complete';\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(eventType:string, eventTarget:Timer, elapsedCount:number = 0, repeatCount:number = 0, restCount:number = 0) {\n\t\t\tsuper(eventType, eventTarget);\n\t\t\tthis.elapsedCount = elapsedCount;\n\t\t\tthis.repeatCount = repeatCount;\n\t\t\tthis.restCount = restCount;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic clone():TimerEvent {\n\t\t\treturn new TimerEvent(this.type, this.target, this.elapsedCount, this.repeatCount, this.restCount);\n\t\t}\n\n\t\tpublic toString():string {\n\t\t\treturn '[TimerEvent] type = ' + this.type + ', elapsedCount = ' + this.elapsedCount + ', repeatCount=' + this.repeatCount + ', restCount=' + this.restCount;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic readonly elapsedCount:number;\n\t\tpublic readonly repeatCount:number;\n\t\tpublic readonly restCount:number;\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.io {\n\n\timport EventDispatcher = alm.event.EventDispatcher;\n\texport type CompleteFunction = (content:any, info?:any) => void;\n\texport type ErrorFunction = (info?:any) => void;\n\n\texport class FileLoader extends EventDispatcher {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(totalThreadCount:number = 3) {\n\t\t\tsuper();\n\n\t\t\tthis.isLoading_ = false;\n\n\t\t\tthis.currentCount = 0;\n\t\t\tthis.totalCount = 0;\n\n\t\t\tthis.currentThreadCount = 0;\n\t\t\tthis.totalThreadCount = totalThreadCount;\n\n\t\t\tthis.loadingQueries = [];\n\t\t\tthis.loadingQueryIndex = -1;\n\n\t\t\tthis.queriesByQueryId = {};\n\t\t\tthis.queriesByUrl = {};\n\n\t\t\tthis.handlersByType = {};\n\n\t\t\ttrace('[FileLoader] totalThreadCount : ' + this.totalThreadCount);\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic require(url:string, type:string, id:string = ''):string {\n\t\t\treturn this.addQuery(type, url, {}, id);\n\t\t}\n\n\t\tprivate addQuery(type:string, url:string, param:any, id:string = ''):string {\n\t\t\tif (this.queriesByUrl[url]) return this.queriesByUrl[url].id;\n\n\t\t\tconst query:FileQuery = new FileQuery();\n\t\t\tquery.type = type;\n\t\t\tquery.url = url;\n\t\t\tquery.param = param;\n\n\t\t\tif (id != '') {\n\t\t\t\tquery.id = id;\n\t\t\t} else {\n\t\t\t\tquery.id = String(FileLoader.id);\n\t\t\t\t++FileLoader.id;\n\t\t\t}\n\n\t\t\tthis.loadingQueries.push(query);\n\t\t\tthis.queriesByQueryId[query.id] = query;\n\t\t\tthis.queriesByUrl[query.url] = query;\n\t\t\treturn query.id;\n\t\t}\n\n\t\tpublic load():void {\n\t\t\tif (this.isLoading_) return;\n\t\t\tthis.isLoading_ = true;\n\t\t\tthis.loadingQueryIndex = -1;\n\t\t\tthis.next();\n\t\t}\n\n\t\tprivate next():void {\n\t\t\tthis.currentCount = this.loadingQueryIndex + 1;\n\t\t\tthis.totalCount = this.loadingQueries.length;\n\n\t\t\tconst progress = this.currentCount / this.totalCount;\n\t\t\tif (this.currentCount == 0) {\n\t\t\t\tthis.dispatchEvent(new FileLoaderProgressEvent(FileLoaderProgressEvent.start, this, progress, this.currentCount, this.totalCount));\n\t\t\t} else {\n\t\t\t\tthis.dispatchEvent(new FileLoaderProgressEvent(FileLoaderProgressEvent.progress, this, progress, this.currentCount, this.totalCount));\n\t\t\t}\n\n\t\t\twhile (this.currentThreadCount < this.totalThreadCount) {\n\t\t\t\tif (this.loadingQueryIndex + 1 < this.totalCount) {\n\t\t\t\t\t// add thread\n\t\t\t\t\t++this.currentThreadCount;\n\n\t\t\t\t\t++this.loadingQueryIndex;\n\t\t\t\t\tconst query:FileQuery = this.loadingQueries[this.loadingQueryIndex];\n\t\t\t\t\tquery.isLoading = true;\n\t\t\t\t\tquery.isLoadComplete = false;\n\t\t\t\t\ttrace('[FileLoader] loading... ' + '\\'' + query.url + '\\' as \\'' + query.type + '\\'');\n\n\t\t\t\t\tconst handler:IFileHandler = this.handlersByType[query.type];\n\t\t\t\t\tif (handler) {\n\t\t\t\t\t\thandler.load(query.url, (content:any, info:any = null):void => {\n\t\t\t\t\t\t\tthis.fileLoadCompleteHandler(query, content, info);\n\t\t\t\t\t\t},(info:any = null):void => {\n\t\t\t\t\t\t\tthis.fileLoadErrorHandler(query, info);\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttrace('[FileLoader] handler is not found \\'' + query.type + '\\'');\n\t\t\t\t\t\t--this.currentThreadCount;\n\t\t\t\t\t}\n\t\t\t\t\t// continue loop\n\n\t\t\t\t} else {\n\t\t\t\t\t// all finished\n\t\t\t\t\tthis.isLoading_ = false;\n\t\t\t\t\tthis.loadingQueries = [];\n\t\t\t\t\tthis.loadingQueryIndex = -1;\n\t\t\t\t\tthis.dispatchEvent(new FileLoaderProgressEvent(FileLoaderProgressEvent.complete, this, progress, this.currentCount, this.totalCount));\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/*\n\t\t\tif (this.currentCount < this.totalCount) {\n\t\t\t\t++this.loadingQueryIndex;\n\t\t\t\tconst query:FileQuery = this.loadingQueries[this.loadingQueryIndex];\n\t\t\t\tquery.isLoading = true;\n\t\t\t\tquery.isLoadComplete = false;\n\t\t\t\ttrace('[FileLoader] loading... ' + '\\'' + query.url + '\\' as \\'' + query.type + '\\'');\n\n\t\t\t\t++this.currentThreadCount;\n\n\t\t\t\tconst handler:IFileHandler = this.handlersByType[query.type];\n\t\t\t\tif (handler) {\n\t\t\t\t\thandler.load(query.url, (content:any):void => {\n\t\t\t\t\t\tthis.fileLoadCompleteHandler(query, content);\n\t\t\t\t\t},(message:string = ''):void => {\n\t\t\t\t\t\tthis.fileLoadErrorHandler(query, message);\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\ttrace('[FileLoader] handler is not found \\'' + query.type + '\\'');\n\t\t\t\t\t--this.currentThreadCount;\n\t\t\t\t\tthis.next();\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\tthis.isLoading_ = false;\n\t\t\t\tthis.loadingQueries = [];\n\t\t\t\tthis.loadingQueryIndex = -1;\n\t\t\t\tthis.dispatchEvent(new FileLoaderEvent(FileLoaderEvent.COMPLETE, this, this.currentCount / this.totalCount, this.currentCount, this.totalCount));\n\t\t\t}\n\t\t\t*/\n\t\t}\n\n\t\tpublic addHandler(handler:IFileHandler):void {\n\t\t\tthis.handlersByType[handler.getType()] = handler;\n\t\t}\n\n\t\tprivate fileLoadCompleteHandler = (query:FileQuery, content:any, info:object = null):void => {\n\t\t\t--this.currentThreadCount;\n\t\t\tquery.isLoading = false;\n\t\t\tquery.isLoadComplete = true;\n\t\t\tquery.content = content;\n\t\t\tif (query.param.onLoad) {\n\t\t\t\tquery.param.onLoad(content, info);\n\t\t\t}\n\n\t\t\tthis.dispatchEvent(new FileLoaderSuccessEvent(FileLoaderSuccessEvent.success, this, content, info));\n\t\t\tthis.next();\n\t\t};\n\n\t\tprivate fileLoadErrorHandler = (query:FileQuery, info:any = null):void => {\n\t\t\t--this.currentThreadCount;\n\t\t\tquery.isLoading = false;\n\t\t\tquery.isLoadComplete = true;\n\t\t\tif (query.param.onError) {\n\t\t\t\tquery.param.onError(info);\n\t\t\t}\n\n\t\t\tthis.dispatchEvent(new FileLoaderErrorEvent(FileLoaderErrorEvent.error, this, info));\n\t\t\tthis.next();\n\t\t};\n\n\t\tpublic getQueryByQueryId(queryId:string):FileQuery {\n\t\t\treturn this.queriesByQueryId[queryId];\n\t\t}\n\n\t\tpublic getQueryByUrl(url:string):FileQuery {\n\t\t\treturn this.queriesByUrl[url];\n\t\t}\n\n\t\tpublic isLoading():boolean {\n\t\t\treturn this.isLoading_;\n\t\t}\n\n\t\tpublic getCurrentCount():number {\n\t\t\treturn this.currentCount;\n\t\t}\n\n\t\tpublic getTotalCount():number {\n\t\t\treturn this.totalCount;\n\t\t}\n\n\t\tpublic getContentByUrl<T = any>(url:string):T {\n\t\t\treturn this.queriesByUrl[url].content;\n\t\t}\n\n\t\tpublic getContentByQueryId<T = any>(textureId:string):T {\n\t\t\treturn this.queriesByQueryId[textureId].content;\n\t\t}\n\n\t\tpublic getCurrentThreadCount():number {\n\t\t\treturn this.currentThreadCount;\n\t\t}\n\n\t\tpublic getTotalThreadCount():number {\n\t\t\treturn this.totalThreadCount;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprivate isLoading_:boolean;\n\n\t\tprivate currentCount:number;\n\t\tprivate totalCount:number;\n\n\t\tprivate currentThreadCount:number;\n\t\tprivate totalThreadCount:number;\n\n\t\tprivate loadingQueries:FileQuery[];\n\t\tprivate loadingQueryIndex:number;\n\n\t\tprivate queriesByQueryId:util.Hash<FileQuery>;\n\t\tprivate queriesByUrl:util.Hash<FileQuery>;\n\n\t\tprivate handlersByType:util.Hash<IFileHandler>;\n\n\t\tprivate static id:number = 0;\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.io {\n\n\texport class FileLoaderProgressEvent extends alm.event.Event<FileLoader> {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// EVENT\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic static readonly start:string = 'FileLoaderProgressEvent.start';\n\t\tpublic static readonly progress:string = 'FileLoaderProgressEvent.progress';\n\t\tpublic static readonly complete:string = 'FileLoaderProgressEvent.complete';\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(eventType:string, eventTarget:FileLoader, progress:number = 0, loadedCount:number = 0, totalCount:number = 0) {\n\t\t\tsuper(eventType, eventTarget);\n\t\t\tthis.progress = progress;\n\t\t\tthis.loadedCount = loadedCount;\n\t\t\tthis.totalCount = totalCount;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic clone():FileLoaderProgressEvent {\n\t\t\treturn new FileLoaderProgressEvent(this.type, this.target, this.progress, this.loadedCount, this.totalCount);\n\t\t}\n\n\t\tpublic toString():string {\n\t\t\treturn '[FileLoaderProgressEvent] type = ' + this.type + ', progress = ' + this.progress + ', loadedCount = ' + this.loadedCount + ', totalCount = ' + this.totalCount;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic readonly progress:number;\n\t\tpublic readonly loadedCount:number;\n\t\tpublic readonly totalCount:number;\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.io {\n\n\texport class FileLoaderSuccessEvent extends alm.event.Event<FileLoader> {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// EVENT\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic static readonly success:string = 'FileLoaderSuccessEvent.success';\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(eventType:string, eventTarget:FileLoader, content:any, info:any = null) {\n\t\t\tsuper(eventType, eventTarget);\n\t\t\tthis.content = content;\n\t\t\tthis.info = info;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic clone():FileLoaderSuccessEvent {\n\t\t\treturn new FileLoaderSuccessEvent(this.type, this.target, this.content, this.info);\n\t\t}\n\n\t\tpublic toString():string {\n\t\t\treturn '[FileLoaderSuccessEvent] type = ' + this.type + ', info = ' + this.info;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic readonly content:any;\n\t\tpublic readonly info:any;\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.io {\n\n\texport class FileLoaderErrorEvent extends alm.event.Event<FileLoader> {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// EVENT\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic static readonly error:string = 'FileLoaderErrorEvent.error';\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(eventType:string, eventTarget:FileLoader, info:any = null) {\n\t\t\tsuper(eventType, eventTarget);\n\t\t\tthis.info = info;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic clone():FileLoaderErrorEvent {\n\t\t\treturn new FileLoaderErrorEvent(this.type, this.target, this.info);\n\t\t}\n\n\t\tpublic toString():string {\n\t\t\treturn '[FileLoaderErrorEvent] type = ' + this.type + ', info = ' + this.info;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic readonly info:any;\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.io {\n\n\texport class FileQuery {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor() {\n\t\t\tthis.isLoading = false;\n\t\t\tthis.isLoadComplete = false;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic id:string;\n\t\tpublic type:string;\n\t\tpublic url:string;\n\t\tpublic param:any;\n\t\tpublic content:any;\n\t\tpublic isLoading:boolean;\n\t\tpublic isLoadComplete:boolean;\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.io {\n\n\timport IFileHandler = alm.io.IFileHandler;\n\timport CompleteFunction = alm.io.CompleteFunction;\n\timport ErrorFunction = alm.io.ErrorFunction;\n\n\texport class ImageFileHandler implements IFileHandler {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(crossOrigin:string = null) {\n\t\t\tthis.crossOrigin = crossOrigin;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic getType():string {\n\t\t\treturn ImageFileHandler.type;\n\t\t}\n\n\t\tpublic load(url:string, onComplete:CompleteFunction, onError:ErrorFunction):void {\n\t\t\tconst image = new Image();\n\t\t\timage.crossOrigin = this.crossOrigin;\n\t\t\timage.src = url;\n\t\t\timage.onabort = ():void => {\n\t\t\t\tonError('load abort : ' + url);\n\t\t\t};\n\t\t\timage.onerror = ():void => {\n\t\t\t\tonError('load error : ' + url);\n\t\t\t};\n\t\t\timage.onload = ():void => {\n\t\t\t\tonComplete(image);\n\t\t\t};\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprivate crossOrigin:string;\n\n\t\tpublic static readonly type:string = 'image';\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.view {\n\n\timport Event = alm.event.Event;\n\n\texport class ViewEvent extends Event<View> {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// EVENT\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic static readonly initializeBegin:string = 'ViewEvent.initializeBegin';\n\t\tpublic static readonly initializeEnd:string = 'ViewEvent.initializeEnd';\n\n\t\tpublic static readonly finalizeBegin:string = 'ViewEvent.finalizeBegin';\n\t\tpublic static readonly finalizeEnd:string = 'ViewEvent.finalizeEnd';\n\n\t\tpublic static readonly readyBegin:string = 'ViewEvent.readyBegin';\n\t\tpublic static readonly readyEnd:string = 'ViewEvent.readyEnd';\n\n\t\tpublic static readonly showBegin:string = 'ViewEvent.showBegin';\n\t\tpublic static readonly showEnd:string = 'ViewEvent.showEnd';\n\n\t\tpublic static readonly hideBegin:string = 'ViewEvent.hideBegin';\n\t\tpublic static readonly hideEnd:string = 'ViewEvent.hideEnd';\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(eventType:string, eventTarget:View) {\n\t\t\tsuper(eventType, eventTarget);\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic clone():ViewEvent {\n\t\t\treturn new ViewEvent(this.type, this.target);\n\t\t}\n\n\t\tpublic toString():string {\n\t\t\treturn '[ViewEvent] type = ' + this.type;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.view {\n\n\timport EventDispatcher = alm.event.EventDispatcher;\n\timport Logger = alm.debug.Logger;\n\n\texport abstract class View<T = any> extends EventDispatcher implements IView {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(view:T = null, id:string = null) {\n\t\t\tsuper();\n\t\t\tthis.id = id != null ? id : String(View.viewCount);\n\t\t\tthis.view = view;\n\t\t\tthis.name = '';\n\t\t\tthis.autoHideWithInit = true;\n\t\t\tthis.isInitializing = false;\n\t\t\tthis.isInitialized = false;\n\t\t\tthis.isFinalizing = false;\n\t\t\tthis.isFinalized = false;\n\t\t\tthis.isReadying = false;\n\t\t\tthis.isReadied = false;\n\t\t\tthis.isShowing = false;\n\t\t\tthis.isShown = true;\n\t\t\tthis.isHiding = false;\n\n\t\t\tif (View.viewsById[this.id]) {\n\t\t\t\tLogger.warn('view id \\'' + this.id + '\\' is duplicate');\n\t\t\t}\n\t\t\tView.viewsById[this.id] = this;\n\t\t\t++View.viewCount;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic initialize():void {\n\t\t\tif (this.isInitializing || this.isInitialized) return;\n\t\t\tthis.isInitializing = true;\n\t\t\tthis.dispatchEvent(new ViewEvent(ViewEvent.initializeBegin, this));\n\n\t\t\t//if (View.viewsById[this.id] == null) {\n\t\t\t//\tView.viewsById[this.id] = this;\n\t\t\t//}\n\n\t\t\tthis.view = this.implInitialize();\n\t\t\tif (this.isInitializing) {\n\t\t\t\tthrowError(this.name || this, 'view is not assigned', !this.view);\n\t\t\t\tif (this.autoHideWithInit) {\n\t\t\t\t\tthis.hide(false);\n\t\t\t\t}\n\t\t\t\tthis.isInitializing = false;\n\t\t\t\tthis.isInitialized = true;\n\t\t\t\tthis.dispatchEvent(new ViewEvent(ViewEvent.initializeEnd, this));\n\t\t\t} else {\n\t\t\t\t// finalized while initializing\n\t\t\t\tthis.view = null;\n\t\t\t}\n\t\t}\n\n\t\tpublic ready():void {\n\t\t\tif (this.isReadying || this.isReadied) return;\n\t\t\tthis.isReadying = true;\n\t\t\tthrowError(this.name || this, 'ready() must be called after initialize()', !this.isInitialized);\n\t\t\tthis.dispatchEvent(new ViewEvent(ViewEvent.readyBegin, this));\n\t\t\tthis.implReady();\n\t\t\tthis.isReadying = false;\n\t\t\tthis.isReadied = true;\n\t\t\tthis.dispatchEvent(new ViewEvent(ViewEvent.readyEnd, this));\n\t\t}\n\n\t\tpublic finalize():void {\n\t\t\tif (!this.isInitializing && !this.isInitialized) return;\n\t\t\tif (this.isFinalizing && this.isFinalized) return;\n\t\t\tthis.isFinalizing = true;\n\t\t\tthis.dispatchEvent(new ViewEvent(ViewEvent.finalizeBegin, this));\n\t\t\tthis.implFinalize();\n\t\t\tthis.isFinalizing = false;\n\t\t\tthis.isFinalized = true;\n\t\t\tthis.isInitializing = false;\n\t\t\tthis.isInitialized = false;\n\t\t\tthis.dispatchEvent(new ViewEvent(ViewEvent.finalizeEnd, this));\n\n\t\t\tdelete View.viewsById[this.id];\n\t\t\tView.viewsById[this.id] = null;\n\t\t}\n\n\t\tpublic show(useTransition:boolean = true):void {\n\t\t\tif (this.isShown) return;\n\t\t\tthis.getShowCommand(useTransition).execute();\n\t\t}\n\n\t\tpublic hide(useTransition:boolean = true):void {\n\t\t\tif (!this.isShown) return;\n\t\t\tthis.getHideCommand(useTransition).execute();\n\t\t}\n\n\t\tpublic getShowCommand(useTransition:boolean = true):cmd.Command {\n\t\t\tconst command:cmd.Serial = new cmd.Serial();\n\t\t\tcommand.addCommand(\n\t\t\t\tnew cmd.Func(():void => {\n\t\t\t\t\tif (this.isShown) return;\n\t\t\t\t\tthrowError(this.name || this, 'getShowCommand() is must be called after initialize()', this.isInitializing || !this.isInitialized);\n\t\t\t\t\tthrowWarn(this.name || this, 'getShowCommand() is must be called after ready()', this.isReadying|| !this.isReadied);\n\t\t\t\t\tthis.isShown = true;\n\t\t\t\t\tthis.isShowing = true;\n\t\t\t\t\tthis.isHiding = false;\n\n\t\t\t\t\tif (this.showCommand) {\n\t\t\t\t\t\tthis.showCommand.interrupt();\n\t\t\t\t\t\tthis.showCommand = null;\n\t\t\t\t\t}\n\t\t\t\t\tif (this.hideCommand) {\n\t\t\t\t\t\tthis.hideCommand.interrupt();\n\t\t\t\t\t\tthis.hideCommand = null;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.showCommand = command;\n\t\t\t\t\tthis.dispatchEvent(new ViewEvent(ViewEvent.showBegin, this));\n\n\t\t\t\t\tcommand.insertCommand(\n\t\t\t\t\t\tthis.implShow(this.view, useTransition),\n\t\t\t\t\t\tnew cmd.Func(():void => {\n\t\t\t\t\t\t\tthis.showCommand = null;\n\t\t\t\t\t\t\tthis.isShowing = false;\n\t\t\t\t\t\t\tthis.dispatchEvent(new ViewEvent(ViewEvent.showEnd, this));\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t})\n\t\t\t);\n\t\t\treturn command;\n\t\t}\n\n\t\tpublic getHideCommand(useTransition:boolean = true):cmd.Command {\n\t\t\tconst command:cmd.Serial = new cmd.Serial();\n\t\t\tcommand.addCommand(\n\t\t\t\tnew cmd.Func(():void => {\n\t\t\t\t\tif (!this.isShown) return;\n\t\t\t\t\tif (!this.isInitializing) {\n\t\t\t\t\t\tthrowError(this.name || this, 'getHideCommand() is must be called after initialize()', this.isInitializing || !this.isInitialized);\n\t\t\t\t\t\tthrowWarn(this.name || this, 'getHideCommand() is must be called after ready()', this.isReadying || !this.isReadied);\n\t\t\t\t\t}\n\t\t\t\t\tthis.isShown = false;\n\t\t\t\t\tthis.isShowing = false;\n\t\t\t\t\tthis.isHiding = true;\n\n\t\t\t\t\tif (this.showCommand) {\n\t\t\t\t\t\tthis.showCommand.interrupt();\n\t\t\t\t\t\tthis.showCommand = null;\n\t\t\t\t\t}\n\t\t\t\t\tif (this.hideCommand) {\n\t\t\t\t\t\tthis.hideCommand.interrupt();\n\t\t\t\t\t\tthis.hideCommand = null;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.hideCommand = command;\n\t\t\t\t\tthis.dispatchEvent(new ViewEvent(ViewEvent.hideBegin, this));\n\n\t\t\t\t\tcommand.insertCommand(\n\t\t\t\t\t\tthis.implHide(this.view, useTransition),\n\t\t\t\t\t\tnew cmd.Func(():void => {\n\t\t\t\t\t\t\tthis.hideCommand = null;\n\t\t\t\t\t\t\tthis.isHiding = false;\n\t\t\t\t\t\t\tthis.dispatchEvent(new ViewEvent(ViewEvent.hideEnd, this));\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t})\n\t\t\t);\n\t\t\treturn command;\n\t\t}\n\n\t\tpublic getIsInitializing():boolean {\n\t\t\treturn this.isInitializing;\n\t\t}\n\n\t\tpublic getIsInitialized():boolean {\n\t\t\treturn this.isInitialized;\n\t\t}\n\n\t\tpublic getIsReadying():boolean {\n\t\t\treturn this.isReadying;\n\t\t}\n\n\t\tpublic getIsReadied():boolean {\n\t\t\treturn this.isReadied;\n\t\t}\n\n\t\tpublic getIsShowing():boolean {\n\t\t\treturn this.isShowing;\n\t\t}\n\n\t\tpublic getIsShown():boolean {\n\t\t\treturn this.isShown;\n\t\t}\n\n\t\tpublic getIsHiding():boolean {\n\t\t\treturn this.isHiding;\n\t\t}\n\n\t\tpublic getIsHidden():boolean {\n\t\t\treturn !this.isShown;\n\t\t}\n\n\t\tpublic getIsFinalizing():boolean {\n\t\t\treturn this.isFinalizing;\n\t\t}\n\n\t\tpublic getIsFinalized():boolean {\n\t\t\treturn this.isFinalized;\n\t\t}\n\n\t\tpublic getId():string {\n\t\t\treturn this.id;\n\t\t}\n\n\t\tpublic getView():T {\n\t\t\treturn this.view;\n\t\t}\n\n\t\tpublic getName():string {\n\t\t\treturn this.name;\n\t\t}\n\n\t\tpublic setName(value:string):void {\n\t\t\tthis.name = value;\n\t\t}\n\n\t\tpublic getAutoHideWithInit():boolean {\n\t\t\treturn this.autoHideWithInit;\n\t\t}\n\n\t\tpublic setAutoHideWithInit(value:boolean):void {\n\t\t\tthis.autoHideWithInit = value;\n\t\t}\n\n\n\n\n\n\t\tprotected abstract implInitialize():T;\n\t\tprotected abstract implReady():void;\n\t\tprotected abstract implFinalize():void;\n\t\tprotected abstract implShow(view:T, useTransition:boolean):cmd.Command;\n\t\tprotected abstract implHide(view:T, useTransition:boolean):cmd.Command;\n\n\n\n\n\n\t\tpublic static getViewById(id:string):View {\n\t\t\treturn View.viewsById[id];\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprivate id:string;\n\t\tprivate view:T;\n\t\tprivate name:string;\n\t\tprivate autoHideWithInit:boolean;\n\t\tprivate showCommand:cmd.Command;\n\t\tprivate hideCommand:cmd.Command;\n\t\tprivate isInitializing:boolean;\n\t\tprivate isInitialized:boolean;\n\t\tprivate isFinalizing:boolean;\n\t\tprivate isFinalized:boolean;\n\t\tprivate isReadying:boolean;\n\t\tprivate isReadied:boolean;\n\t\tprivate isShowing:boolean;\n\t\tprivate isShown:boolean;\n\t\tprivate isHiding:boolean;\n\n\t\tprivate static viewCount:number = 0;\n\t\tprivate static viewsById:util.Hash<View> = {};\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.view {\n\n\texport class ButtonBehavior {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(target:IButton, hitArea:HTMLElement = null, isHoverCursorEnabled:boolean = true, isPreventDefaultEnabled:boolean = true, isStopPropagationEnabled:boolean = true) {\n\t\t\tthis.target = target;\n\t\t\tthis.hitArea = null;\n\t\t\tthis.isHoverCursorEnabled = isHoverCursorEnabled;\n\t\t\tthis.isPreventDefaultEnabled = isPreventDefaultEnabled;\n\t\t\tthis.isStopPropagationEnabled = isStopPropagationEnabled;\n\t\t\tthis.isEnabled = true;\n\t\t\tthis.isOver = false;\n\t\t\tthis.isDown = false;\n\t\t\tthis.isOverInternal = false;\n\t\t\tthis.isDownInternal = false;\n\t\t\tthis.defaultMouseCursor = '';\n\n\t\t\tthis.setHitArea(hitArea);\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic over(useTransition:boolean = true):void {\n\t\t\tthis.isOverInternal = true;\n\t\t\tif (this.isEnabled) {\n\t\t\t\tif (this.isOver) return;\n\t\t\t\tthis.isOver = true;\n\t\t\t\tthis.target.implButtonOver(useTransition);\n\t\t\t}\n\t\t}\n\n\t\tpublic out(useTransition:boolean = true):void {\n\t\t\tthis._out(true, useTransition);\n\t\t}\n\n\t\tprivate _out(checkEnabled:boolean, useTransition:boolean = true):void {\n\t\t\tthis.isOverInternal = false;\n\t\t\tif (this.isEnabled || !checkEnabled) {\n\t\t\t\tif (!this.isOver) return;\n\t\t\t\tthis.isOver = false;\n\t\t\t\tthis.target.implButtonOut(useTransition);\n\t\t\t}\n\t\t}\n\n\t\tpublic down(useTransition:boolean = true):void {\n\t\t\tthis.isDownInternal = true;\n\t\t\tif (this.isEnabled) {\n\t\t\t\tif (this.isDown) return;\n\t\t\t\tthis.isDown = true;\n\t\t\t\tthis.target.implButtonDown(useTransition);\n\t\t\t}\n\t\t}\n\n\t\tpublic up(useTransition:boolean = true):void {\n\t\t\tthis._up(true, useTransition);\n\t\t}\n\n\t\tprivate _up(checkEnabled:boolean, useTransition:boolean = true):void {\n\t\t\tthis.isDownInternal = false;\n\t\t\tif (this.isEnabled || !checkEnabled) {\n\t\t\t\tif (!this.isDown) return;\n\t\t\t\tthis.isDown = false;\n\t\t\t\tthis.target.implButtonUp(useTransition);\n\t\t\t}\n\t\t}\n\n\t\tpublic click(useTransition:boolean = true):void {\n\t\t\tif (this.isEnabled) {\n\t\t\t\tthis.target.implButtonClick(useTransition);\n\t\t\t}\n\t\t}\n\n\t\tprivate on():void {\n\t\t\tif (this.hitArea == null) return;\n\n\t\t\tthis.hitArea.addEventListener('mouseover', this.mouseOverHandler);\n\t\t\tthis.hitArea.addEventListener('mouseout', this.mouseOutHandler);\n\t\t\tthis.hitArea.addEventListener('mousedown', this.mouseDownHandler);\n\t\t\tthis.hitArea.addEventListener('mouseup', this.mouseUpHandler);\n\t\t\tthis.hitArea.addEventListener('click', this.clickHandler);\n\n\t\t\tthis.hitArea.addEventListener('touchstart', this.touchStartHandler);\n\t\t\tthis.hitArea.addEventListener('touchend', this.touchEndHandler);\n\t\t\tthis.hitArea.addEventListener('touchcancel', this.touchCancelHandler);\n\t\t}\n\n\t\tprivate off():void {\n\t\t\tif (this.hitArea == null) return;\n\n\t\t\tthis.hitArea.removeEventListener('mouseover', this.mouseOverHandler);\n\t\t\tthis.hitArea.removeEventListener('mouseout', this.mouseOutHandler);\n\t\t\tthis.hitArea.removeEventListener('mousedown', this.mouseDownHandler);\n\t\t\tthis.hitArea.removeEventListener('mouseup', this.mouseUpHandler);\n\t\t\tthis.hitArea.removeEventListener('click', this.clickHandler);\n\n\t\t\tthis.hitArea.removeEventListener('touchstart', this.touchStartHandler);\n\t\t\tthis.hitArea.removeEventListener('touchend', this.touchEndHandler);\n\t\t\tthis.hitArea.removeEventListener('touchcancel', this.touchCancelHandler);\n\t\t}\n\n\t\tpublic getIsEnabled():boolean {\n\t\t\treturn this.isEnabled;\n\t\t}\n\n\t\tpublic setIsEnabled(value:boolean, useTransition:boolean = true):void {\n\t\t\tif (this.isEnabled != value) {\n\t\t\t\tthis.isEnabled = value;\n\t\t\t\tif (this.isEnabled) {\n\t\t\t\t\tif (this.isOverInternal) {\n\t\t\t\t\t\tthis.over();\n\t\t\t\t\t}\n\t\t\t\t\tif (this.isDownInternal) {\n\t\t\t\t\t\tthis.down();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (this.isOver) {\n\t\t\t\t\t\tthis._out(false);\n\t\t\t\t\t\tthis.isOverInternal = true;\n\t\t\t\t\t}\n\t\t\t\t\tif (this.isDown) {\n\t\t\t\t\t\tthis._up(false);\n\t\t\t\t\t\tthis.isDownInternal = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.target.implButtonChangeEnabled(this.isEnabled, useTransition);\n\t\t\t}\n\t\t}\n\n\t\tpublic getIsOver():boolean {\n\t\t\treturn this.isOver;\n\t\t}\n\n\t\tpublic getIsDown():boolean {\n\t\t\treturn this.isDown;\n\t\t}\n\n\t\tpublic getHitArea():HTMLElement {\n\t\t\treturn this.hitArea;\n\t\t}\n\n\t\tpublic setHitArea(hitArea:HTMLElement):void {\n\t\t\tif (this.hitArea !== hitArea) {\n\t\t\t\tthis.off();\n\t\t\t\tthis.hitArea = hitArea;\n\t\t\t\tthis.on();\n\t\t\t}\n\t\t}\n\n\t\tpublic clearHitArea():void {\n\t\t\tthis.setHitArea(null);\n\t\t}\n\n\t\tpublic getIsPreventDefaultEnabled():boolean {\n\t\t\treturn this.isPreventDefaultEnabled;\n\t\t}\n\n\t\tpublic setIsPreventDefaultEnabled(enabled:boolean):void {\n\t\t\tthis.isPreventDefaultEnabled = enabled;\n\t\t}\n\n\t\tpublic getIsStopPropagationEnabled():boolean {\n\t\t\treturn this.isStopPropagationEnabled;\n\t\t}\n\n\t\tpublic setIsStopPropagationEnabled(enabled:boolean):void {\n\t\t\tthis.isStopPropagationEnabled = enabled;\n\t\t}\n\n\t\tpublic getIsHoverCursorEnabled():boolean {\n\t\t\treturn this.isHoverCursorEnabled;\n\t\t}\n\n\t\tpublic setIsHoverCursorEnabled(enabled:boolean):void {\n\t\t\tthis.isHoverCursorEnabled = enabled;\n\t\t}\n\n\t\tprivate applyMouseCursor():void {\n\t\t\tif (this.isHoverCursorEnabled) {\n\t\t\t\tif (this.isOverInternal && this.isEnabled && this.hitArea != null) {\n\t\t\t\t\tthis.defaultMouseCursor = this.hitArea.style.cursor;\n\t\t\t\t\tthis.hitArea.style.cursor = 'pointer';\n\t\t\t\t} else {\n\t\t\t\t\tthis.hitArea.style.cursor = this.defaultMouseCursor != '' ? this.defaultMouseCursor : 'auto';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// --------------------------------------------------\n\t\t// Mouse Event\n\n\t\tprivate mouseOverHandler = (event:MouseEvent):void => {\n\t\t\tif (this.isPreventDefaultEnabled) event.preventDefault();\n\t\t\tif (this.isStopPropagationEnabled) event.stopPropagation();\n\t\t\tthis.over();\n\t\t\tthis.applyMouseCursor();\n\t\t};\n\n\t\tprivate mouseOutHandler = (event:MouseEvent):void => {\n\t\t\tif (this.isPreventDefaultEnabled) event.preventDefault();\n\t\t\tif (this.isStopPropagationEnabled) event.stopPropagation();\n\t\t\tthis.out();\n\t\t\tthis.applyMouseCursor();\n\t\t};\n\n\t\tprivate mouseDownHandler = (event:MouseEvent):void => {\n\t\t\tif (this.isPreventDefaultEnabled) event.preventDefault();\n\t\t\tif (this.isStopPropagationEnabled) event.stopPropagation();\n\t\t\tthis.down();\n\t\t};\n\n\t\tprivate mouseUpHandler = (event:MouseEvent):void => {\n\t\t\tif (this.isPreventDefaultEnabled) event.preventDefault();\n\t\t\tif (this.isStopPropagationEnabled) event.stopPropagation();\n\t\t\tthis.up();\n\t\t};\n\n\t\tprivate clickHandler = (event:MouseEvent):void => {\n\t\t\tif (this.isPreventDefaultEnabled) event.preventDefault();\n\t\t\tif (this.isStopPropagationEnabled) event.stopPropagation();\n\t\t\tthis.click();\n\t\t};\n\n\t\t// --------------------------------------------------\n\t\t// Touch Event\n\n\t\tprivate touchStartHandler = (event:TouchEvent):void => {\n\t\t\tif (this.isPreventDefaultEnabled) event.preventDefault();\n\t\t\tif (this.isStopPropagationEnabled) event.stopPropagation();\n\t\t\tthis.down();\n\t\t};\n\n\t\tprivate touchEndHandler = (event:TouchEvent):void => {\n\t\t\tif (this.isPreventDefaultEnabled) event.preventDefault();\n\t\t\tif (this.isStopPropagationEnabled) event.stopPropagation();\n\t\t\tthis.up();\n\t\t\tthis.click();\n\t\t};\n\n\t\tprivate touchCancelHandler = (event:TouchEvent):void => {\n\t\t\tif (this.isPreventDefaultEnabled) event.preventDefault();\n\t\t\tif (this.isStopPropagationEnabled) event.stopPropagation();\n\t\t\tthis.up();\n\t\t};\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprivate target:IButton;\n\t\tprivate hitArea:HTMLElement;\n\t\tprivate isEnabled:boolean;\n\t\tprivate isOver:boolean;\n\t\tprivate isDown:boolean;\n\t\tprivate isOverInternal:boolean;\n\t\tprivate isDownInternal:boolean;\n\t\tprivate isPreventDefaultEnabled:boolean;\n\t\tprivate isStopPropagationEnabled:boolean;\n\t\tprivate isHoverCursorEnabled:boolean;\n\t\tprivate defaultMouseCursor:string;\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.view {\n\n\texport class SelectionBehavior {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(target:ISelection) {\n\t\t\tthis.target = target;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic select(useTransition:boolean = true):void {\n\t\t\tif (this.isSelected) return;\n\t\t\tthis.isSelected = true;\n\t\t\tthis.target.implSelectionChanged(this.isSelected, useTransition);\n\t\t}\n\n\t\tpublic deselect(useTransition:boolean = true):void {\n\t\t\tif (!this.isSelected) return;\n\t\t\tthis.isSelected = false;\n\t\t\tthis.target.implSelectionChanged(this.isSelected, useTransition);\n\t\t}\n\n\t\tpublic getIsSelected():boolean {\n\t\t\treturn this.isSelected;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprivate target:ISelection;\n\t\tprivate isSelected:boolean;\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.browser {\n\n\texport class DeviceInfo {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprivate static initialize():void {\n\t\t\tif (this.isInitialized) return;\n\t\t\tthis.isInitialized = true;\n\n\t\t\tconst u:string = window.navigator.userAgent.toLowerCase();\n\n\t\t\t// Device\n\t\t\tthis.isTablet = (u.indexOf('windows') != -1 && u.indexOf('touch') != -1)\n\t\t\t\t|| u.indexOf('ipad') != -1\n\t\t\t\t|| (u.indexOf('android') != -1 && u.indexOf('mobile') == -1)\n\t\t\t\t|| (u.indexOf('firefox') != -1 && u.indexOf('tablet') != -1)\n\t\t\t\t|| u.indexOf('kindle') != -1\n\t\t\t\t|| u.indexOf('silk') != -1\n\t\t\t\t|| u.indexOf('playbook') != -1;\n\n\t\t\tthis.isMobile = (u.indexOf('windows') != -1 && u.indexOf('phone') != -1)\n\t\t\t\t|| u.indexOf('iphone') != -1\n\t\t\t\t|| u.indexOf('ipod') != -1\n\t\t\t\t|| (u.indexOf('android') != -1 && u.indexOf('mobile') != -1)\n\t\t\t\t|| (u.indexOf('firefox') != -1 && u.indexOf('mobile') != -1)\n\t\t\t\t|| u.indexOf('blackberry') != -1;\n\n\t\t\tthis.isDesktop = !this.isTablet && !this.isMobile;\n\n\t\t\t// OS\n\t\t\tthis.isIOS = u.indexOf('ipad') != -1 || u.indexOf('iphone') != -1 || u.indexOf('ipod') != -1;\n\t\t\tthis.isAndroid = u.indexOf('android') != -1 && u.indexOf('mobile') != -1;\n\n\t\t\t// Browser\n\t\t\tif(u.indexOf('msie') != -1 || u.indexOf('trident') != -1) {\n\t\t\t\tthis.isIE = true;\n\t\t\t} else if(u.indexOf('edge') != -1) {\n\t\t\t\tthis.isEdge = true;\n\t\t\t} else if(u.indexOf('chrome') != -1) {\n\t\t\t\tthis.isChrome = true;\n\t\t\t} else if(u.indexOf('safari') != -1) {\n\t\t\t\tthis.isSafari = true;\n\t\t\t} else if(u.indexOf('firefox') != -1) {\n\t\t\t\tthis.isFireFox = true;\n\t\t\t} else if(u.indexOf('opera') != -1) {\n\t\t\t\tthis.isOpera = true;\n\t\t\t} else {\n\t\t\t\tthis.isUnknownBrowser = true;\n\t\t\t}\n\n\t\t\t// Language\n\t\t\ttry {\n\t\t\t\tconst navigator = window.navigator;\n\t\t\t\tif (this.isChrome) {\n\t\t\t\t\tthis.langFull = (navigator.languages[0] || navigator['browserLanguage'] || navigator.language || navigator['userLanguage']);\n\t\t\t\t} else {\n\t\t\t\t\tthis.langFull = (navigator['browserLanguage'] || navigator.language || navigator['userLanguage']);\n\t\t\t\t}\n\t\t\t\tthis.lang = this.langFull.substr(0, 2);\n\t\t\t} catch (exception) {\n\t\t\t\tthis.lang =  undefined;\n\t\t\t\tthis.langFull =  undefined;\n\t\t\t}\n\n\t\t\t// Capability\n\t\t\tthis.isTouchEnabled = (typeof window.ontouchstart) !== 'undefined';\n\t\t\tthis.isDownloadEnabled = !this.isIOS;\n\n\t\t\ttry {\n\t\t\t\tconst canvas:HTMLCanvasElement = document.createElement('canvas');\n\t\t\t\tconst webGlContext:WebGLRenderingContext = <WebGLRenderingContext>(canvas.getContext('webgl') || canvas.getContext('experimental-webgl'));\n\t\t\t\tthis.isWebGlEnabled = !!(window.WebGLRenderingContext && webGlContext && webGlContext.getShaderPrecisionFormat);\n\t\t\t} catch (e) {\n\t\t\t\tthis.isWebGlEnabled = false;\n\t\t\t}\n\n\t\t\t// Resolution\n\t\t\tthis.devicePixelRatio = window.devicePixelRatio;\n\t\t\tthis.isRetina = this.devicePixelRatio > 1;\n\t\t}\n\n\t\t// --------------------\n\t\t// Device\n\n\t\tpublic static getIsDesktop():boolean {\n\t\t\tthis.initialize();\n\t\t\treturn this.isDesktop;\n\t\t}\n\n\t\tpublic static getIsTablet():boolean {\n\t\t\tthis.initialize();\n\t\t\treturn this.isTablet;\n\t\t}\n\n\t\tpublic static getIsMobile():boolean {\n\t\t\tthis.initialize();\n\t\t\treturn this.isMobile;\n\t\t}\n\n\t\t// --------------------\n\t\t// OS\n\n\t\tpublic static getIsIOS():boolean {\n\t\t\tthis.initialize();\n\t\t\treturn this.isIOS;\n\t\t}\n\n\t\tpublic static getIsAndroid():boolean {\n\t\t\tthis.initialize();\n\t\t\treturn this.isAndroid;\n\t\t}\n\n\t\t// --------------------\n\t\t// Browser\n\n\t\tpublic static getIsIE():boolean {\n\t\t\tthis.initialize();\n\t\t\treturn this.isIE;\n\t\t}\n\n\t\tpublic static getIsEdge():boolean {\n\t\t\tthis.initialize();\n\t\t\treturn this.isEdge;\n\t\t}\n\n\t\tpublic static getIsChrome():boolean {\n\t\t\tthis.initialize();\n\t\t\treturn this.isChrome;\n\t\t}\n\n\t\tpublic static getIsSafari():boolean {\n\t\t\tthis.initialize();\n\t\t\treturn this.isSafari;\n\t\t}\n\n\t\tpublic static getIsFireFox():boolean {\n\t\t\tthis.initialize();\n\t\t\treturn this.isFireFox;\n\t\t}\n\n\t\tpublic static getIsOpera():boolean {\n\t\t\tthis.initialize();\n\t\t\treturn this.isOpera;\n\t\t}\n\n\t\tpublic static getIsUnknownBrowser():boolean {\n\t\t\tthis.initialize();\n\t\t\treturn this.isUnknownBrowser;\n\t\t}\n\n\t\t// --------------------\n\t\t// Language\n\n\t\tpublic static getLang():string {\n\t\t\tthis.initialize();\n\t\t\treturn this.lang;\n\t\t}\n\n\t\tpublic static getLangFull():string {\n\t\t\tthis.initialize();\n\t\t\treturn this.langFull;\n\t\t}\n\n\t\t// --------------------\n\t\t// Capability\n\n\t\tpublic static getIsTouchEnabled():boolean {\n\t\t\tthis.initialize();\n\t\t\treturn this.isTouchEnabled;\n\t\t}\n\n\t\tpublic static getIsDownloadEnabled():boolean {\n\t\t\tthis.initialize();\n\t\t\treturn this.isDownloadEnabled;\n\t\t}\n\n\t\t// see: https://qiita.com/tonkotsuboy_com/items/cdffcdd7bdccac371292\n\t\tpublic static getIsWebGlEnabled():boolean {\n\t\t\tthis.initialize();\n\t\t\treturn this.isWebGlEnabled;\n\t\t}\n\n\t\t// --------------------\n\t\t// Resolution\n\n\t\tpublic static getIsRetina():boolean {\n\t\t\tthis.initialize();\n\t\t\treturn this.isRetina;\n\t\t}\n\n\t\tpublic static getDevicePixelRatio():number {\n\t\t\tthis.initialize();\n\t\t\treturn this.devicePixelRatio;\n\t\t}\n\n\t\tpublic static getDpi():number {\n\t\t\tif (this.dpi == -1) {\n\t\t\t\tconst div:HTMLElement = document.createElement('div');\n\t\t\t\tdiv.setAttribute('style', 'height:1in;left:-100%;top:-100%;position:absolute;width:1in;');\n\t\t\t\tdocument.body.appendChild(div);\n\t\t\t\tthis.dpi = div.offsetHeight;\n\t\t\t\tdocument.body.removeChild(div);\n\t\t\t}\n\t\t\treturn this.dpi;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprivate static isDesktop:boolean = false;\n\t\tprivate static isTablet:boolean = false;\n\t\tprivate static isMobile:boolean = false;\n\n\t\tprivate static isIOS:boolean = false;\n\t\tprivate static isAndroid:boolean = false;\n\n\t\tprivate static isIE:boolean = false;\n\t\tprivate static isEdge:boolean = false;\n\t\tprivate static isChrome:boolean = false;\n\t\tprivate static isSafari:boolean = false;\n\t\tprivate static isFireFox:boolean = false;\n\t\tprivate static isOpera:boolean = false;\n\t\tprivate static isUnknownBrowser:boolean = false;\n\n\t\tprivate static isTouchEnabled:boolean = false;\n\t\tprivate static isDownloadEnabled:boolean = false;\n\t\tprivate static isWebGlEnabled:boolean = false;\n\n\t\tprivate static isRetina:boolean = false;\n\t\tprivate static devicePixelRatio:number = 1;\n\t\tprivate static dpi:number = -1;\n\n\t\tprivate static lang:string;\n\t\tprivate static langFull:string;\n\n\t\tprivate static isInitialized:boolean = false;\n\n\n\n\n\n\t\tprivate constructor() {}\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.browser {\n\n\timport Time = alm.util.Time;\n\n\texport class LocalStorage {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\t/**\n\t\t * LocalStorage\n\t\t * @param key \n\t\t * @param value \n\t\t * @param expiredAt UNIX\n\t\t * @returns {boolean} true\n\t\t */\n\t\tpublic static save(key:string, value:any, expiredAt:number = -1):boolean {\n\t\t\tif (!LocalStorage.isAvailable()) return false;\n\t\t\tconst record:{ value:string; expiredAt:number } = { value:JSON.stringify(value), expiredAt: expiredAt };\n\t\t\tlocalStorage.setItem(key, JSON.stringify(record));\n\t\t\treturn true;\n\t\t}\n\n\t\t/**\n\t\t * LocalStorage\n\t\t * @param key \n\t\t * @param value \n\t\t * @param milliseconds \n\t\t * @returns {boolean} true\n\t\t */\n\t\tpublic static saveWithTerm(key:string, value:any, milliseconds:number = -1):boolean {\n\t\t\tconst expiredAt:number = milliseconds > 0 ? Time.now() + milliseconds : -1;\n\t\t\treturn LocalStorage.save(key, value, expiredAt);\n\t\t}\n\n\t\t/**\n\t\t * LocalStorage\n\t\t * @param key \n\t\t * @returns {any} \n\t\t */\n\t\tpublic static load(key:string, defaultValue:any = null):any {\n\t\t\tif (!LocalStorage.isAvailable()) return defaultValue;\n\t\t\tconst record:{ value:string; expiredAt:number } = JSON.parse(localStorage.getItem(key));\n\t\t\tif (record) {\n\t\t\t\t// \n\t\t\t\tif (record.expiredAt > 0) {\n\t\t\t\t\t// \n\t\t\t\t\tif (Time.now() < record.expiredAt) {\n\t\t\t\t\t\t// \n\t\t\t\t\t\treturn JSON.parse(record.value);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// \n\t\t\t\t\t\tlocalStorage.removeItem(key);\n\t\t\t\t\t\treturn defaultValue;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// \n\t\t\t\t\treturn JSON.parse(record.value);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// \n\t\t\t\treturn defaultValue;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * LocalStorage\n\t\t * @param key \n\t\t */\n\t\tpublic static remove(key:string):void {\n\t\t\tif (!LocalStorage.isAvailable()) return;\n\t\t\tlocalStorage.removeItem(key);\n\t\t}\n\n\t\t/**\n\t\t * LocalStorage\n\t\t * @returns {boolean} true\n\t\t */\n\t\tpublic static isAvailable():boolean {\n\t\t\tif (LocalStorage.isAvailable_ == null) {\n\t\t\t\ttry {\n\t\t\t\t\tlocalStorage.setItem('__CKECK__', '__CKECK__');\n\t\t\t\t\tlocalStorage.removeItem('__CKECK__');\n\t\t\t\t\tLocalStorage.isAvailable_ = true;\n\t\t\t\t} catch (error) {\n\t\t\t\t\tLocalStorage.isAvailable_ = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn LocalStorage.isAvailable_;\n\t\t}\n\n\t\t/**\n\t\t * \n\t\t * @param dates \n\t\t * @param hours \n\t\t * @param minutes \n\t\t * @param seconds \n\t\t * @param milliseconds \n\t\t * @returns {number} \n\t\t */\n\t\tpublic static toMilliseconds(dates:number = 0, hours:number = 0, minutes:number = 0, seconds:number = 0, milliseconds:number = 0):number {\n\t\t\treturn milliseconds + (seconds + (minutes + (hours + dates * 24) * 60) * 60) * 1000;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprivate static isAvailable_:boolean = null;\n\n\n\n\n\n\t\tprivate constructor() {}\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.browser {\n\n\texport class SessionStorage {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\t/**\n\t\t * \n\t\t * @param key \n\t\t * @param value \n\t\t * @returns {boolean} true\n\t\t */\n\t\tpublic static save(key:string, value:any):boolean {\n\t\t\tif (!SessionStorage.isAvailable()) return false;\n\t\t\tsessionStorage.setItem(key, JSON.stringify(value));\n\t\t\treturn true;\n\t\t}\n\n\t\t/**\n\t\t * \n\t\t * @param key \n\t\t * @returns {any} \n\t\t */\n\t\tpublic static load(key:string, defaultValue:any = null):any {\n\t\t\tif (!SessionStorage.isAvailable()) return defaultValue;\n\t\t\tconst record = JSON.parse(sessionStorage.getItem(key));\n\t\t\tif (record) {\n\t\t\t\treturn JSON.parse(record.value);\n\t\t\t} else {\n\t\t\t\t// \n\t\t\t\treturn defaultValue;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * LocalStorage\n\t\t * @param key \n\t\t */\n\t\tpublic static remove(key:string):void {\n\t\t\tif (!SessionStorage.isAvailable()) return;\n\t\t\tsessionStorage.removeItem(key);\n\t\t}\n\n\t\t/**\n\t\t * LocalStorage\n\t\t * @returns {boolean} true\n\t\t */\n\t\tpublic static isAvailable():boolean {\n\t\t\tif (SessionStorage.isAvailable_ == null) {\n\t\t\t\ttry {\n\t\t\t\t\tsessionStorage.setItem('__CKECK__', '__CKECK__');\n\t\t\t\t\tsessionStorage.removeItem('__CKECK__');\n\t\t\t\t\tSessionStorage.isAvailable_ = true;\n\t\t\t\t} catch (error) {\n\t\t\t\t\tSessionStorage.isAvailable_ = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn SessionStorage.isAvailable_;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprivate static isAvailable_:boolean = null;\n\n\n\n\n\n\t\tprivate constructor() {}\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.browser {\n\n\t// https://github.com/nfriend/ts-keycode-enum\n\texport enum KeyCode {\n\t\tbackspace = 8,\n\t\ttab = 9,\n\t\tenter = 13,\n\t\tshift = 16,\n\t\tctrl = 17,\n\t\talt = 18,\n\t\tpauseBreak = 19,\n\t\tcapsLock = 20,\n\t\tescape = 27,\n\t\tspace = 32,\n\t\tpageUp = 33,\n\t\tpageDown = 34,\n\t\tend = 35,\n\t\thome = 36,\n\n\t\tleftArrow = 37,\n\t\tupArrow = 38,\n\t\trightArrow = 39,\n\t\tdownArrow = 40,\n\n\t\tinsert = 45,\n\t\tdelete = 46,\n\n\t\tkey0 = 48,\n\t\tkey1 = 49,\n\t\tkey2 = 50,\n\t\tkey3 = 51,\n\t\tkey4 = 52,\n\t\tkey5 = 53,\n\t\tkey6 = 54,\n\t\tkey7 = 55,\n\t\tkey8 = 56,\n\t\tkey9 = 57,\n\n\t\tclosedParen = key0,\n\t\texclamationMark = key1,\n\t\tatSign = key2,\n\t\tpoundSign = key3,\n\t\thash = poundSign,\n\t\tdollarSign = key4,\n\t\tpercentSign = key5,\n\t\tcaret = key6,\n\t\that = caret,\n\t\tampersand = key7,\n\t\tstar = key8,\n\t\tasterik = star,\n\t\topenParen = key9,\n\n\t\ta = 65,\n\t\tb = 66,\n\t\tc = 67,\n\t\td = 68,\n\t\te = 69,\n\t\tf = 70,\n\t\tg = 71,\n\t\th = 72,\n\t\ti = 73,\n\t\tj = 74,\n\t\tk = 75,\n\t\tl = 76,\n\t\tm = 77,\n\t\tn = 78,\n\t\to = 79,\n\t\tp = 80,\n\t\tq = 81,\n\t\tr = 82,\n\t\ts = 83,\n\t\tt = 84,\n\t\tu = 85,\n\t\tv = 86,\n\t\tw = 87,\n\t\tx = 88,\n\t\ty = 89,\n\t\tz = 90,\n\n\t\tleftWindowKey = 91,\n\t\trightWindowKey = 92,\n\t\tselectKey = 93,\n\n\t\tnumpad0 = 96,\n\t\tnumpad1 = 97,\n\t\tnumpad2 = 98,\n\t\tnumpad3 = 99,\n\t\tnumpad4 = 100,\n\t\tnumpad5 = 101,\n\t\tnumpad6 = 102,\n\t\tnumpad7 = 103,\n\t\tnumpad8 = 104,\n\t\tnumpad9 = 105,\n\n\t\tmultiply = 106,\n\t\tadd = 107,\n\t\tsubtract = 109,\n\t\tdecimalPoint = 110,\n\t\tdivide = 111,\n\n\t\tF1 = 112,\n\t\tF2 = 113,\n\t\tF3 = 114,\n\t\tF4 = 115,\n\t\tF5 = 116,\n\t\tF6 = 117,\n\t\tF7 = 118,\n\t\tF8 = 119,\n\t\tF9 = 120,\n\t\tF10 = 121,\n\t\tF11 = 122,\n\t\tF12 = 123,\n\n\t\tnumLock = 144,\n\t\tscrollLock = 145,\n\n\t\tsemiColon = 186,\n\t\tequals = 187,\n\t\tcomma = 188,\n\t\tdash = 189,\n\t\tperiod = 190,\n\t\tunderScore = dash,\n\t\tplusSign = equals,\n\t\tforwardSlash = 191,\n\t\ttilde = 192,\n\t\tgraveAccent = tilde,\n\n\t\topenBracket = 219,\n\t\tclosedBracket = 221,\n\t\tquote = 222\n\t}\n\n\n\n\n\n\texport class KeyWatcher {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprivate static initialize():void {\n\t\t\tif (this.isInitialized) return;\n\t\t\tthis.isInitialized = true;\n\n\t\t\tthis.eventDispatcher = new alm.event.EventDispatcher();\n\t\t}\n\n\t\tpublic static start():void {\n\t\t\tif (this.isRunning) return;\n\t\t\tthis.isRunning = true;\n\n\t\t\tthis.initialize();\n\t\t\ttrace('[KeyWatcher] start');\n\n\t\t\twindow.addEventListener('keydown', this.windowKeyDownHandler);\n\t\t\twindow.addEventListener('keyup', this.windowKeyUpHandler);\n\t\t}\n\n\n\t\tpublic static stop():void {\n\t\t\tif (!this.isRunning) return;\n\t\t\tthis.isRunning = false;\n\n\t\t\tthis.initialize();\n\t\t\ttrace('[KeyWatcher] stop');\n\n\t\t\twindow.removeEventListener('keydown', this.windowKeyDownHandler);\n\t\t\twindow.removeEventListener('keyup', this.windowKeyUpHandler);\n\t\t}\n\n\t\tpublic static addEventListener(eventType:string, listener:(event:KeyWatcherEvent) => void):void {\n\t\t\tthis.initialize();\n\t\t\tthis.eventDispatcher.addEventListener(eventType, listener);\n\t\t}\n\n\t\tpublic static removeEventListener(eventType:string, listener:(event:KeyWatcherEvent) => void):void {\n\t\t\tthis.initialize();\n\t\t\tthis.eventDispatcher.removeEventListener(eventType, listener);\n\t\t}\n\n\n\n\n\n\t\tprivate static windowKeyDownHandler = (event:KeyboardEvent):void => {\n\t\t\tconst keyCode:number = event.keyCode;\n\t\t\tif (KeyWatcher.isKeyPressedByKeyCode[keyCode] == null) {\n\t\t\t\tKeyWatcher.isKeyPressedByKeyCode[keyCode] = true;\n\t\t\t\t++KeyWatcher.pressedKeyCount;\n\t\t\t\tKeyWatcher.eventDispatcher.dispatchEvent(new KeyWatcherEvent(KeyWatcherEvent.keyDown, KeyWatcher, event));\n\t\t\t} else if (KeyWatcher.isContinuousPressEnabled) {\n\t\t\t\tKeyWatcher.eventDispatcher.dispatchEvent(new KeyWatcherEvent(KeyWatcherEvent.keyDown, KeyWatcher, event));\n\t\t\t}\n\t\t};\n\n\t\tprivate static windowKeyUpHandler = (event:KeyboardEvent):void => {\n\t\t\tconst keyCode:number = event.keyCode;\n\t\t\tif (KeyWatcher.isKeyPressedByKeyCode[keyCode] != null) {\n\t\t\t\tdelete KeyWatcher.isKeyPressedByKeyCode[keyCode];\n\t\t\t\t--KeyWatcher.pressedKeyCount;\n\t\t\t\tKeyWatcher.eventDispatcher.dispatchEvent(new KeyWatcherEvent(KeyWatcherEvent.keyUp, KeyWatcher, event));\n\t\t\t}\n\t\t};\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic static getIsRunning():boolean { return this.isRunning; }\n\t\tprivate static isRunning:boolean = false;\n\n\t\tpublic static getIsAnyKeyPressed():boolean { return this.pressedKeyCount > 0; }\n\t\tprivate static pressedKeyCount:number = 0;\n\n\t\tpublic static getIsKeyPressed(keyCode:number):boolean { return this.isKeyPressedByKeyCode[keyCode] != null; }\n\t\tprivate static isKeyPressedByKeyCode:util.Hash<boolean> = {};\n\n\n\t\tpublic static getIsContinuousPressEnabled():boolean { return this.isContinuousPressEnabled; }\n\t\tpublic static setIsContinuousPressEnabled(enabled:boolean):void { this.isContinuousPressEnabled = enabled; }\n\t\tprivate static isContinuousPressEnabled:boolean = false;\n\n\t\tprivate static isInitialized:boolean = false;\n\t\tprivate static isLongPressed:boolean = false;\n\t\tprivate static eventDispatcher:alm.event.EventDispatcher = null;\n\n\n\n\n\n\t\tprivate constructor() {}\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.browser {\n\n\texport class KeyWatcherEvent extends alm.event.Event<KeyWatcher> {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// EVENT\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic static readonly keyUp:string = 'KeyWatcherEvent.keyUp';\n\t\tpublic static readonly keyDown:string = 'KeyWatcherEvent.keyDown';\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(eventType:string, eventTarget:KeyWatcher, originalEvent:KeyboardEvent = null) {\n\t\t\tsuper(eventType, eventTarget);\n\t\t\tthis.originalEvent = originalEvent;\n\t\t\tthis.key = this.originalEvent.key;\n\t\t\tthis.keyCode = this.originalEvent.keyCode;\n\t\t\tthis.altKey = this.originalEvent.altKey;\n\t\t\tthis.ctrlKey = this.originalEvent.ctrlKey;\n\t\t\tthis.shiftKey = this.originalEvent.shiftKey;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic clone():KeyWatcherEvent {\n\t\t\treturn new KeyWatcherEvent(this.type, this.target, this.originalEvent);\n\t\t}\n\n\t\tpublic toString():string {\n\t\t\treturn '[KeyWatcherEvent] type = ' + this.type + ', key = ' + this.key + ', keyCode = ' + this.keyCode + ', altKey = ' + this.altKey + ', ctrlKey = ' + this.ctrlKey + ', shiftKey = ' + this.shiftKey;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic readonly originalEvent:KeyboardEvent;\n\t\tpublic readonly key:string;\n\t\tpublic readonly keyCode:number;\n\t\tpublic readonly altKey:boolean;\n\t\tpublic readonly ctrlKey:boolean;\n\t\tpublic readonly shiftKey:boolean;\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.browser {\n\n\texport class WinWatcher {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprivate static initialize():void {\n\t\t\tif (this.isInitialized) return;\n\t\t\tthis.isInitialized = true;\n\n\t\t\tthis.eventDispatcher = new alm.event.EventDispatcher();\n\t\t}\n\n\t\tpublic static start(target:Window = null):void {\n\t\t\tif (this.isRunning) return;\n\t\t\tthis.isRunning = true;\n\n\t\t\tthis.initialize();\n\t\t\ttrace('[WinWatcher] start');\n\n\t\t\tthis.window = target || window;\n\n\t\t\tthis.window.addEventListener('resize', this.windowResizeHandler);\n\t\t\tthis.window.addEventListener('orientationchange', this.windowResizeHandler);\n\t\t\tthis.window.addEventListener('scroll', this.windowScrollHandler);\n\t\t\tthis.apply();\n\t\t}\n\n\t\tpublic static stop():void {\n\t\t\tif (!this.isRunning) return;\n\t\t\tthis.isRunning = false;\n\n\t\t\tthis.initialize();\n\t\t\ttrace('[WinWatcher] stop');\n\n\t\t\tthis.window.removeEventListener('resize', this.windowResizeHandler);\n\t\t\tthis.window.removeEventListener('orientationchange', this.windowResizeHandler);\n\t\t\tthis.window.removeEventListener('scroll', this.windowScrollHandler);\n\t\t}\n\n\t\tpublic static apply():void {\n\t\t\tthis.width = this.window.innerWidth;\n\t\t\tthis.height = this.window.innerHeight;\n\n\t\t\tthis.scrollTop = (this.window.scrollY !== undefined) ? this.window.scrollY : document.documentElement.scrollTop;\n\t\t\tthis.scrollBottom = this.scrollTop + this.height;\n\t\t}\n\n\t\tpublic static addEventListener(eventType:string, listener:(event:WinWatcherEvent) => void):void {\n\t\t\tthis.initialize();\n\t\t\tthis.eventDispatcher.addEventListener(eventType, listener);\n\t\t}\n\n\t\tpublic static removeEventListener(eventType:string, listener:(event:WinWatcherEvent) => void):void {\n\t\t\tthis.initialize();\n\t\t\tthis.eventDispatcher.removeEventListener(eventType, listener);\n\t\t}\n\n\t\tpublic static calcScrolledPosition(y:number):number {\n\t\t\treturn y - this.scrollTop;\n\t\t};\n\n\t\tpublic static calcScrolledPositionRatio(y:number):number {\n\t\t\treturn this.calcScrolledPosition(y) / this.height;\n\t\t}\n\n\t\tprivate static resize(event:Event):void {\n\t\t\tWinWatcher.apply();\n\t\t\tWinWatcher.eventDispatcher.dispatchEvent(new WinWatcherEvent(WinWatcherEvent.resize, WinWatcher, event, WinWatcher.scrollTop, WinWatcher.scrollBottom, WinWatcher.width, WinWatcher.height));\n\t\t};\n\n\n\n\n\n\t\tprivate static windowResizeHandler = (event:Event):void => {\n\t\t\tif (!DeviceInfo.getIsDesktop() && WinWatcher.isMobileOrientationResize) return;\n\t\t\ttrace('[WinWatcher] resize by window.resize');\n\t\t\tWinWatcher.resize(event);\n\t\t};\n\n\t\tprivate static windowOrientationChangeHandler = (event:Event):void => {\n\t\t\tif (DeviceInfo.getIsDesktop() || !WinWatcher.isMobileOrientationResize) return;\n\t\t\ttrace('[WinWatcher] resize by window.orientationchange');\n\t\t\tWinWatcher.resize(event);\n\t\t};\n\n\t\tprivate static windowScrollHandler = (event:Event):void => {\n\t\t\tWinWatcher.apply();\n\t\t\tWinWatcher.eventDispatcher.dispatchEvent(new WinWatcherEvent(WinWatcherEvent.scroll, WinWatcher, event, WinWatcher.scrollTop, WinWatcher.scrollBottom, WinWatcher.width, WinWatcher.height));\n\t\t};\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic static getIsRunning():boolean { return this.isRunning; }\n\t\tprivate static isRunning:boolean = false;\n\n\t\tpublic static getWindow():Window { return this.window; }\n\t\tprivate static window:Window = null;\n\n\t\tpublic static getScrollTop():number { return this.scrollTop; }\n\t\tprivate static scrollTop:number;\n\n\t\tpublic static getScrollBottom():number { return this.scrollBottom; }\n\t\tprivate static scrollBottom:number;\n\n\t\tpublic static getWidth():number { return this.width; }\n\t\tprivate static width:number = 0;\n\n\t\tpublic static getHeight():number { return this.height; }\n\t\tprivate static height:number = 0;\n\n\t\tpublic static getIsMobileOrientationResize():boolean { return this.isMobileOrientationResize; }\n\t\tpublic static setIsMobileOrientationResize(value:boolean):void { this.isMobileOrientationResize = value; }\n\t\tprivate static isMobileOrientationResize:boolean = true;\n\n\t\tprivate static isInitialized:boolean = false;\n\t\tprivate static eventDispatcher:alm.event.EventDispatcher = null;\n\n\n\n\n\n\t\tprivate constructor() {}\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.browser {\n\n\texport class WinWatcherEvent extends alm.event.Event<WinWatcher> {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// EVENT\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic static readonly scroll:string = 'WinWatcherEvent.scroll';\n\t\tpublic static readonly resize:string = 'WinWatcherEvent.resize';\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(eventType:string, eventTarget:WinWatcher, originalEvent:Event = null, scrollTop:number = 0, scrollBottom:number = 0, width:number = 0, height:number = 0) {\n\t\t\tsuper(eventType, eventTarget);\n\t\t\tthis.originalEvent = originalEvent;\n\t\t\tthis.scrollTop = scrollTop;\n\t\t\tthis.scrollBottom = scrollBottom;\n\t\t\tthis.width = width;\n\t\t\tthis.height = height;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic clone():WinWatcherEvent {\n\t\t\treturn new WinWatcherEvent(this.type, this.target, this.originalEvent, this.scrollTop, this.scrollBottom, this.width, this.height);\n\t\t}\n\n\t\tpublic toString():string {\n\t\t\treturn '[WinWatcherEvent] type = ' + this.type + ', scrollTop = ' + this.scrollTop + ', scrollBottom = ' + this.scrollBottom + ', width = ' + this.width + ', height = ' + this.height;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic readonly originalEvent:Event;\n\t\tpublic readonly scrollTop:number;\n\t\tpublic readonly scrollBottom:number;\n\t\tpublic readonly width:number;\n\t\tpublic readonly height:number;\n\t}\n}\n","/// <reference path=\"../../index.ts\" />\n\nnamespace alm.browser {\n\n\texport class ScrollSectionTriggerEvent extends alm.event.Event<ScrollSectionTrigger> {\n\n\t\tpublic static readonly change:string = 'ScrollSectionTriggerEvent.change';\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(eventType:string, target:ScrollSectionTrigger, currentSectionIndex:number, prevSectionIndex:number) {\n\t\t\tsuper(eventType, target);\n\n\t\t\tthis.currentSectionIndex = currentSectionIndex;\n\t\t\tthis.prevSectionIndex = prevSectionIndex;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic readonly currentSectionIndex:number;\n\t\tpublic readonly prevSectionIndex:number;\n\t}\n}\n","/// <reference path=\"../../index.ts\" />\n\nnamespace alm.browser {\n\n\timport Logger = alm.debug.Logger;\n\timport WinWatcher = alm.browser.WinWatcher;\n\timport WinWatcherEvent = alm.browser.WinWatcherEvent;\n\timport EventDispatcher = alm.event.EventDispatcher;\n\n\texport class ScrollSectionTrigger extends EventDispatcher {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(threshold:number = 0.5) {\n\t\t\tsuper();\n\n\t\t\tthis.isRunning = false;\n\n\t\t\tthis.scrollPosition = null;\n\t\t\tthis.triggerPositions = [];\n\t\t\tthis.thresholdRatio = threshold;\n\t\t\tthis.thresholdPosition = null;\n\n\t\t\tthis.currentSectionIndex = -1;\n\t\t\tthis.prevSectionIndex = -1;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic start():void {\n\t\t\tif (this.isRunning) return;\n\t\t\tthis.isRunning = true;\n\n\t\t\tWinWatcher.addEventListener(WinWatcherEvent.scroll, this.windowScrollHandler);\n\t\t\tWinWatcher.addEventListener(WinWatcherEvent.resize, this.windowResizeHandler);\n\t\t\tWinWatcher.start();\n\n\t\t\tthis.updateThresholdPosition();\n\t\t\tthis.updateScrollPosition();\n\t\t\tthis.check();\n\t\t}\n\n\t\tpublic stop():void {\n\t\t\tif (!this.isRunning) return;\n\t\t\tthis.isRunning = false;\n\n\t\t\tWinWatcher.removeEventListener(WinWatcherEvent.scroll, this.windowScrollHandler);\n\t\t\tWinWatcher.removeEventListener(WinWatcherEvent.resize, this.windowResizeHandler);\n\t\t\tWinWatcher.stop();\n\t\t}\n\n\t\tpublic getIsRunning():boolean {\n\t\t\treturn this.isRunning;\n\t\t}\n\n\t\tpublic getCurrentIndex():number {\n\t\t\treturn this.currentSectionIndex;\n\t\t}\n\n\t\tpublic getPrevIndex():number {\n\t\t\treturn this.prevSectionIndex;\n\t\t}\n\n\t\tpublic getTriggerPositions():number[] {\n\t\t\treturn this.triggerPositions.concat();\n\t\t}\n\n\t\tpublic setTriggerPositions(positions:number[]):void {\n\t\t\tthis.triggerPositions = positions.concat();\n\t\t\tthis.triggerPositions.sort((a, b):number => { return a - b; });\n\t\t\tif (this.isRunning) {\n\t\t\t\tthis.check();\n\t\t\t}\n\t\t}\n\n\t\tpublic getThreshold():number {\n\t\t\treturn this.thresholdRatio;\n\t\t}\n\n\t\tpublic setThreshold(ratio:number):void {\n\t\t\tthis.thresholdRatio = ratio;\n\t\t\tthis.updateThresholdPosition();\n\t\t\tif (this.isRunning) {\n\t\t\t\tthis.check();\n\t\t\t}\n\t\t}\n\n\t\tprivate check():void {\n\t\t\tif (this.scrollPosition == null) {\n\t\t\t\tLogger.warn('[RangeTrigger] current position is need set');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet nearestTriggerIndex = -1;\n\t\t\tlet nearestScrolledTriggerPosition = -1;\n\t\t\tlet nearestDistance:number = Number.MAX_VALUE;\n\t\t\tconst triggerPositionCount = this.triggerPositions.length;\n\t\t\tfor (let i = 0; i < triggerPositionCount; ++i) {\n\t\t\t\tconst scrolledTriggerPosition = this.triggerPositions[i] - this.scrollPosition;\n\t\t\t\tconst distance = Math.abs(scrolledTriggerPosition - this.thresholdPosition);\n\t\t\t\tif (distance < nearestDistance) {\n\t\t\t\t\tnearestDistance = distance;\n\t\t\t\t\tnearestTriggerIndex = i;\n\t\t\t\t\tnearestScrolledTriggerPosition = scrolledTriggerPosition;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (nearestTriggerIndex >= 0) {\n\t\t\t\tlet sectionIndex = -1;\n\t\t\t\tif (nearestScrolledTriggerPosition > this.thresholdPosition) {\n\t\t\t\t\tsectionIndex = nearestTriggerIndex;\n\t\t\t\t} else {\n\t\t\t\t\tsectionIndex = nearestTriggerIndex + 1;\n\t\t\t\t}\n\n\t\t\t\tif (this.currentSectionIndex != sectionIndex) {\n\t\t\t\t\tthis.prevSectionIndex = this.currentSectionIndex;\n\t\t\t\t\tthis.currentSectionIndex = sectionIndex;\n\t\t\t\t\tthis.dispatchEvent(new ScrollSectionTriggerEvent(ScrollSectionTriggerEvent.change, this, this.currentSectionIndex, this.prevSectionIndex));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tprivate updateThresholdPosition():void {\n\t\t\tthis.thresholdPosition = WinWatcher.getHeight() * this.thresholdRatio;\n\t\t}\n\n\t\tprivate updateScrollPosition():void {\n\t\t\tthis.scrollPosition = WinWatcher.getScrollTop();\n\t\t}\n\n\t\tprivate windowScrollHandler = (event:WinWatcherEvent):void => {\n\t\t\tthis.updateScrollPosition();\n\t\t\tthis.check();\n\t\t};\n\n\t\tprivate windowResizeHandler = (event:WinWatcherEvent):void => {\n\t\t\tthis.updateThresholdPosition();\n\t\t\tthis.updateScrollPosition();\n\t\t\tthis.check();\n\t\t};\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprivate isRunning:boolean;\n\n\t\tprivate scrollPosition:number;\n\t\tprivate triggerPositions:number[];\n\t\tprivate thresholdRatio:number;\n\t\tprivate thresholdPosition:number;\n\n\t\tprivate currentSectionIndex:number;\n\t\tprivate prevSectionIndex:number;\n\t}\n}\n","/// <reference path=\"../../index.ts\" />\n\nnamespace alm.browser {\n\n\timport WinWatcher = alm.browser.WinWatcher;\n\timport WinWatcherEvent = alm.browser.WinWatcherEvent;\n\timport EventDispatcher = alm.event.EventDispatcher;\n\n\texport class ResponsiveObserver extends EventDispatcher {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor() {\n\t\t\tsuper();\n\n\t\t\tthis.breakPoints = [];\n\t\t\tthis.breakPointCount = 0;\n\n\t\t\tthis.currentIndex = -1;\n\t\t\tthis.prevIndex = -1;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic start():void {\n\t\t\tif (this.isRunning) return;\n\t\t\tthis.isRunning = true;\n\n\t\t\tWinWatcher.addEventListener(WinWatcherEvent.resize, this.windowResizeHandler);\n\t\t\tWinWatcher.start();\n\n\t\t\tthis.check();\n\t\t}\n\n\t\tpublic stop():void {\n\t\t\tif (!this.isRunning) return;\n\t\t\tthis.isRunning = false;\n\n\t\t\tWinWatcher.removeEventListener(WinWatcherEvent.resize, this.windowResizeHandler);\n\t\t\tWinWatcher.stop();\n\t\t}\n\n\t\tpublic setBreakpoints(breakPoints:number[]):void {\n\t\t\tthis.breakPoints = breakPoints.concat();\n\t\t\tthis.breakPointCount = this.breakPoints.length;\n\t\t\tthis.breakPoints.sort((a, b):number => { return a - b; });\n\t\t\tif (this.isRunning) {\n\t\t\t\tthis.check();\n\t\t\t}\n\t\t}\n\n\t\tpublic getIsRunning():boolean {\n\t\t\treturn this.isRunning;\n\t\t}\n\n\t\tpublic getCurrentIndex():number {\n\t\t\treturn this.currentIndex;\n\t\t}\n\n\t\tpublic getPrevIndex():number {\n\t\t\treturn this.prevIndex;\n\t\t}\n\n\t\tpublic getBreakPoints():number[] {\n\t\t\treturn this.breakPoints.concat();\n\t\t}\n\n\t\tpublic getBreakPointCount():number {\n\t\t\treturn this.breakPointCount;\n\t\t}\n\n\t\tprivate check():void {\n\t\t\tconst windowWidth = WinWatcher.getWidth();\n\t\t\tlet index;\n\t\t\tfor (index = 0; index < this.breakPointCount; ++index) {\n\t\t\t\tif (windowWidth <= this.breakPoints[index]) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.currentIndex == index) return;\n\t\t\tthis.prevIndex = this.currentIndex;\n\t\t\tthis.currentIndex = index;\n\t\t\ttrace('[ResponsiveObserver] switch index :', this.prevIndex, '->', this.currentIndex, ', window width =', windowWidth);\n\n\t\t\tthis.dispatchEvent(new ResponsiveObserverEvent(ResponsiveObserverEvent.change, this, this.currentIndex, this.prevIndex));\n\t\t}\n\n\t\tprivate windowResizeHandler = (event:WinWatcherEvent):void => {\n\t\t\tthis.check();\n\t\t};\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprivate isRunning:boolean;\n\n\t\tprivate breakPoints:number[];\n\t\tprivate breakPointCount:number;\n\n\t\tprivate currentIndex:number;\n\t\tprivate prevIndex:number;\n\t}\n}\n","/// <reference path=\"../../index.ts\" />\n\nnamespace alm.browser {\n\n\texport class ResponsiveObserverEvent extends alm.event.Event<ResponsiveObserver> {\n\n\t\tpublic static readonly change:string = 'ResponsiveObserverEvent.change';\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(eventType:string, target:ResponsiveObserver, currentIndex:number, prevIndex:number) {\n\t\t\tsuper(eventType, target);\n\n\t\t\tthis.currentIndex = currentIndex;\n\t\t\tthis.prevIndex = prevIndex;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic readonly currentIndex:number;\n\t\tpublic readonly prevIndex:number;\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace alm.browser {\n\n\timport Num = alm.util.Num;\n\n\texport class Kiosk {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprivate constructor() {\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic static disableInteraction(): void {\n\t\t\tif (this.isInteractionDisabled) return;\n\t\t\tthis.isInteractionDisabled = true;\n\n\t\t\tdocument.addEventListener('dblclick', Kiosk.doubleClickHandler, { passive: false });\n\t\t\tdocument.addEventListener('contextmenu', Kiosk.contextMenuHandler, { passive: false });\n\n\t\t\t// <html> CSS\n\t\t\tdocument.documentElement.style.setProperty('touch-action', 'none');\n\t\t\tdocument.documentElement.style.setProperty('pointer-events', 'none');\n\t\t\tdocument.documentElement.style.setProperty('user-select', 'none');\n\t\t\tdocument.documentElement.style.setProperty('-webkit-user-select', 'none');\n\t\t\tdocument.documentElement.style.setProperty('overscroll-behavior', 'none');\n\t\t\tdocument.documentElement.style.setProperty('overflow', 'hidden');\n\n\t\t\t// <body> CSS\n\t\t\tdocument.body.style.setProperty('touch-action', 'none');\n\t\t\tdocument.body.style.setProperty('pointer-events', 'none');\n\t\t\tdocument.body.style.setProperty('user-select', 'none');\n\t\t\tdocument.body.style.setProperty('-webkit-user-select', 'none');\n\t\t\tdocument.body.style.setProperty('overscroll-behavior', 'none');\n\t\t\tdocument.body.style.setProperty('overflow', 'hidden');\n\t\t\tdocument.body.style.setProperty('-webkit-touch-callout', 'none');\n\t\t\tdocument.body.style.setProperty('-webkit-tap-highlight-color', 'rgba(0, 0, 0, 0)');\n\t\t}\n\n\t\tprivate static doubleClickHandler = (event:MouseEvent):void => {\n\t\t\tevent.preventDefault();\n\t\t};\n\n\t\tprivate static contextMenuHandler = (event:Event):void => {\n\t\t\tevent.preventDefault();\n\t\t};\n\n\n\n\n\n\t\tpublic static setStageSize(width:number, height:number):void {\n\t\t\tthis.width = width;\n\t\t\tthis.height = height;\n\n\t\t\tthis.aspectRatio = this.width / this.height;\n\t\t\tif (this.aspectRatio >= 1) {\n\t\t\t\t// landscape\n\t\t\t\tthis.normalizedByCoverWidth = this.aspectRatio;\n\t\t\t\tthis.normalizedByCoverHeight = 1;\n\t\t\t\tthis.normalizedByContainWidth = 1;\n\t\t\t\tthis.normalizedByContainHeight = 1 / this.aspectRatio;\n\t\t\t} else {\n\t\t\t\t// portrait\n\t\t\t\tthis.normalizedByCoverWidth = 1;\n\t\t\t\tthis.normalizedByCoverHeight = 1 / this.aspectRatio;\n\t\t\t\tthis.normalizedByContainWidth = this.aspectRatio;\n\t\t\t\tthis.normalizedByContainHeight = 1;\n\t\t\t}\n\t\t}\n\n\t\tpublic static ratioX(xPixel:number, clamp:boolean = true):number {\n\t\t\tconst ratio = xPixel / Kiosk.width;\n\t\t\treturn clamp ? Num.clamp(ratio, 0, 1) : ratio;\n\t\t}\n\n\t\tpublic static ratioY(yPixel:number, clamp:boolean = true):number {\n\t\t\tconst ratio = yPixel / Kiosk.height;\n\t\t\treturn clamp ? Num.clamp(ratio, 0, 1) : ratio;\n\t\t}\n\n\t\tpublic static coverRatioX(xPixel:number, clamp:boolean = true):number {\n\t\t\treturn Kiosk.ratioX(xPixel, clamp) * Kiosk.normalizedByCoverWidth;\n\t\t}\n\n\t\tpublic static coverRatioY(yPixel:number, clamp:boolean = true):number {\n\t\t\treturn Kiosk.ratioY(yPixel, clamp) * Kiosk.normalizedByCoverHeight;\n\t\t}\n\n\t\tpublic static containRatioX(xPixel:number, clamp:boolean = true):number {\n\t\t\treturn Kiosk.ratioX(xPixel, clamp) * Kiosk.normalizedByContainWidth;\n\t\t}\n\n\t\tpublic static containRatioY(yPixel:number, clamp:boolean = true):number {\n\t\t\treturn Kiosk.ratioY(yPixel, clamp) * Kiosk.normalizedByContainHeight;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprivate static isInteractionDisabled:boolean = false;\n\n\t\tpublic static getWidth():number { return this.width; }\n\t\tprivate static width:number = 0;\n\n\t\tpublic static getHeight():number { return this.height; }\n\t\tprivate static height:number = 0;\n\n\t\tpublic static getAspectRatio():number { return this.aspectRatio; }\n\t\tprivate static aspectRatio:number = 0;\n\n\t\tpublic static getNormalizedByCoverWidth():number { return this.normalizedByCoverWidth; }\n\t\tprivate static normalizedByCoverWidth:number = 0;\n\n\t\tpublic static getNormalizedByCoverHeight():number { return this.normalizedByCoverHeight; }\n\t\tprivate static normalizedByCoverHeight:number = 0;\n\n\t\tpublic static getNormalizedByContainWidth():number { return this.normalizedByContainWidth; }\n\t\tprivate static normalizedByContainWidth:number = 0;\n\n\t\tpublic static getNormalizedByContainHeight():number { return this.normalizedByContainHeight; }\n\t\tprivate static normalizedByContainHeight:number = 0;\n\t}\n}\n","/// <reference path='../index.ts' />\n\nnamespace scn {\n\n\timport Logger = alm.debug.Logger;\n\timport EventDispatcher = alm.event.EventDispatcher;\n\timport Hash = alm.util.Hash;\n\n\texport class Scene extends EventDispatcher {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(name:string) {\n\t\t\tsuper();\n\t\t\tthis.name = name;\n\t\t\tthis.state = SceneState.idling;\n\t\t\tthis.parent = null;\n\t\t\tthis.childrenByName = {};\n\t\t\tthis.numChildren = 0;\n\t\t\tthis.transferInfo = null;\n\t\t\tthis.onLoad = null;\n\t\t\tthis.onUnload = null;\n\t\t\tthis.onArrive = null;\n\t\t\tthis.onLeave = null;\n\t\t\tthis.onAscend = null;\n\t\t\tthis.onDescend = null;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic addChild(child:Scene):Scene {\n\t\t\tif (child) {\n\t\t\t\tconst childName:string = child.name;\n\t\t\t\tif (this.childrenByName[childName]) {\n\t\t\t\t\tLogger.warn('[Scene \\'' + this.name + '\\'] addChild was failed, because child name \\'' + childName + '\\' is already contained.');\n\t\t\t\t} else {\n\t\t\t\t\t++this.numChildren;\n\t\t\t\t\tchild.parent = this;\n\t\t\t\t\tthis.childrenByName[childName] = child;\n\t\t\t\t\treturn child;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tLogger.warn('[Scene \\'' + this.name + '\\'] addChild was failed, because child is null.');\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\tpublic removeChild(child:Scene):Scene {\n\t\t\tif (child) {\n\t\t\t\tconst childName:string = child.name;\n\t\t\t\tif (this.childrenByName[childName]) {\n\t\t\t\t\t--this.numChildren;\n\t\t\t\t\tchild.parent = null;\n\t\t\t\t\tdelete this.childrenByName[childName];\n\t\t\t\t\treturn child;\n\t\t\t\t} else {\n\t\t\t\t\tLogger.warn('[Scene \\'' + this.name + '\\'] removeChild was failed, because child name \\'' + childName + '\\' is not contained.');\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tLogger.warn('[Scene \\'' + this.name + '\\'] removeChild was failed, because child is null.');\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\tpublic addChildren(children:Scene[]):Scene[] {\n\t\t\tconst addedChildren:Scene[] = [];\n\t\t\tconst n:number = children.length;\n\t\t\tlet c:Scene;\n\t\t\tfor (let i:number = 0; i < n; ++i) {\n\t\t\t\tc = this.addChild(children[i]);\n\t\t\t\tif (c) {\n\t\t\t\t\taddedChildren.push(c);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn addedChildren;\n\t\t}\n\n\t\tpublic removeChildren(children:Scene[]):Scene[] {\n\t\t\tconst removedChildren:Scene[] = [];\n\t\t\tconst n:number = children.length;\n\t\t\tlet c:Scene;\n\t\t\tfor (let i:number = 0; i < n; ++i) {\n\t\t\t\tc = this.removeChild(children[i]);\n\t\t\t\tif (c) {\n\t\t\t\t\tremovedChildren.push(c);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn removedChildren;\n\t\t}\n\n\t\tpublic removeAllChildren():Scene[] {\n\t\t\tconst children:Scene[] = [];\n\t\t\tlet child:Scene;\n\t\t\tfor (let name in this.childrenByName) {\n\t\t\t\tchild = this.childrenByName[name];\n\t\t\t\tchild.parent = null;\n\t\t\t\tchildren.push(child);\n\t\t\t}\n\t\t\tthis.childrenByName = {};\n\t\t\tthis.numChildren = 0;\n\t\t\treturn children;\n\t\t}\n\n\t\tpublic contains(child:Scene|string):boolean {\n\t\t\tif (child) {\n\t\t\t\treturn this.childrenByName[typeof child == 'string' ? child : child.name] != null;\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tpublic getName():string {\n\t\t\treturn this.name;\n\t\t}\n\n\t\tpublic getState():SceneState {\n\t\t\treturn this.state;\n\t\t}\n\n\t\tpublic getLastState():SceneState {\n\t\t\treturn this.lastState;\n\t\t}\n\n\t\tpublic getParent():Scene {\n\t\t\treturn this.parent;\n\t\t}\n\n\t\tpublic getChildByName(name:string):Scene {\n\t\t\treturn this.childrenByName[name] || null;\n\t\t}\n\n\t\tpublic getChildrenByName():Hash<Scene> {\n\t\t\treturn this.childrenByName;\n\t\t}\n\n\t\tpublic getNumChildren():number {\n\t\t\treturn this.numChildren;\n\t\t}\n\n\t\tpublic getManager():SceneManager {\n\t\t\tif (this.parent) {\n\t\t\t\treturn this.parent.getManager();\n\t\t\t} else {\n\t\t\t\tLogger.warn('[Scene \\'' + this.name + '\\'] getManager was failed, check whether if scene is connected to root.');\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\tpublic getPath():string {\n\t\t\tconst manager:SceneManager = this.getManager();\n\t\t\tif (manager) {\n\t\t\t\tconst names:string[] = [this.name];\n\t\t\t\tlet scene:Scene = this;\n\t\t\t\twhile (scene = scene.parent) {\n\t\t\t\t\tnames.unshift(scene.name);\n\t\t\t\t}\n\t\t\t\treturn manager.getScenePathByNames(names);\n\t\t\t} else {\n\t\t\t\tLogger.warn('[Scene \\'' + this.name + '\\'] getPath was failed, check whether if scene is connected to root.');\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\tpublic getTransferInfo():SceneTransferInfo {\n\t\t\treturn this.transferInfo || null;\n\t\t}\n\n\t\tpublic gotoScene(path:string, message:any = null):void {\n\t\t\tthis.getManager().goto(path, message);\n\t\t}\n\n\n\n\n\n\t\tpublic _load(transferInfo:SceneTransferInfo):void {\n\t\t\tthis.transferInfo = transferInfo;\n\t\t\tthis.state = SceneState.loading;\n\t\t\tconst command:cmd.Serial = new cmd.Serial(\n\t\t\t\t():void => {\n\t\t\t\t\tthis.dispatchEvent(new SceneEvent(SceneEvent.load, this));\n\t\t\t\t\tconst c:cmd.Command = typeof(this.onLoad) == 'function' ? this.onLoad() : this.implOnLoad();\n\t\t\t\t\tif (c) command.insertCommand(c);\n\t\t\t\t},\n\t\t\t\t():void => {\n\t\t\t\t\tthis.lastState = this.state;\n\t\t\t\t\tthis.state = SceneState.idling;\n\t\t\t\t\tthis.transferInfo = null;\n\t\t\t\t\tthis.dispatchEvent(new SceneEvent(SceneEvent.loadComplete, this));\n\t\t\t\t}\n\t\t\t);\n\t\t\tcommand.execute();\n\t\t}\n\n\t\tpublic _unload(transferInfo:SceneTransferInfo):void {\n\t\t\tthis.transferInfo = transferInfo;\n\t\t\tthis.state = SceneState.unloading;\n\t\t\tconst command:cmd.Serial = new cmd.Serial(\n\t\t\t\t():void => {\n\t\t\t\t\tthis.dispatchEvent(new SceneEvent(SceneEvent.unload, this));\n\t\t\t\t\tconst c:cmd.Command = typeof(this.onUnload) == 'function' ? this.onUnload() : this.implOnUnload();\n\t\t\t\t\tif (c) command.insertCommand(c);\n\t\t\t\t},\n\t\t\t\t():void => {\n\t\t\t\t\tthis.lastState = this.state;\n\t\t\t\t\tthis.state = SceneState.idling;\n\t\t\t\t\tthis.transferInfo = null;\n\t\t\t\t\tthis.dispatchEvent(new SceneEvent(SceneEvent.unloadComplete, this));\n\t\t\t\t}\n\t\t\t);\n\t\t\tcommand.execute();\n\t\t}\n\n\t\tpublic _arrive(transferInfo:SceneTransferInfo):void {\n\t\t\tthis.transferInfo = transferInfo;\n\t\t\tthis.state = SceneState.arriving;\n\t\t\tconst command:cmd.Serial = new cmd.Serial(\n\t\t\t\t():void => {\n\t\t\t\t\tthis.dispatchEvent(new SceneEvent(SceneEvent.arrive, this));\n\t\t\t\t\tconst c:cmd.Command = typeof(this.onArrive) == 'function' ? this.onArrive() : this.implOnArrive();\n\t\t\t\t\tif (c) command.insertCommand(c);\n\t\t\t\t},\n\t\t\t\t():void => {\n\t\t\t\t\tthis.lastState = this.state;\n\t\t\t\t\tthis.state = SceneState.idling;\n\t\t\t\t\tthis.transferInfo = null;\n\t\t\t\t\tthis.dispatchEvent(new SceneEvent(SceneEvent.arriveComplete, this));\n\t\t\t\t}\n\t\t\t);\n\t\t\tcommand.execute();\n\t\t}\n\n\t\tpublic _leave(transferInfo:SceneTransferInfo):void {\n\t\t\tthis.transferInfo = transferInfo;\n\t\t\tthis.state = SceneState.leaving;\n\t\t\tconst command:cmd.Serial = new cmd.Serial(\n\t\t\t\t():void => {\n\t\t\t\t\tthis.dispatchEvent(new SceneEvent(SceneEvent.leave, this));\n\t\t\t\t\tconst c:cmd.Command = typeof(this.onLeave) == 'function' ? this.onLeave() : this.implOnLeave();\n\t\t\t\t\tif (c) command.insertCommand(c);\n\t\t\t\t},\n\t\t\t\t():void => {\n\t\t\t\t\tthis.lastState = this.state;\n\t\t\t\t\tthis.state = SceneState.idling;\n\t\t\t\t\tthis.transferInfo = null;\n\t\t\t\t\tthis.dispatchEvent(new SceneEvent(SceneEvent.leaveComplete, this));\n\t\t\t\t}\n\t\t\t);\n\t\t\tcommand.execute();\n\t\t}\n\n\t\tpublic _ascend(transferInfo:SceneTransferInfo):void {\n\t\t\tthis.transferInfo = transferInfo;\n\t\t\tthis.state = SceneState.ascending;\n\t\t\tconst command:cmd.Serial = new cmd.Serial(\n\t\t\t\t():void => {\n\t\t\t\t\tthis.dispatchEvent(new SceneEvent(SceneEvent.ascend, this));\n\t\t\t\t\tconst c:cmd.Command = typeof(this.onAscend) == 'function' ? this.onAscend() : this.implOnAscend();\n\t\t\t\t\tif (c) command.insertCommand(c);\n\t\t\t\t},\n\t\t\t\t():void => {\n\t\t\t\t\tthis.lastState = this.state;\n\t\t\t\t\tthis.state = SceneState.idling;\n\t\t\t\t\tthis.transferInfo = null;\n\t\t\t\t\tthis.dispatchEvent(new SceneEvent(SceneEvent.ascendComplete, this));\n\t\t\t\t}\n\t\t\t);\n\t\t\tcommand.execute();\n\t\t}\n\n\t\tpublic _descend(transferInfo:SceneTransferInfo):void {\n\t\t\tthis.transferInfo = transferInfo;\n\t\t\tthis.state = SceneState.descending;\n\t\t\tconst command:cmd.Serial = new cmd.Serial(\n\t\t\t\t():void => {\n\t\t\t\t\tthis.dispatchEvent(new SceneEvent(SceneEvent.descend, this));\n\t\t\t\t\tconst c:cmd.Command = typeof(this.onDescend) == 'function' ? this.onDescend() : this.implOnDescend();\n\t\t\t\t\tif (c) command.insertCommand(c);\n\t\t\t\t},\n\t\t\t\t():void => {\n\t\t\t\t\tthis.lastState = this.state;\n\t\t\t\t\tthis.state = SceneState.idling;\n\t\t\t\t\tthis.transferInfo = null;\n\t\t\t\t\tthis.dispatchEvent(new SceneEvent(SceneEvent.descendComplete, this));\n\t\t\t\t}\n\t\t\t);\n\t\t\tcommand.execute();\n\t\t}\n\n\n\n\n\n\t\tprotected implOnLoad():cmd.Command {\n\t\t\treturn new cmd.Command();\n\t\t}\n\n\t\tprotected implOnUnload():cmd.Command {\n\t\t\treturn new cmd.Command();\n\t\t}\n\n\t\tprotected implOnArrive():cmd.Command {\n\t\t\treturn new cmd.Command();\n\t\t}\n\n\t\tprotected implOnLeave():cmd.Command {\n\t\t\treturn new cmd.Command();\n\t\t}\n\n\t\tprotected implOnAscend():cmd.Command {\n\t\t\treturn new cmd.Command();\n\t\t}\n\n\t\tprotected implOnDescend():cmd.Command {\n\t\t\treturn new cmd.Command();\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\t// The callback function is called preferentially over the override\n\t\tpublic onLoad:() => cmd.Command;\n\t\tpublic onUnload:() => cmd.Command;\n\t\tpublic onArrive:() => cmd.Command;\n\t\tpublic onLeave:() => cmd.Command;\n\t\tpublic onAscend:() => cmd.Command;\n\t\tpublic onDescend:() => cmd.Command;\n\n\t\tprivate name:string;\n\t\tprivate state:SceneState;\n\t\tprivate lastState:SceneState;\n\t\tprivate parent:Scene;\n\t\tprivate childrenByName:alm.util.Hash<Scene>;\n\t\tprivate numChildren:number;\n\t\tprivate transferInfo:SceneTransferInfo;\n\t}\n}\n","/// <reference path='../index.ts' />\n\nnamespace scn {\n\n\timport Event = alm.event.Event;\n\n\texport class SceneEvent extends Event<Scene> {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// EVENT\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic static readonly load:string = 'SceneEvent.load';\n\t\tpublic static readonly unload:string = 'SceneEvent.unload';\n\t\tpublic static readonly arrive:string = 'SceneEvent.arrive';\n\t\tpublic static readonly leave:string = 'SceneEvent.leave';\n\t\tpublic static readonly ascend:string = 'SceneEvent.ascend';\n\t\tpublic static readonly descend:string = 'SceneEvent.descend';\n\n\t\tpublic static readonly loadComplete:string = 'SceneEvent.loadComplete';\n\t\tpublic static readonly unloadComplete:string = 'SceneEvent.unloadComplete';\n\t\tpublic static readonly arriveComplete:string = 'SceneEvent.arriveComplete';\n\t\tpublic static readonly leaveComplete:string = 'SceneEvent.leaveComplete';\n\t\tpublic static readonly ascendComplete:string = 'SceneEvent.ascendComplete';\n\t\tpublic static readonly descendComplete:string = 'SceneEvent.descendComplete';\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(eventType:string, eventTarget:Scene) {\n\t\t\tsuper(eventType, eventTarget);\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic clone():SceneEvent {\n\t\t\treturn new SceneEvent(this.type, this.target);\n\t\t}\n\n\t\tpublic toString():string {\n\t\t\treturn '[SceneEvent] type = ' + this.type;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\t}\n}\n","/// <reference path='../index.ts' />\n\nnamespace scn {\n\n\texport class SceneTransferInfo {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(transferId:number, departurePath:string, destinationPath:string, message:any = null) {\n\t\t\tthis.transferId = transferId;\n\t\t\tthis.departurePath = departurePath;\n\t\t\tthis.destinationPath = destinationPath;\n\t\t\tthis.message = message;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic getTransferId():number {\n\t\t\treturn this.transferId;\n\t\t}\n\n\t\tpublic getDeparturePath():string {\n\t\t\treturn this.departurePath;\n\t\t}\n\n\t\tpublic getDestinationPath():string {\n\t\t\treturn this.destinationPath;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic message:any;\n\n\t\tprivate transferId:number;\n\t\tprivate departurePath:string;\n\t\tprivate destinationPath:string;\n\t}\n}\n","/// <reference path='../index.ts' />\n\nnamespace scn {\n\n\texport enum SceneState {\n\t\tidling,\n\t\tloading,\n\t\tunloading,\n\t\tarriving,\n\t\tleaving,\n\t\tascending,\n\t\tdescending,\n\t}\n\n\texport function getSceneStateString(state:SceneState):string {\n\t\tswitch (state) {\n\t\t\tcase SceneState.idling:\n\t\t\t\treturn 'idling';\n\t\t\tcase SceneState.loading:\n\t\t\t\treturn 'loading';\n\t\t\tcase SceneState.unloading:\n\t\t\t\treturn 'unloading';\n\t\t\tcase SceneState.arriving:\n\t\t\t\treturn 'arriving';\n\t\t\tcase SceneState.leaving:\n\t\t\t\treturn 'leaving';\n\t\t\tcase SceneState.ascending:\n\t\t\t\treturn 'ascending';\n\t\t\tcase SceneState.descending:\n\t\t\t\treturn 'descending';\n\t\t}\n\t\treturn '';\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace scn.core {\n\n\texport enum Direction {\n\t\tStatic,\n\t\tSibling,\n\t\tAscend,\n\t\tDescend,\n\t}\n\n\texport function getDirectionString(direction:Direction):string {\n\t\tswitch (direction) {\n\t\t\tcase Direction.Static:\n\t\t\t\treturn 'static';\n\t\t\tcase Direction.Sibling:\n\t\t\t\treturn 'sibling';\n\t\t\tcase Direction.Ascend:\n\t\t\t\treturn 'ascend';\n\t\t\tcase Direction.Descend:\n\t\t\t\treturn 'descend';\n\t\t}\n\t\treturn '';\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace scn.core {\n\n\texport class Waypoint {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(path:string, level:number) {\n\t\t\tthis.path = path;\n\t\t\tthis.level = level;\n\t\t\tthis.from = Direction.Static;\n\t\t\tthis.to = Direction.Static;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic getPath():string {\n\t\t\treturn this.path;\n\t\t}\n\n\t\tpublic getLevel():number {\n\t\t\treturn this.level;\n\t\t}\n\n\t\tpublic getFrom():Direction {\n\t\t\treturn this.from;\n\t\t}\n\n\t\tpublic getTo():Direction {\n\t\t\treturn this.to;\n\t\t}\n\n\t\tpublic _setFrom(from:Direction):void {\n\t\t\tthis.from = from;\n\t\t}\n\n\t\tpublic _setTo(to:Direction):void {\n\t\t\tthis.to = to;\n\t\t}\n\n\t\tpublic toString():string {\n\t\t\treturn '[Waypoint] path = \\'' + this.path + '\\', level = ' + this.level + ', from = ' + getDirectionString(this.from) + ', to = ' + getDirectionString(this.to);\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprivate path:string;\n\t\tprivate level:number;\n\t\tprivate from:Direction;\n\t\tprivate to:Direction;\n\t}\n}\n","/// <reference path='../../index.ts' />\n\nnamespace scn.core {\n\n\texport class RootScene extends Scene {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(manager:SceneManager) {\n\t\t\tsuper('');\n\t\t\tthis.manager = manager;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic getManager():SceneManager {\n\t\t\treturn this.manager;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprivate manager:SceneManager;\n\t}\n}\n","/// <reference path='../index.ts' />\n\nnamespace scn {\n\n\timport Logger = alm.debug.Logger;\n\timport LoggerLevel = alm.debug.LoggerLevel;\n\timport EventDispatcher = alm.event.EventDispatcher;\n\timport Obj = alm.util.Obj;\n\timport RootScene = scn.core.RootScene;\n\n\texport class SceneManager extends EventDispatcher {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(name:string = '', rootSceneClass:(new (sceneManager:SceneManager) => RootScene) = RootScene) {\n\t\t\tsuper();\n\t\t\tthis.name = name;\n\t\t\tthis.root = new rootSceneClass(this);\n\t\t\tthis.currentScene = null;\n\n\t\t\tthis.waypoints = [];\n\t\t\tthis.waypointIndex = -1;\n\t\t\tthis.lastState = SceneState.idling;\n\t\t\tthis.eventIndex = -1;\n\t\t\tthis.transferId = -1;\n\t\t\tthis.transferInfo = null;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic start(message:any = null):void {\n\t\t\tLogger.verbose('----- scene manager start -----');\n\t\t\tthis.goto('/', message);\n\t\t}\n\n\t\tpublic goto(path:string, message:any = null):void {\n\t\t\tpath = this.resolvePath(path);\n\n\t\t\t// Return if current destination and new destination is same.\n\t\t\tif (this.transferInfo && this.transferInfo.getDestinationPath() == path) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Build waypoints\n\t\t\tlet newWaypoints:core.Waypoint[] = [];\n\t\t\tif (this.waypointIndex != -1) {\n\t\t\t\tnewWaypoints = this.createWaypoints(this.waypoints[this.waypointIndex].getPath(), path);\n\t\t\t} else {\n\t\t\t\t// Init\n\t\t\t\tnewWaypoints = [new core.Waypoint('/', 0)];\n\t\t\t}\n\n\t\t\t// Transfer\n\t\t\tif (newWaypoints.length > 0) {\n\t\t\t\tconst isDestinationChanged:boolean = this.transferInfo != null;\n\n\t\t\t\tif (!isDestinationChanged) {\n\t\t\t\t\tthis.waypointIndex = 0;\n\t\t\t\t\tthis.eventIndex = 0;\n\t\t\t\t\t++this.transferId;\n\t\t\t\t\tthis.waypoints = newWaypoints;\n\t\t\t\t} else {\n\t\t\t\t\tLogger.verbose('destination is changed');\n\t\t\t\t\tLogger.verbose('waypoint index : ' + this.waypointIndex);\n\t\t\t\t\tthis.waypoints = this.waypoints.slice(0, this.waypointIndex + 1).concat(newWaypoints.slice(1));\n\t\t\t\t\tthis.setDirection(this.waypoints);\n\t\t\t\t\tthis.dumpWaypoint(this.waypoints);\n\t\t\t\t}\n\n\t\t\t\tthis.transferInfo = new SceneTransferInfo(this.transferId, this.waypoints[this.waypointIndex].getPath(), this.waypoints[this.waypoints.length - 1].getPath(), message);\n\n\t\t\t\tif (!isDestinationChanged) {\n\t\t\t\t\tthis.dispatchEvent(new SceneManagerTransferEvent(SceneManagerTransferEvent.transferStart, this, this.transferInfo));\n\t\t\t\t}\n\n\t\t\t\tthis.checkState();\n\t\t\t}\n\t\t}\n\n\t\tpublic resolvePath(path:string):string {\n\t\t\t// Relative to absolute\n\t\t\tif (path[0] != '/') {\n\t\t\t\tif (this.currentScene) {\n\t\t\t\t\tpath = this.currentScene.getPath() + '/' + path;\n\t\t\t\t} else {\n\t\t\t\t\tpath = '/' + path;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Normalize\n\t\t\tconst names:string[] = path.split('/');\n\t\t\tconst normalized:string[] = [];\n\t\t\tfor (let i:number = 0; i < names.length; ++i) {\n\t\t\t\tconst name:string = names[i];\n\t\t\t\tif (name == '') continue;\n\t\t\t\tif (name == '.') continue;\n\t\t\t\tif (name == '..') {\n\t\t\t\t\tnormalized.pop();\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tnormalized.push(name);\n\t\t\t}\n\n\t\t\treturn '/' + normalized.join('/');\n\t\t}\n\n\t\tpublic addSceneAt(path:string):Scene {\n\t\t\tlet success:boolean = false;\n\t\t\tconst names:string[] = this.getSceneNamesByPath(path);\n\t\t\tconst n:number = names.length;\n\t\t\tlet scene:Scene = this.root;\n\t\t\tfor (let i:number = 1; i < n; ++i) {\n\t\t\t\tconst name:string = names[i];\n\t\t\t\tif (i == n - 1) {\n\t\t\t\t\tif (scene.contains(name)) {\n\t\t\t\t\t\tLogger.warn('[SceneManager \\'' + this.name + '\\'] addSceneAt was failed, because path \\'' + path + '\\' is already exist.');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tscene = scene.addChild(new Scene(name));\n\t\t\t\t\t\tsuccess = true;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (scene.contains(name)) {\n\t\t\t\t\t\tscene = scene.getChildByName(name);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tscene = scene.addChild(new Scene(name));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn success ? scene : null;\n\t\t}\n\n\t\tpublic getName():string {\n\t\t\treturn this.name;\n\t\t}\n\n\t\tpublic getRoot():Scene {\n\t\t\treturn this.root;\n\t\t}\n\n\t\tpublic getSceneByPath(path:string):Scene {\n\t\t\treturn this.getSceneBySceneNames(this.getSceneNamesByPath(path));\n\t\t}\n\n\t\tpublic getParentSceneByPath(path:string):Scene {\n\t\t\tconst names:string[] = this.getSceneNamesByPath(path);\n\t\t\tnames.pop();\n\t\t\treturn this.getSceneBySceneNames(names);\n\t\t}\n\n\t\tprivate getSceneBySceneNames(names:string[]):Scene {\n\t\t\tconst n:number = names.length;\n\t\t\tlet scene:Scene = this.root;\n\t\t\tfor (let i:number = 1; i < n; ++i) {\n\t\t\t\tscene = scene.getChildByName(names[i]);\n\t\t\t}\n\t\t\treturn scene;\n\t\t}\n\n\t\tpublic getSceneNamesByPath(path:string):string[] {\n\t\t\treturn path == '/' ? [''] : this.resolvePath(path).split('/');\n\t\t}\n\n\t\tpublic getSceneLevelByNames(names:string[]):number {\n\t\t\treturn names.length - 1;\n\t\t}\n\n\t\tpublic getScenePathByNames(names:string[]):string {\n\t\t\treturn names.length == 0 ? '/' : names.length == 1 ? ('/' + names[0]) : names.join('/');\n\t\t}\n\n\n\t\tprivate createWaypoints(departurePath:string, destinationPath:string):core.Waypoint[] {\n\t\t\tif (departurePath == destinationPath) {\n\t\t\t\tLogger.warn('[SceneManager] departure path and destination path is same, path = \\'' + departurePath + '\\'');\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tLogger.verbose('----- scene flow -----');\n\n\t\t\tconst waypoints:core.Waypoint[] = [\n\t\t\t\tnew core.Waypoint(departurePath, this.getSceneLevelByNames(this.getSceneNamesByPath(departurePath)))\n\t\t\t];\n\n\t\t\tconst departureNames:string[] = this.getSceneNamesByPath(departurePath);\n\t\t\tconst destinationNames:string[] = this.getSceneNamesByPath(destinationPath);\n\n\t\t\tLogger.verbose('    path');\n\t\t\tLogger.verbose('        current    : \\'' + departurePath + '\\'');\n\t\t\tLogger.verbose('        destination: \\'' + destinationPath + '\\'');\n\n\t\t\tLogger.verbose('    names');\n\t\t\tLogger.verbose('        current(' + departureNames.length + ')    : \\'' + departureNames + '\\'');\n\t\t\tLogger.verbose('        destination(' + destinationNames.length + '): \\'' + destinationNames + '\\'');\n\n\t\t\t// \n\t\t\tlet turningLevel:number = 0;\n\t\t\tlet turningNames:string[] = [];\n\t\t\tlet turningPath:string;\n\t\t\tif (destinationPath == '/') {\n\t\t\t\tturningLevel = -1;\n\t\t\t\tturningNames = [];\n\t\t\t\tturningPath = '/';\n\t\t\t} else {\n\t\t\t\twhile (true) {\n\t\t\t\t\tif (departureNames[turningLevel] == destinationNames[turningLevel]) {\n\t\t\t\t\t\tturningNames.push(departureNames[turningLevel]);\n\t\t\t\t\t\t++turningLevel;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t--turningLevel;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tturningPath = this.getScenePathByNames(turningNames);\n\t\t\t}\n\n\t\t\tLogger.verbose('    turning');\n\t\t\tLogger.verbose('        path     : ' + turningPath);\n\t\t\tLogger.verbose('        level    : ' + turningLevel);\n\t\t\tLogger.verbose('        names(' + turningNames.length + ') : \\'' + turningNames + '\\'');\n\n\t\t\t// \n\t\t\t{\n\t\t\t\tconst names:string[] = departureNames.concat();\n\t\t\t\tlet prevPath:string = departurePath;\n\t\t\t\tfor (let i:number = departureNames.length - 1; i > turningLevel + 1; --i) {\n\t\t\t\t\tnames.pop();\n\t\t\t\t\tconst path:string = this.getScenePathByNames(names);\n\t\t\t\t\tif (path != prevPath) {\n\t\t\t\t\t\tconst level:number = this.getSceneLevelByNames(names);\n\t\t\t\t\t\twaypoints.push(new core.Waypoint(path, level));\n\t\t\t\t\t\tprevPath = path;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (turningPath == destinationPath && turningLevel > 0) {\n\t\t\t\t// \n\t\t\t\tconst from:core.Direction = turningLevel == waypoints[waypoints.length - 1].getLevel() ? core.Direction.Sibling : core.Direction.Ascend;\n\t\t\t\twaypoints.push(new core.Waypoint(turningPath, turningLevel));\n\t\t\t} else {\n\n\t\t\t\t// \n\t\t\t\tconst names:string[] = turningNames.concat();\n\t\t\t\tconst prev:core.Waypoint = waypoints[waypoints.length - 1];\n\t\t\t\tlet prevPath:string = prev.getPath();\n\t\t\t\tlet prevLevel:number = prev.getLevel();\n\t\t\t\tfor (let i:number = turningLevel + 1; i < destinationNames.length; ++i) {\n\t\t\t\t\tconst name:string = destinationNames[i];\n\t\t\t\t\tnames.push(name);\n\t\t\t\t\tconst path:string = this.getScenePathByNames(names);\n\t\t\t\t\tif (path != prevPath) {\n\t\t\t\t\t\tconst level:number = this.getSceneLevelByNames(names);\n\t\t\t\t\t\twaypoints.push(new core.Waypoint(path, level));\n\t\t\t\t\t\tprevLevel = level;\n\t\t\t\t\t\tprevPath = path;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// \n\t\t\tthis.setDirection(waypoints);\n\n\t\t\tif (Logger.level <= LoggerLevel.verbose) {\n\t\t\t\tthis.dumpWaypoint(waypoints);\n\t\t\t}\n\n\t\t\treturn waypoints;\n\t\t}\n\n\t\tprivate setDirection(waypoints:core.Waypoint[]):void {\n\t\t\tconst n:number = waypoints.length;\n\t\t\tlet prev:core.Waypoint = null;\n\t\t\tlet point:core.Waypoint;\n\t\t\tfor (let i:number = 0; i < n; ++i) {\n\t\t\t\tpoint = waypoints[i];\n\t\t\t\tif (i > 0) {\n\t\t\t\t\tconst d:number = point.getLevel() - prev.getLevel();\n\t\t\t\t\tpoint._setFrom(d > 0 ? core.Direction.Descend : d < 0 ? core.Direction.Ascend : core.Direction.Sibling);\n\t\t\t\t\tprev._setTo(point.getFrom());\n\t\t\t\t}\n\t\t\t\tprev = point;\n\t\t\t}\n\t\t}\n\n\t\tprivate dumpWaypoint(waypoints:core.Waypoint[]):void {\n\t\t\tLogger.verbose('    waypoints');\n\t\t\tconst n:number = waypoints.length;\n\t\t\tfor (let i:number = 0; i < n; ++i) {\n\t\t\t\tLogger.verbose('        [' + i + '] ' + waypoints[i]);\n\t\t\t}\n\t\t\tLogger.verbose('');\n\t\t}\n\n\t\tpublic dumpAllPath():void {\n\t\t\tLogger.info('----- scene all path -----');\n\t\t\tthis._dumpAllPath(this.root);\n\t\t}\n\n\t\tprivate _dumpAllPath(parent:Scene):void {\n\t\t\tconst children = parent.getChildrenByName();\n\t\t\tObj.each(children, (name:string, child:Scene):void => {\n\t\t\t\tLogger.info(child.getPath());\n\t\t\t\tthis._dumpAllPath(child);\n\t\t\t});\n\t\t}\n\n\n\n\n\n\t\tprivate checkState():void {\n\t\t\t//trace('lastState : ' + scn.getSceneStateString(this.lastState));\n\n\t\t\t//trace(this.waypointIndex + ' / ' + this.waypoints.length);\n\n\t\t\tif (this.waypointIndex >= this.waypoints.length) {\n\t\t\t\tLogger.verbose('----- scene transfer complete -----');\n\t\t\t\tconst tmpTransferId:number = this.transferInfo.getTransferId();\n\t\t\t\tthis.waypointIndex = this.waypoints.length - 1;\n\t\t\t\tthis.dispatchEvent(new SceneManagerTransferEvent(SceneManagerTransferEvent.transferComplete, this, this.transferInfo));\n\t\t\t\tif (tmpTransferId == this.transferInfo.getTransferId()) {\n\t\t\t\t\tthis.lastState = SceneState.idling;\n\t\t\t\t\tthis.transferInfo = null;\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.currentScene) {\n\t\t\t\tconst currentWaypoint:core.Waypoint = this.waypoints[this.waypointIndex];\n\t\t\t\tconst currentWaypointPath = currentWaypoint.getPath();\n\t\t\t\tthis.currentScene = this.getSceneByPath(currentWaypointPath);\n\n\t\t\t\tif (!this.currentScene) {\n\t\t\t\t\tthis.dispatchEvent(new SceneManagerRequireSceneEvent(SceneManagerRequireSceneEvent.requireScene, this, currentWaypointPath));\n\t\t\t\t\tthis.currentScene = this.getSceneByPath(currentWaypointPath);\n\t\t\t\t}\n\t\t\t\tif (!this.currentScene) {\n\t\t\t\t\tLogger.warn('[SceneManager] scene is null : scene path =', currentWaypointPath);\n\t\t\t\t}\n\n\t\t\t\t// Departure scene\n\t\t\t\tif (this.waypoints.length > 1 && this.waypointIndex == 0) {\n\t\t\t\t\t//trace('Departure scene');\n\n\t\t\t\t\t// Leave\n\t\t\t\t\tif (this.lastState != SceneState.leaving && this.currentScene.getLastState() == SceneState.arriving) {\n\t\t\t\t\t\tLogger.verbose(this.eventIndex + ' Leave   : \\'' + this.currentScene.getPath() + '\\'');\n\t\t\t\t\t\tthis.currentScene.addEventListener(SceneEvent.leaveComplete, this.sceneLeaveCompleteHandler);\n\t\t\t\t\t\tthis.currentScene._leave(this.transferInfo);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Unload\n\t\t\t\t\tif (this.lastState != SceneState.unloading && (currentWaypoint.getTo() == core.Direction.Sibling || currentWaypoint.getTo() == core.Direction.Ascend)) {\n\t\t\t\t\t\t++this.waypointIndex;\n\t\t\t\t\t\tLogger.verbose(this.eventIndex + ' Unload  : \\'' + this.currentScene.getPath() + '\\'');\n\t\t\t\t\t\tthis.currentScene.addEventListener(SceneEvent.unloadComplete, this.sceneUnloadCompleteHandler);\n\t\t\t\t\t\tthis.currentScene._unload(this.transferInfo);\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Departure to child\n\t\t\t\t\t\t++this.waypointIndex;\n\t\t\t\t\t\tthis.checkState();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Through scene\n\t\t\t\tif (this.waypointIndex > 0 && this.waypointIndex < this.waypoints.length - 1) {\n\t\t\t\t\t//trace('Through scene');\n\n\t\t\t\t\t// Load\n\t\t\t\t\tif (this.lastState != SceneState.loading && (currentWaypoint.getFrom() == core.Direction.Sibling || currentWaypoint.getFrom() == core.Direction.Descend)) {\n\t\t\t\t\t\tLogger.verbose(this.eventIndex + ' Load    : \\'' + this.currentScene.getPath() + '\\'');\n\t\t\t\t\t\tthis.currentScene.addEventListener(SceneEvent.loadComplete, this.sceneLoadCompleteHandler);\n\t\t\t\t\t\tthis.currentScene._load(this.transferInfo);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Ascend\n\t\t\t\t\tif (this.lastState != SceneState.ascending && currentWaypoint.getFrom() == core.Direction.Ascend) {\n\t\t\t\t\t\tLogger.verbose(this.eventIndex + ' Ascend  : \\'' + this.currentScene.getPath() + '\\'');\n\t\t\t\t\t\tthis.currentScene.addEventListener(SceneEvent.ascendComplete, this.sceneAscendCompleteHandler);\n\t\t\t\t\t\tthis.currentScene._ascend(this.transferInfo);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Unload\n\t\t\t\t\tif (this.lastState != SceneState.unloading && (currentWaypoint.getTo() == core.Direction.Sibling || currentWaypoint.getTo() == core.Direction.Ascend)) {\n\t\t\t\t\t\t++this.waypointIndex;\n\t\t\t\t\t\tLogger.verbose(this.eventIndex + ' Unload  : \\'' + this.currentScene.getPath() + '\\'');\n\t\t\t\t\t\tthis.currentScene.addEventListener(SceneEvent.unloadComplete, this.sceneUnloadCompleteHandler);\n\t\t\t\t\t\tthis.currentScene._unload(this.transferInfo);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Descend\n\t\t\t\t\tif (this.lastState != SceneState.descending && currentWaypoint.getTo() == core.Direction.Descend) {\n\t\t\t\t\t\t++this.waypointIndex;\n\t\t\t\t\t\tLogger.verbose(this.eventIndex + ' Descend : \\'' + this.currentScene.getPath() + '\\'');\n\t\t\t\t\t\tthis.currentScene.addEventListener(SceneEvent.descendComplete, this.sceneDescendCompleteHandler);\n\t\t\t\t\t\tthis.currentScene._descend(this.transferInfo);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Destination scene\n\t\t\t\tif (this.waypointIndex == this.waypoints.length - 1) {\n\t\t\t\t\t//trace('Destination scene');\n\n\t\t\t\t\t// Load\n\t\t\t\t\tif (this.lastState != SceneState.loading && (currentWaypoint.getFrom() == core.Direction.Sibling || currentWaypoint.getFrom() == core.Direction.Descend)) {\n\t\t\t\t\t\tLogger.verbose(this.eventIndex + ' Load    : \\'' + this.currentScene.getPath() + '\\'');\n\t\t\t\t\t\tthis.currentScene.addEventListener(SceneEvent.loadComplete, this.sceneLoadCompleteHandler);\n\t\t\t\t\t\tthis.currentScene._load(this.transferInfo);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Arrive\n\t\t\t\t\tif (this.lastState != SceneState.arriving) {\n\t\t\t\t\t\t++this.waypointIndex;\n\t\t\t\t\t\tLogger.verbose(this.eventIndex + ' Arrive  : \\'' + this.currentScene.getPath() + '\\'');\n\t\t\t\t\t\tthis.currentScene.addEventListener(SceneEvent.arriveComplete, this.sceneArriveCompleteHandler);\n\t\t\t\t\t\tthis.currentScene._arrive(this.transferInfo);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\t//trace('Init scene');\n\n\t\t\t\t// Init\n\t\t\t\tthis.lastState = SceneState.idling;\n\t\t\t\tthis.currentScene = this.root;\n\t\t\t\tLogger.verbose(this.eventIndex + ' Load    : \\'' + this.currentScene.getPath() + '\\'');\n\t\t\t\tthis.currentScene.addEventListener(SceneEvent.loadComplete, this.sceneLoadCompleteHandler);\n\t\t\t\tthis.currentScene._load(this.transferInfo);\n\t\t\t}\n\t\t}\n\n\t\tprivate sceneLoadCompleteHandler = (event:SceneEvent):void => {\n\t\t\tthis.currentScene.removeEventListener(SceneEvent.loadComplete, this.sceneLoadCompleteHandler);\n\t\t\tthis.lastState = SceneState.loading;\n\t\t\t++this.eventIndex;\n\t\t\tthis.checkState();\n\t\t};\n\n\t\tprivate sceneUnloadCompleteHandler = (event:SceneEvent):void => {\n\t\t\tthis.currentScene.removeEventListener(SceneEvent.unloadComplete, this.sceneUnloadCompleteHandler);\n\t\t\tthis.lastState = SceneState.unloading;\n\t\t\t++this.eventIndex;\n\t\t\tthis.checkState();\n\t\t};\n\n\t\tprivate sceneArriveCompleteHandler = (event:SceneEvent):void => {\n\t\t\tthis.currentScene.removeEventListener(SceneEvent.arriveComplete, this.sceneArriveCompleteHandler);\n\t\t\tthis.lastState = SceneState.arriving;\n\t\t\t++this.eventIndex;\n\t\t\tthis.checkState();\n\t\t};\n\n\t\tprivate sceneLeaveCompleteHandler = (event:SceneEvent):void => {\n\t\t\tthis.currentScene.removeEventListener(SceneEvent.leaveComplete, this.sceneLeaveCompleteHandler);\n\t\t\tthis.lastState = SceneState.leaving;\n\t\t\t++this.eventIndex;\n\t\t\tthis.checkState();\n\t\t};\n\n\t\tprivate sceneAscendCompleteHandler = (event:SceneEvent):void => {\n\t\t\tthis.currentScene.removeEventListener(SceneEvent.ascendComplete, this.sceneAscendCompleteHandler);\n\t\t\tthis.lastState = SceneState.ascending;\n\t\t\t++this.eventIndex;\n\t\t\tthis.checkState();\n\t\t};\n\n\t\tprivate sceneDescendCompleteHandler = (event:SceneEvent):void => {\n\t\t\tthis.currentScene.removeEventListener(SceneEvent.descendComplete, this.sceneDescendCompleteHandler);\n\t\t\tthis.lastState = SceneState.descending;\n\t\t\t++this.eventIndex;\n\t\t\tthis.checkState();\n\t\t};\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tprivate name:string;\n\t\tprivate root:Scene;\n\t\tprivate currentScene:Scene;\n\n\t\tprivate waypoints:core.Waypoint[];\n\t\tprivate waypointIndex:number;\n\t\tprivate lastState:SceneState;\n\t\tprivate eventIndex:number;\n\t\tprivate transferInfo:SceneTransferInfo;\n\t\tprivate transferId:number;\n\t}\n}\n","/// <reference path='../index.ts' />\n\nnamespace scn {\n\n\timport Event = alm.event.Event;\n\n\texport class SceneManagerTransferEvent extends Event<SceneManager> {\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// EVENT\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic static readonly transferStart:string = 'SceneManagerTransferEvent.transferStart';\n\t\tpublic static readonly transferComplete:string = 'SceneManagerTransferEvent.transferComplete';\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// CONSTRUCTOR\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tconstructor(eventType:string, eventTarget:SceneManager, transferInfo:SceneTransferInfo) {\n\t\t\tsuper(eventType, eventTarget);\n\t\t\tthis.transferInfo = transferInfo;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// METHOD\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic clone():SceneManagerTransferEvent {\n\t\t\treturn new SceneManagerTransferEvent(this.type, this.target, this.transferInfo);\n\t\t}\n\n\t\tpublic toString():string {\n\t\t\treturn '[SceneManagerTransferEvent] type = ' + this.type;\n\t\t}\n\n\n\n\n\n\t\t// --------------------------------------------------\n\t\t//\n\t\t// MEMBER\n\t\t//\n\t\t// --------------------------------------------------\n\n\t\tpublic readonly transferInfo:SceneTransferInfo;\n\t}\n}\n"]}