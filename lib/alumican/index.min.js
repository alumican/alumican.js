var cmd,scn,alm,__extends=this&&this.__extends||function(){var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),__spreadArrays=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),o=0,e=0;e<n;e++)for(var r=arguments[e],s=0,a=r.length;s<a;s++,o++)i[o]=r[s];return i};function trace(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];alm.debug.Logger.info.apply(trace.caller,arguments)}function throwWarn(t,e,n){void 0===n&&(n=!0),alm.debug.Logger.warnIf.apply(null,arguments)}function throwError(t,e,n){void 0===n&&(n=!0),alm.debug.Logger.errorIf.apply(null,arguments)}!function(t){var e,n;function i(){}e=t.util||(t.util={}),i.now=function(){return(window.performance||Date).now()},n=i,e.Time=n}(alm=alm||{}),function(t){var e,n;function i(){}e=t.math||(t.math={}),i.linear=function(t){return t},i.easeInQuad=function(t){return(t/=1)*t},i.easeOutQuad=function(t){return-(t/=1)*(t-2)},i.easeInOutQuad=function(t){return(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1)},i.easeInCubic=function(t){return(t/=1)*t*t},i.easeOutCubic=function(t){return--t*t*t+1},i.easeInOutCubic=function(t){return(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},i.easeInQuart=function(t){return(t/=1)*t*t*t},i.easeOutQuart=function(t){return-(--t*t*t*t-1)},i.easeInOutQuart=function(t){return(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},i.easeInQuint=function(t){return(t/=1)*t*t*t*t},i.easeOutQuint=function(t){return--t*t*t*t*t+1},i.easeInOutQuint=function(t){return(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},i.easeInSine=function(t){return 1-Math.cos(t*(Math.PI/2))},i.easeOutSine=function(t){return Math.sin(t*(Math.PI/2))},i.easeInOutSine=function(t){return-.5*(Math.cos(Math.PI*t)-1)},i.easeInExpo=function(t){return 0==t?0:Math.pow(2,10*(t-1))},i.easeOutExpo=function(t){return 1==t?1:1-Math.pow(2,-10*t)},i.easeInOutExpo=function(t){return 0==t?0:1==t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*--t))},i.easeInCirc=function(t){return-(Math.sqrt(1-(t/=1)*t)-1)},i.easeOutCirc=function(t){return Math.sqrt(1- --t*t)},i.easeInOutCirc=function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},i.createEaseInElastic=function(i){return void 0===i&&(i=1.70158),function(t){var e=0,n=1;return 0==t?0:1==(t/=1)?1:(0==e&&(e=.3),i=n<1?(n=1,e/4):e/(2*Math.PI)*Math.asin(1/n),-n*Math.pow(2,10*--t)*Math.sin((t-i)*(2*Math.PI)/e))}},i.createEaseOutElastic=function(i){return void 0===i&&(i=1.70158),function(t){var e=0,n=1;return 0==t?0:1==(t/=1)?1:(0==e&&(e=.3),i=n<1?(n=1,e/4):e/(2*Math.PI)*Math.asin(1/n),n*Math.pow(2,-10*t)*Math.sin((t-i)*(2*Math.PI)/e)+1)}},i.createEaseInOutElastic=function(i){return void 0===i&&(i=1.70158),function(t){var e=0,n=1;return 0==t?0:2==(t/=.5)?1:(0==e&&(e=.3*1.5),i=n<1?(n=1,e/4):e/(2*Math.PI)*Math.asin(1/n),t<1?-.5*n*Math.pow(2,10*--t)*Math.sin((t-i)*(2*Math.PI)/e):n*Math.pow(2,-10*--t)*Math.sin((t-i)*(2*Math.PI)/e)*.5+1)}},i.easeInElastic=function(t){return i.defaultEaseInElastic(t)},i.easeOutElastic=function(t){return i.defaultEaseOutElastic(t)},i.easeInOutElastic=function(t){return i.defaultEaseInOutElastic(t)},i.createEaseInBack=function(e){return void 0===e&&(e=1.70158),function(t){return(t/=1)*t*((e+1)*t-e)}},i.createEaseOutBack=function(e){return void 0===e&&(e=1.70158),function(t){return--t*t*((e+1)*t+e)+1}},i.createEaseInOutBack=function(e){return void 0===e&&(e=1.70158),function(t){return(t/=.5)<1?.5*t*t*((1+(e*=1.525))*t-e):.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)}},i.easeInBack=function(t){return i.defaultEaseInElastic(t)},i.easeOutBack=function(t){return i.defaultEaseOutBack(t)},i.easeInOutBack=function(t){return i.defaultEaseInOutBack(t)},i.easeInBounce=function(t){return 1-i.easeOutBounce(1-t)},i.easeOutBounce=function(t){return(t/=1)<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},i.easeInOutBounce=function(t){return t<.5?.5*i.easeInBounce(2*t):.5*i.easeOutBounce(2*t-1)+.5},i.defaultEaseInElastic=i.createEaseInElastic(),i.defaultEaseOutElastic=i.createEaseOutElastic(),i.defaultEaseInOutElastic=i.createEaseInOutElastic(),i.defaultEaseInBack=i.createEaseInBack(),i.defaultEaseOutBack=i.createEaseOutBack(),i.defaultEaseInOutBack=i.createEaseInOutBack(),n=i,e.Easing=n}(alm=alm||{}),function(t){var e,n;function i(t){void 0===t&&(t=""),this.set(t)}e=t.browser||(t.browser={}),i.prototype.set=function(t){void 0===t&&(t="");var e,n="";""!=t?-1!=(e=t.indexOf("?"))&&(n=t.substring(e)):n=location.search,this.hash={};for(var i,o=n.substring(1).split("&"),r=0;o[r];++r)i=o[r].split("="),this.hash[i[0]]=i[1]},i.prototype.getString=function(t,e){var n=this.hash[t];return void 0===n?e:n},i.prototype.getInt=function(t,e){var n=parseInt(this.hash[t]);return isNaN(n)?e:n},i.prototype.getFloat=function(t,e){var n=parseFloat(this.hash[t]);return isNaN(n)?e:n},i.prototype.getBool=function(t,e){var n=this.hash[t];return void 0===n?e:1==n},i.prototype.getHash=function(){return this.hash},i.prototype.setHash=function(t){this.hash=t},i.prototype.setParam=function(t,e){this.hash[t]=e},i.prototype.removeParam=function(t){delete this.hash[t]},i.prototype.hasParam=function(t){return void 0!==this.hash[t]},n=i,e.QueryString=n}(alm=alm||{}),function(v){!function(t){var i,e,n=v.browser.QueryString;(e=i=t.LoggerLevel||(t.LoggerLevel={}))[e.Verbose=0]="Verbose",e[e.Info=1]="Info",e[e.Warn=2]="Warn",e[e.Error=3]="Error",e[e.Silent=4]="Silent";var o=(r.prototype.verbose=function(t,e){},r.prototype.info=function(t,e){},r.prototype.warn=function(t,e){},r.prototype.error=function(t,e){},r);function r(){}t.NullLogging=o;var s=(a.prototype.verbose=function(t,e){console.debug.apply(console,Array.prototype.slice.call([t].concat(e)))},a.prototype.info=function(t,e){console.log.apply(console,Array.prototype.slice.call([t].concat(e)))},a.prototype.warn=function(t,e){console.warn.apply(console,Array.prototype.slice.call([t].concat(e)))},a.prototype.error=function(t,e){console.error.apply(console,Array.prototype.slice.call([t].concat(e)))},a);function a(){}t.ConsoleLogging=s;var u=(h.prototype.verbose=function(t,e){this.print(t,e)},h.prototype.info=function(t,e){this.print(t,e)},h.prototype.warn=function(t,e){this.print(t,e)},h.prototype.error=function(t,e){this.print(t,e)},h.prototype.print=function(t,e){var n=t+e.join(", ");this.html?this.dom.innerHTML=n+"<br>\n"+this.dom.innerHTML:this.dom.innerText=n+"\n"+this.dom.innerText},h);function h(t,e){this.dom=t,this.html=e}t.DOMLogging=u;var c=(l.prototype.verbose=function(t,e){for(var n=this.loggers.length,i=0;i<n;++i)this.loggers[i].verbose(t,e)},l.prototype.info=function(t,e){for(var n=this.loggers.length,i=0;i<n;++i)this.loggers[i].info(t,e)},l.prototype.warn=function(t,e){for(var n=this.loggers.length,i=0;i<n;++i)this.loggers[i].warn(t,e)},l.prototype.error=function(t,e){for(var n=this.loggers.length,i=0;i<n;++i)this.loggers[i].error(t,e)},l);function l(t){this.loggers=t}t.ParallelLogging=c;var d=(p.setLevelByQuery=function(t){var e=(new n).getInt(t,i.Silent);p.level=isNaN(e)?i.Silent:e},p.setNamespace=function(t){p.namespace=""!=t?t+"#":""},p.verbose=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];p.level<=i.Verbose&&p.logger.verbose("["+p.namespace+"Verbose] ",t)},p.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];p.level<=i.Info&&p.logger.info("["+p.namespace+"Info   ] ",t)},p.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];p.level<=i.Warn&&p.logger.warn("["+p.namespace+"Warn   ] ",t)},p.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];p.level<=i.Error&&p.logger.error("["+p.namespace+"Error  ] ",t)},p.warnIf=function(t,e,n){void 0===n&&(n=!0),p.level<=i.Warn&&n&&p.logger.warn("["+p.namespace+"Warn   ] ",[e+" : "+t])},p.errorIf=function(t,e,n){void 0===n&&(n=!0),p.level<=i.Error&&n&&p.logger.error("["+p.namespace+"Error  ] ",[e+" : "+t])},p.stackTrace=function(){console.trace()},p.level=i.Verbose,p.logger=new s,p.namespace="",p);function p(){}t.Logger=d}(v.debug||(v.debug={}))}(alm=alm||{}),function(t){var e,n,i;function o(){this.reset()}e=t.debug||(t.debug={}),n=t.util.Time,o.prototype.reset=function(){this.frameRate=0,this.frameCount=0,this.startTime=n.now(),this.actualFrameRate=-1,this.dummyFrameRate=-1},o.prototype.update=function(){++this.frameCount;var t=n.now(),e=t-this.startTime;1e3<=e&&(this.actualFrameRate=1e3*this.frameCount/e,this.frameCount=0,this.startTime=t,this.dummyFrameRate<0&&(this.frameRate=this.actualFrameRate))},o.prototype.setDummyFrameRate=function(t){this.dummyFrameRate=t,this.frameRate=this.dummyFrameRate},o.prototype.clearDummyFrameRate=function(){this.dummyFrameRate=-1,this.frameRate=this.actualFrameRate},o.prototype.getFrameRate=function(){return this.frameRate},i=o,e.FpsMonitor=i}(alm=alm||{}),function(t){function e(t,e,n){void 0===n&&(n=null),this.type=t,this.target=e,this.data=n}(t.event||(t.event={})).Event=e}(alm=alm||{}),function(t){var i,r,e;function n(t){void 0===t&&(t=null),this.target=t||this,this.listeners={}}i=t.event||(t.event={}),r=t.debug.Logger,n.prototype.addEventListener=function(t,e){if("function"==typeof e){var n=this.listeners[t];if(n){for(var i=n.length,o=0;o<i;++o)if(e==n[o])return}else this.listeners[t]=n=[];n.push(e)}else r.warn("[EventDispatcher] addEventListener : listener is not function, eventType = '"+t+"', listener = "+e)},n.prototype.removeEventListener=function(t,e){if("function"==typeof e){var n=this.listeners[t];if(n){for(var i=n.length,o=0;o<i;++o)if(e==n[o]){n.splice(o,1);break}0==n.length&&delete this.listeners[t]}}else r.warn("[EventDispatcher] removeEventListener : listener is not function, eventType = '"+t+"', listener = "+e)},n.prototype.removeAllEventListener=function(t){void 0===t&&(t=null),t?delete this.listeners[t]:this.listeners={}},n.prototype.hasEventListener=function(t){return null!=this.listeners[t]},n.prototype.dispatchEvent=function(t){var e=this.listeners[t.type];if(e)for(var n=e.length,i=0;i<n;++i)e[i].call(this.target,t)},n.prototype.dispatchEventType=function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=null),this.dispatchEvent(new i.Event(t,e,n))},e=n,i.EventDispatcher=e}(alm=alm||{}),function(t){var e;(e=t.CommandState||(t.CommandState={}))[e.Sleeping=0]="Sleeping",e[e.Executing=1]="Executing",e[e.Interrupting=2]="Interrupting"}(cmd=cmd||{}),function(t){var n,e=alm.event.Event,i=(__extends(o,n=e),o.prototype.clone=function(){return new o(this.type,this.target)},o.prototype.toString=function(){return"[CommandEvent] type = "+this.type},o.COMPLETE="complete",o);function o(t,e){return n.call(this,t,e)||this}t.CommandEvent=i}(cmd=cmd||{}),function(o){var r,t=alm.event.EventDispatcher,e=(__extends(n,r=t),n.prototype.execute=function(){if(this.state>o.CommandState.Sleeping)throw new Error("[Command.execute] + Command is already executing.");this.state=o.CommandState.Executing,this.getExecuteFunction().call(this,this)},n.prototype.interrupt=function(){this.state==o.CommandState.Executing&&(this.state=o.CommandState.Interrupting,this.getInterruptFunction().call(this,this))},n.prototype.destroy=function(){this.state=o.CommandState.Sleeping,this.getDestroyFunction().call(this,this),this.parent=null,this.executeFunction=null,this.interruptFunction=null,this.destroyFunction=null},n.prototype.notifyComplete=function(){switch(this.state){case o.CommandState.Sleeping:break;case o.CommandState.Executing:case o.CommandState.Interrupting:this.dispatchEvent(new o.CommandEvent(o.CommandEvent.COMPLETE,this)),this.destroy()}},n.prototype.implExecuteFunction=function(t){this.notifyComplete()},n.prototype.implInterruptFunction=function(t){},n.prototype.implDestroyFunction=function(t){},n.prototype.getExecuteFunction=function(){return this.executeFunction||this.implExecuteFunction},n.prototype.setExecuteFunction=function(t){this.executeFunction=t},n.prototype.getInterruptFunction=function(){return this.interruptFunction||this.implInterruptFunction},n.prototype.setInterruptFunction=function(t){this.interruptFunction=t},n.prototype.getDestroyFunction=function(){return this.destroyFunction||this.implDestroyFunction},n.prototype.setDestroyFunction=function(t){this.destroyFunction=t},n.prototype.getState=function(){return this.state},n.prototype.getParent=function(){return this.parent},n.prototype.setParent=function(t){this.parent=t},n.prototype.getSelf=function(){return this.self},n);function n(t,e,n){void 0===t&&(t=null),void 0===e&&(e=null),void 0===n&&(n=null);var i=r.call(this)||this;return i.setExecuteFunction(t),i.setInterruptFunction(e),i.setDestroyFunction(n),i.state=o.CommandState.Sleeping,(i.self=i).parent=null,i}o.Command=e}(cmd=cmd||{}),function(o){var i,t=(i=o.Command,__extends(e,i),e.prototype.addCommand=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];0<t.length&&(this.preProcess(t),this.commands=this.getCommands().concat(t))},e.prototype.insertCommand=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.insertCommandAt.apply(this,__spreadArrays([0],t))},e.prototype.insertCommandAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];0<e.length&&(this.preProcess(e),Array.prototype.splice.apply(this.getCommands(),[t,0].concat(e)))},e.prototype.addCommandArray=function(t){this.addCommand.apply(this,t)},e.prototype.insertCommandArray=function(t){this.insertCommand.apply(this,t)},e.prototype.insertCommandArrayAt=function(t,e){this.insertCommandAt.apply(this,__spreadArrays([t],e))},e.prototype.getLength=function(){return this.commands.length},e.prototype.getCommandByIndex=function(t){return this.commands[t]},e.prototype.getCommands=function(){return this.commands},e.prototype.preProcess=function(t){for(var e,n=t.length,i=0;i<n;++i)"function"==typeof(e=t[i])&&(t[i]=e=new o.Func(e)),e.setParent(this)},e.prototype.implExecuteFunction=function(t){this.notifyComplete()},e.prototype.implInterruptFunction=function(t){},e.prototype.implDestroyFunction=function(t){},e);function e(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=i.call(this)||this;return n.commands=[],n.addCommand.apply(n,t),n}o.CommandList=t}(cmd=cmd||{}),function(t){var e,n=(e=t.Command,__extends(i,e),i.prototype.implExecuteFunction=function(t){var e=this.getParent().notifyBreak;e&&e(),this.notifyComplete()},i.prototype.implInterruptFunction=function(t){},i.prototype.implDestroyFunction=function(t){},i);function i(){return e.call(this)||this}t.Break=n}(cmd=cmd||{}),function(t){var e,n=(e=t.Command,__extends(i,e),i.prototype.implExecuteFunction=function(t){var e=this.getParent().notifyReturn;e&&e(),this.notifyComplete()},i.prototype.implInterruptFunction=function(t){},i.prototype.implDestroyFunction=function(t){},i);function i(){return e.call(this)||this}t.Return=n}(cmd=cmd||{}),function(t){var i,e=(i=t.Command,__extends(n,i),n.prototype.implExecuteFunction=function(t){console.log.apply(console,Array.prototype.slice.call(this.messages)),this.notifyComplete()},n.prototype.implInterruptFunction=function(t){},n.prototype.implDestroyFunction=function(t){this.messages=null},n.prototype.getMessages=function(){return this.messages},n.prototype.setMessages=function(t){this.messages=t},n);function n(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=i.call(this)||this;return n.messages=t,n}t.Log=e}(cmd=cmd||{}),function(t){var n,e=(n=t.Command,__extends(i,n),i.prototype.implExecuteFunction=function(t){this.timerId=window.setTimeout(this.completeHandler,this.time)},i.prototype.implInterruptFunction=function(t){this.cancel()},i.prototype.implDestroyFunction=function(t){this.cancel()},i.prototype.cancel=function(){-1!=this.timerId&&(clearTimeout(this.timerId),this.timerId=-1)},i.prototype.getTime=function(){return this.time},i.prototype.setTime=function(t){this.time=t},i);function i(t){void 0===t&&(t=1e3);var e=n.call(this)||this;return e.completeHandler=function(){e.notifyComplete()},e.time=t,e.timerId=-1,e}t.Wait=e}(cmd=cmd||{}),function(t){var r,e=(r=t.Command,__extends(n,r),n.prototype.implExecuteFunction=function(t){this.eventDispatcher&&this.eventType?(this.eventDispatcher.addEventListener(this.eventType,this.completeHandler),this.func.apply(this,this.args)):(this.func.apply(this,this.args),this.notifyComplete())},n.prototype.implInterruptFunction=function(t){this.eventDispatcher&&this.eventType&&this.eventDispatcher.removeEventListener(this.eventType,this.completeHandler)},n.prototype.implDestroyFunction=function(t){this.eventDispatcher&&this.eventType&&this.eventDispatcher.removeEventListener(this.eventType,this.completeHandler),this.func=null,this.args=null,this.eventDispatcher=null,this.eventType=null},n.prototype.getFunction=function(){return this.func},n.prototype.setFunction=function(t){this.func=t},n.prototype.getArguments=function(){return this.args},n.prototype.setArguments=function(t){this.args=t},n.prototype.getEventDispatcher=function(){return this.eventDispatcher},n.prototype.setEventDispatcher=function(t){this.eventDispatcher=t},n.prototype.getEventType=function(){return this.eventType},n.prototype.setEventType=function(t){this.eventType=t},n);function n(t,e,n,i){void 0===t&&(t=null),void 0===e&&(e=[]),void 0===n&&(n=null),void 0===i&&(i=null);var o=r.call(this)||this;return o.completeHandler=function(t){o.notifyComplete()},o.func=t,o.args=e,o.eventDispatcher=n,o.eventType=i,o}t.Func=e}(cmd=cmd||{}),function(t){var i,e=(i=t.Command,__extends(n,i),n.prototype.implExecuteFunction=function(t){this.eventDispatcher&&this.eventType&&this.eventDispatcher.addEventListener(this.eventType,this.completeHandler)},n.prototype.implInterruptFunction=function(t){this.eventDispatcher&&this.eventType&&this.eventDispatcher.removeEventListener(this.eventType,this.completeHandler)},n.prototype.implDestroyFunction=function(t){this.eventDispatcher&&this.eventType&&this.eventDispatcher.removeEventListener(this.eventType,this.completeHandler),this.eventType=null,this.eventDispatcher=null},n.prototype.getEventDispatcher=function(){return this.eventDispatcher},n.prototype.setEventDispatcher=function(t){this.eventDispatcher=t},n.prototype.getEventType=function(){return this.eventType},n.prototype.setEventType=function(t){this.eventType=t},n);function n(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var n=i.call(this)||this;return n.completeHandler=function(t){n.notifyComplete()},n.eventDispatcher=t,n.eventType=e,n}t.Listen=e}(cmd=cmd||{}),function(t){var h,c=alm.math.Easing,l=alm.util.Time,e=(h=t.Command,__extends(n,h),n.prototype.implExecuteFunction=function(t){for(var e in this.internalFrom={},this.to)this.to[e],this.from&&null!=this.from[e]?this.internalFrom[e]=this.from[e]:this.internalFrom[e]=this.tweenTarget[e];0<this.duration?(this.timerId=window.setInterval(this.intervalHandler,n.updateInterval),this.startTime=l.now(),this.apply(0),this.onStart&&this.onStart(this.progressTime,this.progressValue)):(this.apply(0),this.onStart&&this.onStart(this.progressTime,this.progressValue),this.apply(1),this.onUpdate&&this.onUpdate(this.progressTime,this.progressValue),this.onComplete&&this.onComplete(this.progressTime,this.progressValue),this.notifyComplete())},n.prototype.implInterruptFunction=function(t){this.cancel()},n.prototype.implDestroyFunction=function(t){this.cancel(),this.tweenTarget=null,this.to=null,this.from=null,this.easing=null,this.onStart=null,this.onUpdate=null,this.onComplete=null,this.internalFrom=null},n.prototype.cancel=function(){-1!=this.timerId&&(clearInterval(this.timerId),this.timerId=-1)},n.prototype.apply=function(t){var e;for(var n in this.progressTime=t,this.progressValue=this.easing(this.progressTime),this.to)e=this.internalFrom[n],this.tweenTarget[n]=e+(this.to[n]-e)*this.progressValue},n.prototype.getTarget=function(){return this.tweenTarget},n.prototype.setTarget=function(t){this.tweenTarget=t},n.prototype.getDuration=function(){return this.duration},n.prototype.setDuration=function(t){this.duration=t},n.prototype.getTo=function(){return this.to},n.prototype.setTo=function(t){this.to=t},n.prototype.getFrom=function(){return this.from},n.prototype.setFrom=function(t){this.from=t},n.prototype.getEasing=function(){return this.easing},n.prototype.setEasing=function(t){this.easing=t},n.prototype.getOnStart=function(){return this.onStart},n.prototype.setOnStart=function(t){this.onStart=t},n.prototype.getOnUpdate=function(){return this.onUpdate},n.prototype.setOnUpdate=function(t){this.onUpdate=t},n.prototype.getOnComplete=function(){return this.onComplete},n.prototype.setOnComplete=function(t){this.onComplete=t},n.prototype.getProgressTime=function(){return this.progressTime},n.prototype.getProgressValue=function(){return this.progressValue},n.prototype.getUpdateInterval=function(){return n.updateInterval},n.prototype.setUpdateInterval=function(t){n.updateInterval=t},n.updateInterval=1e3/60,n);function n(t,e,n,i,o,r,s,a){void 0===n&&(n=null),void 0===i&&(i=1e3),void 0===o&&(o=c.linear),void 0===r&&(r=null),void 0===s&&(s=null),void 0===a&&(a=null);var u=h.call(this)||this;return u.intervalHandler=function(){var t=l.now()-u.startTime;t<u.duration?(u.apply(t/u.duration),u.onUpdate&&u.onUpdate(u.progressTime,u.progressValue)):(u.apply(1),u.cancel(),u.onUpdate&&u.onUpdate(u.progressTime,u.progressValue),u.onComplete&&u.onComplete(u.progressTime,u.progressValue),u.notifyComplete())},u.tweenTarget=t,u.to=e,u.from=n,u.duration=i,u.easing=o,u.onStart=r,u.onUpdate=s,u.onComplete=a,u.progressTime=0,u.progressValue=0,u.startTime=0,u.timerId=-1,u}t.Tween=e}(cmd=cmd||{}),function(i){var o,t=(o=i.CommandList,__extends(e,o),e.prototype.addCommand=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];o.prototype.addCommand.apply(this,t)},e.prototype.insertCommand=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];o.prototype.insertCommandAt.apply(this,__spreadArrays([this.position+1],t))},e.prototype.addCommandArray=function(t){this.addCommand.apply(this,t)},e.prototype.insertCommandArray=function(t){this.insertCommand.apply(this,t)},e.prototype.next=function(){this.currentCommand=this.getCommandByIndex(this.position),this.currentCommand.addEventListener(i.CommandEvent.COMPLETE,this.completeHandler),this.currentCommand.execute()},e.prototype.implExecuteFunction=function(t){(this.position=0)<this.getLength()?this.next():this.notifyComplete()},e.prototype.implInterruptFunction=function(t){this.currentCommand&&(this.currentCommand.removeEventListener(i.CommandEvent.COMPLETE,this.completeHandler),this.currentCommand.interrupt(),this.currentCommand=null),this.position=-1,o.prototype.implInterruptFunction.call(this,t)},e.prototype.implDestroyFunction=function(t){this.currentCommand&&(this.currentCommand.removeEventListener(i.CommandEvent.COMPLETE,this.completeHandler),this.currentCommand.destroy(),this.currentCommand=null),this.position=-1,this.isPaused=!1,this.isCompleteOnPaused=!1,o.prototype.implDestroyFunction.call(this,t)},e.prototype.implNotifyBreak=function(){this.currentCommand.getState()==i.CommandState.Executing&&(this.currentCommand.removeEventListener(i.CommandEvent.COMPLETE,this.completeHandler),this.currentCommand.interrupt()),this.notifyComplete()},e.prototype.implNotifyReturn=function(){this.currentCommand.getState()==i.CommandState.Executing&&(this.currentCommand.removeEventListener(i.CommandEvent.COMPLETE,this.completeHandler),this.currentCommand.interrupt());var t=this.getParent().notifyReturn;t&&t(),this.destroy()},e.prototype.getPosition=function(){return this.position},e);function e(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=o.apply(this,t)||this;return n.completeHandler=function(t){n.currentCommand.removeEventListener(i.CommandEvent.COMPLETE,n.completeHandler),n.currentCommand=null,++n.position>=n.getLength()?n.notifyComplete():n.next()},n.currentCommand=null,n.position=-1,n.isPaused=!1,n.isCompleteOnPaused=!1,n}i.Serial=t}(cmd=cmd||{}),function(r){var s,t=(s=r.CommandList,__extends(e,s),e.prototype.addCommand=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];s.prototype.addCommand.apply(this,t)},e.prototype.insertCommand=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCommand.apply(this,t)},e.prototype.addCommandArray=function(t){this.addCommand.apply(this,t)},e.prototype.insertCommandArray=function(t){this.addCommand.apply(this,t)},e.prototype.implExecuteFunction=function(t){this.completeCount=0;var e=this.getLength();if(0<e)for(var n,i=this.getCommands(),o=0;o<e;++o)(n=i[o]).addEventListener(r.CommandEvent.COMPLETE,this.completeHandler),n.execute();else this.notifyComplete()},e.prototype.implInterruptFunction=function(t){var e=this.getLength();if(0<e)for(var n,i=this.getCommands(),o=0;o<e;++o)(n=i[o]).removeEventListener(r.CommandEvent.COMPLETE,this.completeHandler),n.interrupt();s.prototype.implInterruptFunction.call(this,t)},e.prototype.implDestroyFunction=function(t){var e=this.getLength();if(0<e)for(var n,i=this.getCommands(),o=0;o<e;++o)(n=i[o]).removeEventListener(r.CommandEvent.COMPLETE,this.completeHandler),n.destroy();s.prototype.implDestroyFunction.call(this,t)},e.prototype.implNotifyBreak=function(){var t=this.getLength();if(0<t)for(var e=this.getCommands(),n=void 0,i=0;i<t;++i)(n=e[i]).getState()==r.CommandState.Executing&&(n.removeEventListener(r.CommandEvent.COMPLETE,this.completeHandler),n.interrupt());this.notifyComplete()},e.prototype.implNotifyReturn=function(){var t=this.getLength();if(0<t)for(var e=this.getCommands(),n=void 0,i=0;i<t;++i)(n=e[i]).getState()==r.CommandState.Executing&&(n.removeEventListener(r.CommandEvent.COMPLETE,this.completeHandler),n.interrupt());var o=this.getParent().notifyReturn;o&&o(),this.destroy()},e.prototype.getCompleteCount=function(){return this.completeCount},e);function e(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=s.apply(this,t)||this;return n.completeHandler=function(t){++n.completeCount>=n.getLength()&&n.notifyComplete()},n.completeCount=0,n}r.Parallel=t}(cmd=cmd||{}),function(t){var e,n;function i(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.set(t,e)}e=t.geom||(t.geom={}),i.prototype.set=function(t,e){this.x=t,this.y=e},i.prototype.copyTo=function(t){t.set(this.x,this.y)},i.prototype.getClone=function(){return new i(this.x,this.y)},i.prototype.zero=function(){this.set(0,0)},i.prototype.normalize=function(){var t=this.getLength();this.x/=t,this.y/=t},i.prototype.getLength=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},i.prototype.getSquareDistance=function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},i.prototype.getDistance=function(t){return Math.sqrt(this.getSquareDistance(t))},n=i,e.Vector2=n}(alm=alm||{}),function(t){var e,n;function i(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this.set(t,e,n)}e=t.geom||(t.geom={}),i.prototype.set=function(t,e,n){this.x=t,this.y=e,this.z=n},i.prototype.copyTo=function(t){t.set(this.x,this.y,this.z)},i.prototype.getClone=function(){return new i(this.x,this.y,this.z)},i.prototype.zero=function(){this.set(0,0,0)},i.prototype.normalize=function(){var t=this.getLength();this.x/=t,this.y/=t,this.z/=t},i.prototype.getLength=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},i.prototype.getSquareDistance=function(t){var e=t.x-this.x,n=t.y-this.y,i=t.z-this.z;return e*e+n*n+i*i},i.prototype.getDistance=function(t){return Math.sqrt(this.getSquareDistance(t))},n=i,e.Vector3=n}(alm=alm||{}),function(t){var e,n;function i(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.set(t,e,n,i)}e=t.geom||(t.geom={}),i.prototype.set=function(t,e,n,i){this.x=t,this.y=e,this.width=n,this.height=i},i.prototype.copyTo=function(t){t.set(this.x,this.y,this.width,this.height)},i.prototype.getClone=function(){return new i(this.x,this.y,this.width,this.height)},i.prototype.getTop=function(){return this.y},i.prototype.getBottom=function(){return this.y+this.height},i.prototype.getLeft=function(){return this.x},i.prototype.getRight=function(){return this.x+this.width},i.prototype.getTopLeft=function(){return new e.Vector2(this.getLeft(),this.getTop())},i.prototype.getTopRight=function(){return new e.Vector2(this.getRight(),this.getTop())},i.prototype.getBottomLeft=function(){return new e.Vector2(this.getLeft(),this.getBottom())},i.prototype.getBottomRight=function(){return new e.Vector2(this.getRight(),this.getBottom())},n=i,e.Rectangle=n}(alm=alm||{}),function(t){!function(m){var f,t,g,e;(t=f=m.Align||(m.Align={}))[t.Top_Left=0]="Top_Left",t[t.Top_Center=1]="Top_Center",t[t.Top_Right=2]="Top_Right",t[t.Middle_Left=3]="Middle_Left",t[t.Middle_Center=4]="Middle_Center",t[t.Middle_Right=5]="Middle_Right",t[t.Bottom_Left=6]="Bottom_Left",t[t.Bottom_Center=7]="Bottom_Center",t[t.Bottom_Right=8]="Bottom_Right",(e=g=m.ScaleMode||(m.ScaleMode={}))[e.ExactFit=0]="ExactFit",e[e.ShowAll=1]="ShowAll",e[e.NoBorder=2]="NoBorder",e[e.NoScale=3]="NoScale";var n=(i.resize=function(t,e,n,i){void 0===n&&(n=g.ShowAll),void 0===i&&(i=f.Middle_Center);var o=t.x,r=t.y,s=t.width,a=t.height,u=e.x,h=e.y,c=e.width,l=e.height;switch(n){case g.ShowAll:case g.NoBorder:var d=c/s,p=l/a,v=n==g.ShowAll?d<p?d:p:p<d?d:p;s*=v,a*=v;break;case g.ExactFit:return new m.Rectangle(u,h,c,l)}return o=u+(i==f.Top_Left||i==f.Middle_Left||i==f.Bottom_Left?0:i==f.Top_Right||i==f.Middle_Right||i==f.Bottom_Right?c-s:(c-s)/2),r=h+(i==f.Top_Left||i==f.Top_Center||i==f.Top_Right?0:i==f.Bottom_Left||i==f.Bottom_Center||i==f.Bottom_Right?l-a:(l-a)/2),new m.Rectangle(o,r,s,a)},i);function i(){}m.Boxer=n}(t.geom||(t.geom={}))}(alm=alm||{}),function(t){var e,n;function i(){}e=t.util||(t.util={}),i.each=function(e,n){null!=e&&Object.keys(e).forEach(function(t){n(t,e[t])})},i.get=function(t,e,n){var i=t[e];return void 0!==i?i:n},n=i,e.Obj=n}(alm=alm||{}),function(t){var e,n;function i(){}e=t.util||(t.util={}),i.sequence=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=1);for(var i=new Array(t),o=e,r=0;r<t;++r)i[r]=o,o+=n;return i},i.unique=function(t){return t.filter(function(t,e,n){return n.indexOf(t)===e})},i.duplicated=function(t,e){return void 0===e&&(e=!1),e?t.filter(function(t,e,n){return n.indexOf(t)!==n.lastIndexOf(t)}):t.filter(function(t,e,n){return n.indexOf(t)===e&&n.lastIndexOf(t)!==e})},i.roundRobin=function(t,e,n){for(var i,o=1,r=t.length,s=e.length,a=0;a<r;++a)for(i=a+1;i<s;++i)n(o++,a,i,t[a],e[i])},i.swap=function(t,e,n){var i=t[e];t[e]=t[n],t[n]=i},i.shuffle=function(t){for(var e=t.length-1;0<e;--e)i.swap(t,e,Math.floor(Math.random()*(e+1)))},i.sort=function(t,e){void 0===e&&(e=!0),t.sort(e?function(t,e){return t-e}:function(t,e){return e-t})},n=i,e.Arr=n}(alm=alm||{}),function(t){var e,n;function i(){}e=t.util||(t.util={}),i.map=function(t,e,n,i,o,r){return void 0===r&&(r=!0),e===n?i:(r&&(e<n?t<e?t=e:n<t&&(t=n):t<n?t=n:e<t&&(t=e)),(t-e)*(o-i)/(n-e)+i)},i.ease=function(t,e,n,i,o,r){return e===n?i:e<n?(t<e?t=e:n<t&&(t=n),r((t-e)/(n-e))*(o-i)+i):(t<n?t=n:e<t&&(t=e),r((t-n)/(e-n))*(o-i)+i)},i.random=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),t+(e-t)*Math.random()},i.randomInt=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),Math.floor(i.random(t,e))},i.clamp=function(t,e,n){return t<e?e:n<t?n:t},i.clampAbs=function(t,e,n){return 0<t?t<e?e:n<t?n:t:-((t=Math.abs(t))<e?e:n<t?n:t)},i.dist=function(t,e,n,i,o){void 0===o&&(o=!1);var r=n-t,s=i-e;return o?r*r+s*s:Math.sqrt(r*r+s*s)},i.radToDeg=function(t){return t*i.RAD2DEG},i.degToRad=function(t){return t*i.DEG2RAD},i.turn=function(t,e,n){return void 0===n&&(n=!0),n?(e-t+i.PI3)%i.PI2-Math.PI:(e-t+540)%360-180},i.PI2=2*Math.PI,i.PI3=3*Math.PI,i.PI4=4*Math.PI,i.PI5=5*Math.PI,i.PI6=6*Math.PI,i.PI_2=Math.PI/2,i.PI_3=Math.PI/3,i.PI_4=Math.PI/4,i.PI_6=Math.PI/6,i.RAD2DEG=180/Math.PI,i.DEG2RAD=Math.PI/180,n=i,e.Num=n}(alm=alm||{}),function(t){var e,n;function i(){}e=t.util||(t.util={}),i.toTimeString=function(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),n+=60*e+3600*t;var i=Math.floor(n/3600).toString(),o=Math.floor(n/60%60).toString(),r=("0"+Math.floor(n%60)).substr(-2,2);return"0"!=i?i+":"+("0"+o).substr(-2,2)+":"+r:o+":"+r},n=i,e.Str=n}(alm=alm||{}),function(t){var e,n;function i(){}e=t.util||(t.util={}),i.stop=function(t){return t&&t.interrupt(),null},i.sequence=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var i=new cmd.Serial;return i.addCommand.apply(i,e),t&&i.execute(),i},i.single=function(t,e){return t&&e&&e.execute(),e},n=i,e.Cmd=n}(alm=alm||{}),function(t){var e,n;function i(){}e=t.util||(t.util={}),i.instantiate=function(t){var e=document.getElementById(t).cloneNode(!0);return e.removeAttribute("id"),e},i.addPointerDownListener=function(t,e){t.addEventListener("pointerdown",e)},i.addPointerUpListener=function(t,e){t.addEventListener("pointerup",e)},i.removePointerEventListener=function(t,e){t.removeEventListener("pointerdown",e)},i.removePointerUpListener=function(t,e){t.removeEventListener("pointerup",e)},n=i,e.Dom=n}(alm=alm||{}),function(t){var e,n;function i(t,e,n,i){void 0===n&&(n=100),void 0===i&&(i=50),this.onRequireItem=t,this.onDestroyItem=e,this.growthCount=i,this.items=new Array(n);for(var o=0;o<n;++o)this.items[o]=this.onRequireItem();this.index=n}e=t.resource||(t.resource={}),i.prototype.getItem=function(){if(0<this.index)return this.items[--this.index];for(var t=0;t<this.growthCount;++t)this.items.unshift(this.onRequireItem());return this.index=this.growthCount,this.getItem()},i.prototype.returnItem=function(t){this.items[this.index++]=t},i.prototype.reduce=function(){for(var t=this.index,e=0;e<t;++e)this.onDestroyItem(this.items.shift());this.index=0},i.prototype.destroy=function(){for(var t=this.items.length,e=0;e<t;++e)this.onDestroyItem(this.items[e]);this.index=0,this.items=null,this.onRequireItem=null,this.onDestroyItem=null},n=i,e.ObjectPool=n}(alm=alm||{}),function(t){var e,n;function i(t){void 0===t&&(t=null),t?this.set(t):(this.initValues=this.restValues=null,this.restCount=this.restValues.length,this.isEmpty=!0),this.onCheck=null,this.isAutoResetEnabled=!1}e=t.state||(t.state={}),i.prototype.set=function(t){this.initValues=t.concat(),this.reset()},i.prototype.get=function(){this.isEmpty&&this.isAutoResetEnabled&&this.reset();var t=Math.floor(Math.random()*this.restCount),e=this.restValues[t],n=!0;return this.onCheck&&(n=this.onCheck(e)),n&&(this.restValues.splice(t,1),this.restCount=this.restValues.length,this.isEmpty=0==this.restCount),e},i.prototype.add=function(t,e){void 0===e&&(e=!1),this.initValues.push(t),this.restValues.push(t),this.restCount=this.restValues.length,this.isEmpty=0==this.restCount,e&&this.reset()},i.prototype.reset=function(){this.restValues=this.initValues.concat(),this.restCount=this.restValues.length,this.isEmpty=0==this.restCount},i.prototype.getRestCount=function(){return this.restCount},i.prototype.getIsEmply=function(){return this.isEmpty},i.prototype.getIsAutoResetEnabled=function(){return this.isAutoResetEnabled},i.prototype.setIsAutoResetEnabled=function(t){this.isAutoResetEnabled=t},i.createIndices=function(t){for(var e=new Array(t),n=0;n<t;++n)e[n]=n;return new i(e)},n=i,e.Lottery=n}(alm=alm||{}),function(t){var o,e,n;function i(){var t=e.call(this)||this;return t.isLoopEnabled=!0,t.itemCount=0,t.itemIds=null,t.itemIndexById=null,t.onChange=null,t.onPrev=null,t.onNext=null,t}o=t.state||(t.state={}),e=t.event.EventDispatcher,__extends(i,e),i.prototype.setupById=function(t){this.itemCount=t.length,this.itemIds=t,this.itemIndexById={};for(var e=0;e<this.itemCount;++e)this.itemIndexById[this.itemIds[e]]=e;this.setup()},i.prototype.setupByCount=function(t){this.itemCount=t,this.itemIds=null,this.itemIndexById=null,this.setup()},i.prototype.setup=function(){this.currentItemIndex=-1,this.currentItemId=null,this.oldItemIndex=-1,this.oldItemId=null},i.prototype.gotoByIndex=function(t,e){return void 0===e&&(e=!0),(t<0||t>=this.itemCount)&&(t=-1),t!=this.currentItemIndex&&(this.oldItemIndex=this.currentItemIndex,this.currentItemIndex=t,this.itemIds&&(this.oldItemId=-1!=this.oldItemIndex?this.itemIds[this.oldItemIndex]:null,this.currentItemId=-1!=this.currentItemIndex?this.itemIds[this.currentItemIndex]:null),this.dispatchPagerEvent(o.SwitcherEvent.CHANGE,this.onChange,e),!0)},i.prototype.gotoById=function(t,e){void 0===e&&(e=!0);var n=this.itemIndexById.hasOwnProperty(t)?this.itemIndexById[t]:-1;return this.gotoByIndex(n,e)},i.prototype.prev=function(t){void 0===t&&(t=!0);var e=this.getPrevItemIndex(),n=this.gotoByIndex(e,t);return n&&this.dispatchPagerEvent(o.SwitcherEvent.PREV,this.onPrev,t),n},i.prototype.next=function(t){void 0===t&&(t=!0);var e=this.getNextItemIndex(),n=this.gotoByIndex(e,t);return n&&this.dispatchPagerEvent(o.SwitcherEvent.NEXT,this.onNext,t),n},i.prototype.getPrevItemIndex=function(){var t=this.currentItemIndex-1;return this.isLoopEnabled&&t<0&&(t=this.itemCount-1),t},i.prototype.getPrevItemId=function(){return this.itemIds[this.getPrevItemIndex()]},i.prototype.getNextItemIndex=function(){var t=this.currentItemIndex+1;return this.isLoopEnabled&&t>=this.itemCount&&(t=0),t},i.prototype.getNextItemId=function(){return this.itemIds[this.getNextItemIndex()]},i.prototype.dispatchPagerEvent=function(t,e,n){var i=new o.SwitcherEvent(t,this,this.currentItemIndex,this.oldItemIndex,this.currentItemId,this.oldItemId,n);e&&e(i),this.dispatchEvent(i)},i.prototype.getIsLoopEnabled=function(){return this.isLoopEnabled},i.prototype.setIsLoopEnabled=function(t){this.isLoopEnabled=t},i.prototype.getItemCount=function(){return this.itemCount},i.prototype.getCurrentItemIndex=function(){return this.currentItemIndex},i.prototype.getOldItemIndex=function(){return this.oldItemIndex},i.prototype.getCurrentItemId=function(){return this.currentItemId},i.prototype.getOldItemId=function(){return this.oldItemId},i.prototype.getItemIds=function(){return this.itemIds},n=i,o.Switcher=n}(alm=alm||{}),function(t){var e,u,n;function i(t,e,n,i,o,r,s){var a=u.call(this,t,e)||this;return a.currentItemIndex=n,a.oldItemIndex=i,a.currentItemId=o,a.oldItemId=r,a.useTransition=s,a}e=t.state||(t.state={}),u=t.event.Event,__extends(i,u),i.prototype.clone=function(){return new i(this.type,this.target,this.currentItemIndex,this.oldItemIndex,this.currentItemId,this.oldItemId,this.useTransition)},i.prototype.toString=function(){return"[SwitcherEvent] type = "+this.type+", "+this.oldItemIndex+" -> "+this.currentItemIndex+", transition = "+this.useTransition},i.CHANGE="change",i.PREV="prev",i.NEXT="next",n=i,e.SwitcherEvent=n}(alm=alm||{}),function(t){var n,o,e,i;function r(t,e,n){void 0===n&&(n=0);var i=o.call(this)||this;return i.lowThreshold=t,i.highThreshold=e,i.isHigh=!1,i._set(n,!1),i}n=t.state||(t.state={}),e=t.event.EventDispatcher,__extends(r,o=e),r.prototype.set=function(t){return this._set(t,!0)},r.prototype.getIsHigh=function(){return this.isHigh},r.prototype.getValue=function(){return this.value},r.prototype.getLowThreshold=function(){return this.lowThreshold},r.prototype.getHighThreshold=function(){return this.highThreshold},r.prototype.setLowThreshold=function(t){this.lowThreshold=t,this._set(this.value,!0)},r.prototype.setHighThreshold=function(t){this.highThreshold=t,this._set(this.value,!0)},r.prototype._set=function(t,e){return this.value=t,this.isHigh&&this.value<this.lowThreshold?(this.isHigh=!1,e&&(this.dispatchEvent(new n.LoHiEvent(n.LoHiEvent.LOW,this,this.isHigh)),this.dispatchEvent(new n.LoHiEvent(n.LoHiEvent.CHANGE,this,this.isHigh))),!0):!this.isHigh&&this.value>this.highThreshold&&(this.isHigh=!0,e&&(this.dispatchEvent(new n.LoHiEvent(n.LoHiEvent.HIGH,this,this.isHigh)),this.dispatchEvent(new n.LoHiEvent(n.LoHiEvent.CHANGE,this,this.isHigh))),!0)},i=r,n.LoHi=i}(alm=alm||{}),function(t){var e,o,n;function i(t,e,n){var i=o.call(this,t,e)||this;return i.isHigh=n,i}e=t.state||(t.state={}),o=t.event.Event,__extends(i,o),i.prototype.clone=function(){return new i(this.type,this.target,this.isHigh)},i.prototype.toString=function(){return"[LoHiEvent] type = "+this.type+", isHigh = "+this.isHigh},i.CHANGE="change",i.LOW="low",i.HIGH="high",n=i,e.LoHiEvent=n}(alm=alm||{}),function(t){var e,n;function i(t,e,n){void 0===e&&(e=.1),void 0===n&&(n=0),this.value=this.target=t,this.easing=e,this.tolerance=n}e=t.math||(t.math={}),i.prototype.update=function(t){var e;return void 0===t&&(t=!0),t?(e=this.target-this.value,0<this.tolerance&&Math.abs(e)<=this.tolerance?this.value=this.target:this.value+=e*this.easing):this.value=this.target,this.value},i.prototype.clone=function(){var t=new i(this.value,this.easing,this.tolerance);return t.target=this.target,t},n=i,e.EasingValue=n}(alm=alm||{}),function(t){var e,n;function i(t,e,n){void 0===e&&(e=.1),void 0===n&&(n=.9),this.acceleration=0,this.velocity=0,this.value=this.target=t,this.spring=e,this.friction=n}e=t.math||(t.math={}),i.prototype.update=function(t){return void 0===t&&(t=!0),t?(this.acceleration=(this.target-this.value)*this.spring,this.velocity+=this.acceleration,this.velocity*=this.friction,this.value+=this.velocity):(this.acceleration=0,this.velocity=0,this.value=this.target),this.value},i.prototype.clone=function(){var t=new i(this.value,this.spring,this.friction);return t.acceleration=this.acceleration,t.velocity=this.velocity,t.target=this.target,t},n=i,e.SpringValue=n}(alm=alm||{}),function(t){var e,n;function i(){this.value=this._value=0,this.count=this._count=0}e=t.math||(t.math={}),i.prototype.add=function(t){return this._value=(this._value*this._count+t)/++this._count,this.value=this._value,this.count=this._count,this._value},n=i,e.SimpleAverage=n}(alm=alm||{}),function(t){var e,n;function i(t){this.maxCount=this._maxCount=t,this.value=this._value=0,this.count=this._count=0,this.values=[]}e=t.math||(t.math={}),i.prototype.add=function(t){var e,n;return++this._count>this._maxCount?(this._count=this._maxCount,e=this.values.shift(),this._value-=e,n=t/this._maxCount,this._value+=n,this.values.push(n)):(this._value*=this._count-1,this._value+=t,this._value/=this._count,this.values.push(t/this._maxCount)),this.value=this._value,this.count=this._count,this._value},n=i,e.SimpleMovingAverage=n}(alm=alm||{}),function(t){var e,n;function i(t){void 0===t&&(t=0),this.maxLatestCount=this._maxLatestCount=t,this.value=this._value=-Number.MAX_VALUE,this.count=this._count=0,this.values=[]}e=t.math||(t.math={}),i.prototype.add=function(t){if(0<this._maxLatestCount)if(++this._count>this._maxLatestCount){this._count=this._maxLatestCount,this.values.push(t);var e=this.values.shift();if(this._value>e)this._value<t&&(this._value=t);else{this._value=-Number.MAX_VALUE;for(var n=0;n<this._count;++n){var i=this.values[n];this._value<i&&(this._value=i)}}}else this.values.push(t),this._value<t&&(this._value=t);else++this._count,this._value<t&&(this._value=t);return this.value=this._value,this.count=this._count,this._value},n=i,e.MaxValue=n}(alm=alm||{}),function(t){var e,n;function i(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=!0),this.setAngle(t,n),this.setVelocity(e,n)}e=t.math||(t.math={}),i.prototype.getAngle=function(t){return void 0===t&&(t=!0),t?this.angle:180*this.angle/Math.PI},i.prototype.setAngle=function(t,e){void 0===e&&(e=!0),this.angle=e?t:t*Math.PI/180},i.prototype.getVelocity=function(t){return void 0===t&&(t=!0),t?this.velocity:180*this.velocity/Math.PI},i.prototype.setVelocity=function(t,e){void 0===e&&(e=!0),this.velocity=e?t:t*Math.PI/180},i.prototype.update=function(){this.angle+=this.velocity},i.prototype.getSin=function(t){return void 0===t&&(t=1),t*Math.sin(this.angle)},i.prototype.getCos=function(t){return void 0===t&&(t=1),t*Math.cos(this.angle)},i.prototype.getTan=function(t){return void 0===t&&(t=1),t*Math.tan(this.angle)},i.prototype.getMagnitude=function(t){return void 0===t&&(t=1),t*(1+Math.sin(this.angle))/2},i.prototype.getVector=function(t,e){if(void 0===t&&(t=1),void 0===e&&(e=null),null==e)return{x:this.getCos(t),y:this.getSin(t)};e.x=this.getCos(t),e.y=this.getSin(t)},n=i,e.Circular=n}(alm=alm||{}),function(t){var i,o,e,r,n;function s(t,e){void 0===t&&(t=0),void 0===e&&(e=.1);var n=o.call(this)||this;return n.updateHandler=function(){var t;n.requestId=window.requestAnimationFrame(n.updateHandler),0<n.targetFrameRate?(t=r.now())-n.frameStartTime>=n.interval-n.toleranceDuration&&(n.frameStartTime=t,n.dispatchEvent(new i.AnimationFrameTickerEvent(i.AnimationFrameTickerEvent.TICK,n))):n.dispatchEvent(new i.AnimationFrameTickerEvent(i.AnimationFrameTickerEvent.TICK,n))},n.targetFrameRate=t,n.interval=1e3/n.targetFrameRate,n.tolerance=e,n.toleranceDuration=n.interval*n.tolerance,n.isRunning=!1,n}i=t.time||(t.time={}),e=t.event.EventDispatcher,r=t.util.Time,__extends(s,o=e),s.prototype.start=function(){this.isRunning||(this.isRunning=!0,this.frameStartTime=r.now(),this.requestId=window.requestAnimationFrame(this.updateHandler))},s.prototype.stop=function(){this.isRunning&&(this.isRunning=!1,window.cancelAnimationFrame(this.requestId))},s.prototype.getIsRunning=function(){return this.isRunning},s.prototype.getTargetFrameRate=function(){return this.isRunning},s.prototype.setInterval=function(t){return window.setTimeout(t,1e3/60)},s.prototype.clearInterval=function(t){window.clearInterval(t)},n=s,i.AnimationFrameTicker=n}(alm=alm||{}),function(t){var e,n,i,o;function r(t,e){return n.call(this,t,e)||this}e=t.time||(t.time={}),i=t.event.Event,__extends(r,n=i),r.prototype.clone=function(){return new r(this.type,this.target)},r.prototype.toString=function(){return"[AnimationFrameTickerEvent] type = "+this.type},r.TICK="tick",o=r,e.AnimationFrameTickerEvent=o}(alm=alm||{}),function(t){var i,o,e,r,n;function s(t,e){void 0===t&&(t=1e3),void 0===e&&(e=0);var n=o.call(this)||this;return n.timerHandler=function(){n.tStartTime=r.now(),++n.elapsedCount;var t=!1;0<n.repeatCount&&n.elapsedCount>=n.repeatCount?(t=!0,n.stop()):n.tInterval!=n.interval&&n.startInterval(n.interval),n.dispatch(i.TimerEvent.TICK),t&&n.dispatch(i.TimerEvent.COMPLETE)},n.interval=t,n.repeatCount=e,n.isRunning=!1,n.tId=-1,n.reset(),n}i=t.time||(t.time={}),e=t.event.EventDispatcher,r=t.util.Time,__extends(s,o=e),s.prototype.start=function(){this.isRunning||(this.isRunning=!0,this.tStartTime=r.now(),this.startInterval(-1!=this.tRestTime?this.tRestTime:this.interval))},s.prototype.stop=function(){this.isRunning&&(this.isRunning=!1,this.tRestTime=r.now()-this.tStartTime,this.stopInterval())},s.prototype.reset=function(){this.stop(),this.elapsedCount=0,this.tRestTime=-1},s.prototype.restart=function(){this.reset(),this.start()},s.prototype.startInterval=function(t){this.stopInterval(),this.tInterval=t,this.tId=window.setInterval(this.timerHandler,this.tInterval)},s.prototype.stopInterval=function(){-1!=this.tId&&(clearInterval(this.tId),this.tId=-1)},s.prototype.dispatch=function(t){this.dispatchEvent(new i.TimerEvent(t,this,this.elapsedCount,this.repeatCount,this.getRestCount()))},s.prototype.getIsRunning=function(){return this.isRunning},s.prototype.getInterval=function(){return this.interval},s.prototype.setInterval=function(t){this.interval=t},s.prototype.getElapsedTime=function(){return r.now()-this.tStartTime},s.prototype.getRestTime=function(){return this.interval-this.getElapsedTime()},s.prototype.getElapsedCount=function(){return this.elapsedCount},s.prototype.getRepeatCount=function(){return this.repeatCount},s.prototype.setRepeatCount=function(t){this.repeatCount=t},s.prototype.getRestCount=function(){return this.repeatCount-this.elapsedCount},n=s,i.Timer=n}(alm=alm||{}),function(t){var e,s,n,i;function o(t,e,n,i,o){void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=0);var r=s.call(this,t,e)||this;return r.elapsedCount=n,r.repeatCount=i,r.restCount=o,r}e=t.time||(t.time={}),n=t.event.Event,__extends(o,s=n),o.prototype.clone=function(){return new o(this.type,this.target,this.elapsedCount,this.repeatCount,this.restCount)},o.prototype.toString=function(){return"[TimerEvent] type = "+this.type+", elapsedCount = "+this.elapsedCount+", repeatCount="+this.repeatCount+", restCount="+this.restCount},o.TICK="tick",o.COMPLETE="complete",i=o,e.TimerEvent=i}(alm=alm||{}),function(t){var r,e,n,i;function s(t){void 0===t&&(t=3);var i=e.call(this)||this;return i.fileLoadCompleteHandler=function(t,e,n){void 0===n&&(n=null),--i.currentThreadCount,t.isLoading=!1,t.isLoadComplete=!0,t.content=e,t.param.onLoad&&t.param.onLoad(e,n),i.dispatchEvent(new r.FileLoaderSuccessEvent(r.FileLoaderSuccessEvent.SUCCESS,i,e,n)),i.next()},i.fileLoadErrorHandler=function(t,e){void 0===e&&(e=null),--i.currentThreadCount,t.isLoading=!1,t.isLoadComplete=!0,t.param.onError&&t.param.onError(e),i.dispatchEvent(new r.FileLoaderErrorEvent(r.FileLoaderErrorEvent.ERROR,i,e)),i.next()},i.isLoading_=!1,i.currentCount=0,i.totalCount=0,i.currentThreadCount=0,i.totalThreadCount=t,i.loadingQueries=[],i.loadingQueryIndex=-1,i.queriesByQueryId={},i.queriesByUrl={},i.handlersByType={},trace("[FileLoader] totalThreadCount : "+i.totalThreadCount),i}r=t.io||(t.io={}),n=t.event.EventDispatcher,__extends(s,e=n),s.prototype.require=function(t,e,n){return void 0===n&&(n=""),this.addQuery(e,t,{},n)},s.prototype.addQuery=function(t,e,n,i){if(void 0===i&&(i=""),this.queriesByUrl[e])return this.queriesByUrl[e].id;var o=new r.FileQuery;return o.type=t,o.url=e,o.param=n,""!=i?o.id=i:(o.id=String(s.id),++s.id),this.loadingQueries.push(o),this.queriesByQueryId[o.id]=o,(this.queriesByUrl[o.url]=o).id},s.prototype.load=function(){this.isLoading_||(this.isLoading_=!0,this.loadingQueryIndex=-1,this.next())},s.prototype.next=function(){var i=this;this.currentCount=this.loadingQueryIndex+1,this.totalCount=this.loadingQueries.length;var e=this.currentCount/this.totalCount;function t(){if(!(o.loadingQueryIndex+1<o.totalCount))return o.isLoading_=!1,o.loadingQueries=[],o.loadingQueryIndex=-1,o.dispatchEvent(new r.FileLoaderProgressEvent(r.FileLoaderProgressEvent.COMPLETE,o,e,o.currentCount,o.totalCount)),"break";++o.currentThreadCount,++o.loadingQueryIndex;var n=o.loadingQueries[o.loadingQueryIndex];n.isLoading=!0,n.isLoadComplete=!1,trace("[FileLoader] loading... '"+n.url+"' as '"+n.type+"'");var t=o.handlersByType[n.type];t?t.load(n.url,function(t,e){void 0===e&&(e=null),i.fileLoadCompleteHandler(n,t,e)},function(t){void 0===t&&(t=null),i.fileLoadErrorHandler(n,t)}):(trace("[FileLoader] handler is not found '"+n.type+"'"),--o.currentThreadCount)}0==this.currentCount?this.dispatchEvent(new r.FileLoaderProgressEvent(r.FileLoaderProgressEvent.START,this,e,this.currentCount,this.totalCount)):this.dispatchEvent(new r.FileLoaderProgressEvent(r.FileLoaderProgressEvent.PROGRESS,this,e,this.currentCount,this.totalCount));for(var o=this;this.currentThreadCount<this.totalThreadCount&&"break"!==t(););},s.prototype.addHandler=function(t){this.handlersByType[t.getType()]=t},s.prototype.getQueryByQueryId=function(t){return this.queriesByQueryId[t]},s.prototype.getQueryByUrl=function(t){return this.queriesByUrl[t]},s.prototype.isLoading=function(){return this.isLoading_},s.prototype.getCurrentCount=function(){return this.currentCount},s.prototype.getTotalCount=function(){return this.totalCount},s.prototype.getContentByUrl=function(t){return this.queriesByUrl[t].content},s.prototype.getContentByQueryId=function(t){return this.queriesByQueryId[t].content},s.prototype.getCurrentThreadCount=function(){return this.currentThreadCount},s.prototype.getTotalThreadCount=function(){return this.totalThreadCount},s.id=0,i=s,r.FileLoader=i}(alm=alm||{}),function(t){var e,s,n;function i(t,e,n,i,o){void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=0);var r=s.call(this,t,e)||this;return r.progress=n,r.loadedCount=i,r.totalCount=o,r}e=t.io||(t.io={}),s=t.event.Event,__extends(i,s),i.prototype.clone=function(){return new i(this.type,this.target,this.progress,this.loadedCount,this.totalCount)},i.prototype.toString=function(){return"[FileLoaderProgressEvent] type = "+this.type+", progress = "+this.progress+", loadedCount = "+this.loadedCount+", totalCount = "+this.totalCount},i.START="start",i.PROGRESS="progress",i.COMPLETE="complete",n=i,e.FileLoaderProgressEvent=n}(alm=alm||{}),function(t){var e,r,n;function i(t,e,n,i){void 0===i&&(i=null);var o=r.call(this,t,e)||this;return o.content=n,o.info=i,o}e=t.io||(t.io={}),r=t.event.Event,__extends(i,r),i.prototype.clone=function(){return new i(this.type,this.target,this.content,this.info)},i.prototype.toString=function(){return"[FileLoaderSuccessEvent] type = "+this.type+", info = "+this.info},i.SUCCESS="success",n=i,e.FileLoaderSuccessEvent=n}(alm=alm||{}),function(t){var e,o,n;function i(t,e,n){void 0===n&&(n=null);var i=o.call(this,t,e)||this;return i.info=n,i}e=t.io||(t.io={}),o=t.event.Event,__extends(i,o),i.prototype.clone=function(){return new i(this.type,this.target,this.info)},i.prototype.toString=function(){return"[FileLoaderErrorEvent] type = "+this.type+", info = "+this.info},i.ERROR="error",n=i,e.FileLoaderErrorEvent=n}(alm=alm||{}),function(t){function e(){this.isLoading=!1,this.isLoadComplete=!1}(t.io||(t.io={})).FileQuery=e}(alm=alm||{}),function(t){var e,o,r,n;function i(t,e,n,i){void 0===n&&(n=""),void 0===i&&(i=1),this.context=t,this.masterVolume=i,this.buffer=null,this.sourceNode=null,this.isAvailable=!1,this.duration=0,this.gainNode=this.context.createGain(),this.gainNode.connect(e),this.volume=1,this.applyVolume(),""!=n&&this.load(n)}e=t.audio||(t.audio={}),o=t.util.Cmd,r=t.math.Easing,i.prototype.load=function(e){var n=this,t=new XMLHttpRequest;t.responseType="arraybuffer",t.onreadystatechange=function(){4==t.readyState&&(0!=t.status&&200!=t.status||n.context.decodeAudioData(t.response,function(t){trace("[AudioClip] load complete :",e),n.isAvailable=!0,n.buffer=t,n.duration=n.buffer.duration},function(t){trace("[AudioClip] load error :",t),trace(t)}))},t.open("GET",e,!0),t.send("")},i.prototype.play=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!0),this.isAvailable&&(!e&&this.sourceNode||(this.stop(),this.sourceNode=this.context.createBufferSource(),this.sourceNode.buffer=this.buffer,this.sourceNode.loop=t,this.sourceNode.connect(this.gainNode),this.sourceNode.start(0)))},i.prototype.stop=function(){this.sourceNode&&(this.sourceNode.stop(),this.sourceNode.disconnect(this.gainNode),this.sourceNode=null)},i.prototype.getVolume=function(){return this.volume},i.prototype.setVolume=function(t){o.stop(this.volumeTween),this.volume!=t&&(this.volume=t,this.applyVolume())},i.prototype.fadeTo=function(t,e,n){var i=this;void 0===e&&(e=1e3),void 0===n&&(n=null),o.stop(this.volumeTween),this.volumeTween=new cmd.Tween(this,{volume:t},null,e,r.linear,null,function(){i.applyVolume()},function(){n&&n()}),this.volumeTween.execute()},i.prototype.fadeIn=function(t){void 0===t&&(t=1e3),this.fadeTo(1,t)},i.prototype.fadeOut=function(t,e){var n=this;void 0===t&&(t=1e3),void 0===e&&(e=!0),this.fadeTo(0,t,function(){e&&n.stop()})},i.prototype.applyVolume=function(){this.gainNode.gain.value=this.volume*this.masterVolume},i.prototype.getIsAvailable=function(){return this.isAvailable},i.prototype.getDuration=function(){return this.duration},i.prototype.getCurrentTime=function(){return this.context.currentTime},n=i,e.AudioClip=n}(alm=alm||{}),function(t){var i,n,e,o;function r(){var t=n.call(this)||this,e=window.AudioContext||window.webkitAudioContext||null;return t.isAvailable=null!=e,t.isAvailable&&(t.context=new e,t.clipsById={},t.masterGainNode=t.context.createGain(),t.masterGainNode.connect(t.context.destination),t.masterVolume=1),t}i=t.audio||(t.audio={}),e=t.event.EventDispatcher,__extends(r,n=e),r.prototype.add=function(t,e,n){return void 0===e&&(e=1),void 0===n&&(n=""),!!this.isAvailable&&(""==n&&(n=t),!this.clipsById[n]&&(this.clipsById[n]=new i.AudioClip(this.context,this.masterGainNode,t,e),!0))},r.prototype.getClip=function(t){if(this.isAvailable)return this.clipsById[t]},r.prototype.getMasterVolume=function(){return this.isAvailable?this.masterVolume:0},r.prototype.setMasterVolume=function(t){this.isAvailable&&(this.masterVolume=t,this.masterGainNode.gain.value=this.masterVolume)},r.getInstance=function(){return r.instance||(r.instance=new r)},r.instance=null,o=r,i.AudioPlayer=o}(alm=alm||{}),function(t){var n,e;function i(t){var e=this;void 0===t&&(t=1),this.timerHandler=function(){++e.clipIndex==e.clipCount&&(e.clipIndex=0),e.playCurrent()},this.audioPlayer=n.AudioPlayer.getInstance(),this.clipCount=0,this.clipIndex=0,this.clipIds=[],this.clip=null,this.isPlaying=!1,this.volume=1,this.crossOverDuration=t,this.timeoutId=-1}n=t.audio||(t.audio={}),i.prototype.add=function(t,e){void 0===e&&(e=1);var n=t+"-"+this.clipCount;this.audioPlayer.add(t,e,n),this.clipIds.push(n),this.clipCount=this.clipIds.length},i.prototype.play=function(){this.isPlaying||(this.isPlaying=!0,this.playCurrent())},i.prototype.stop=function(){this.isPlaying&&(this.isPlaying=!1,this.stopCurrent())},i.prototype.setVolume=function(t){this.volume=t,this.clip&&this.clip.setVolume(this.volume)},i.prototype.playCurrent=function(){this.clip=this.audioPlayer.getClip(this.clipIds[this.clipIndex]),this.clip.setVolume(this.volume),this.clip.play(!1,!0);var t=1e3*(this.clip.getDuration()-this.crossOverDuration);this.timeoutId=window.setTimeout(this.timerHandler,t)},i.prototype.stopCurrent=function(){-1!=this.timeoutId&&(window.clearTimeout(this.timeoutId),this.timeoutId=-1),this.clip&&(this.clip.stop(),this.clip=null)},e=i,n.CrossOverLoopAudio=e}(alm=alm||{}),function(t){var n,e,i,o;function r(t,e){var i=this;void 0===t&&(t=.12),void 0===e&&(e=.6),this.timerHandler=function(){var t,e=i.isWaitingForFirstStep?.5*i.interval:i.interval,n=(new Date).getTime();n-i.startTime>=1e3*e&&(i.startTime=n,i.isWaitingForFirstStep=!1,++i.clipIndex>=i.clipCount&&(i.clipIndex=0),t=i.clipIds[i.clipIndex],i.audioPlayer.getClip(t).setVolume(i.volume),i.audioPlayer.getClip(t).play(!1,!0))},this.audioPlayer=n.AudioPlayer.getInstance(),this.intervalMin=t,this.intervalMax=e,this.intervalId=-1,this.interval=this.intervalMax,this.clipIndex=-1,this.clipCount=0,this.clipIds=[],this.isPlaying=!1,this.volume=1}n=t.audio||(t.audio={}),e=t.util.Num,i=t.math.Easing,r.prototype.add=function(t,e){void 0===e&&(e=1);var n=t+"-"+this.clipCount;this.audioPlayer.add(t,e,n),this.clipIds.push(n),this.clipCount=this.clipIds.length},r.prototype.play=function(t){void 0===t&&(t=!0),this.isPlaying||(this.isPlaying=!0,this.isWaitingForFirstStep=!0,this.startTime=t?0:(new Date).getTime(),this.intervalId=window.setInterval(this.timerHandler,1e3/60),this.timerHandler())},r.prototype.stop=function(){this.isPlaying&&(this.isPlaying=!1,window.clearInterval(this.intervalId))},r.prototype.setSpeed=function(t){this.interval=e.ease(t,0,1,this.intervalMax,this.intervalMin,i.easeOutSine)},r.prototype.setVolume=function(t){this.volume=t},o=r,n.FootstepAudio=o}(alm=alm||{}),function(t){var e,n,i,o;function r(t,e){return n.call(this,t,e)||this}e=t.view||(t.view={}),i=t.event.Event,__extends(r,n=i),r.prototype.clone=function(){return new r(this.type,this.target)},r.prototype.toString=function(){return"[ViewEvent] type = "+this.type},r.INITIALIZE_BEGIN="initializeBegin",r.INITIALIZE_END="initializeEnd",r.FINALIZE_BEGIN="finalizeBegin",r.FINALIZE_END="finalizeEnd",r.READY_BEGIN="readyBegin",r.READY_END="readyEnd",r.SHOW_BEGIN="showBegin",r.SHOW_END="showEnd",r.HIDE_BEGIN="hideBegin",r.HIDE_END="hideEnd",o=r,e.ViewEvent=o}(alm=alm||{}),function(t){var i,o,e,r,n;function s(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var n=o.call(this)||this;return n.id=null!=e?e:String(s.viewCount),n.view=t,n.name="",n.autoHideWithInit=!0,n.isInitializing=!1,n.isInitialized=!1,n.isFinalizing=!1,n.isFinalized=!1,n.isReadying=!1,n.isReadied=!1,n.isShowing=!1,n.isShown=!0,n.isHiding=!1,s.viewsById[n.id]&&r.warn("view id '"+n.id+"' is duplicate"),s.viewsById[n.id]=n,++s.viewCount,n}i=t.view||(t.view={}),e=t.event.EventDispatcher,r=t.debug.Logger,__extends(s,o=e),s.prototype.initialize=function(){this.isInitializing||this.isInitialized||(this.isInitializing=!0,this.dispatchEvent(new i.ViewEvent(i.ViewEvent.INITIALIZE_BEGIN,this)),this.view=this.implInitialize(),this.isInitializing?(throwError(this.name||this,"view is not assigned",!this.view),this.autoHideWithInit&&this.hide(!1),this.isInitializing=!1,this.isInitialized=!0,this.dispatchEvent(new i.ViewEvent(i.ViewEvent.INITIALIZE_END,this))):this.view=null)},s.prototype.ready=function(){this.isReadying||this.isReadied||(this.isReadying=!0,throwError(this.name||this,"ready() must be called after initialize()",!this.isInitialized),this.dispatchEvent(new i.ViewEvent(i.ViewEvent.READY_BEGIN,this)),this.implReady(),this.isReadying=!1,this.isReadied=!0,this.dispatchEvent(new i.ViewEvent(i.ViewEvent.READY_END,this)))},s.prototype.finalize=function(){(this.isInitializing||this.isInitialized)&&(this.isFinalizing&&this.isFinalized||(this.isFinalizing=!0,this.dispatchEvent(new i.ViewEvent(i.ViewEvent.FINALIZE_BEGIN,this)),this.implFinalize(),this.isFinalizing=!1,this.isFinalized=!0,this.isInitializing=!1,this.isInitialized=!1,this.dispatchEvent(new i.ViewEvent(i.ViewEvent.FINALIZE_END,this)),delete s.viewsById[this.id],s.viewsById[this.id]=null))},s.prototype.show=function(t){void 0===t&&(t=!0),this.isShown||this.getShowCommand(t).execute()},s.prototype.hide=function(t){void 0===t&&(t=!0),this.isShown&&this.getHideCommand(t).execute()},s.prototype.getShowCommand=function(t){var e=this;void 0===t&&(t=!0);var n=new cmd.Serial;return n.addCommand(new cmd.Func(function(){e.isShown||(throwError(e.name||e,"getShowCommand() is must be called after initialize()",e.isInitializing||!e.isInitialized),throwWarn(e.name||e,"getShowCommand() is must be called after ready()",e.isReadying||!e.isReadied),e.isShown=!0,e.isShowing=!0,e.isHiding=!1,e.showCommand&&(e.showCommand.interrupt(),e.showCommand=null),e.hideCommand&&(e.hideCommand.interrupt(),e.hideCommand=null),e.showCommand=n,e.dispatchEvent(new i.ViewEvent(i.ViewEvent.SHOW_BEGIN,e)),n.insertCommand(e.implShow(e.view,t),new cmd.Func(function(){e.showCommand=null,e.isShowing=!1,e.dispatchEvent(new i.ViewEvent(i.ViewEvent.SHOW_END,e))})))})),n},s.prototype.getHideCommand=function(t){var e=this;void 0===t&&(t=!0);var n=new cmd.Serial;return n.addCommand(new cmd.Func(function(){e.isShown&&(e.isInitializing||(throwError(e.name||e,"getHideCommand() is must be called after initialize()",e.isInitializing||!e.isInitialized),throwWarn(e.name||e,"getHideCommand() is must be called after ready()",e.isReadying||!e.isReadied)),e.isShown=!1,e.isShowing=!1,e.isHiding=!0,e.showCommand&&(e.showCommand.interrupt(),e.showCommand=null),e.hideCommand&&(e.hideCommand.interrupt(),e.hideCommand=null),e.hideCommand=n,e.dispatchEvent(new i.ViewEvent(i.ViewEvent.HIDE_BEGIN,e)),n.insertCommand(e.implHide(e.view,t),new cmd.Func(function(){e.hideCommand=null,e.isHiding=!1,e.dispatchEvent(new i.ViewEvent(i.ViewEvent.HIDE_END,e))})))})),n},s.prototype.getIsInitializing=function(){return this.isInitializing},s.prototype.getIsInitialized=function(){return this.isInitialized},s.prototype.getIsReadying=function(){return this.isReadying},s.prototype.getIsReadied=function(){return this.isReadied},s.prototype.getIsShowing=function(){return this.isShowing},s.prototype.getIsShown=function(){return this.isShown},s.prototype.getIsHiding=function(){return this.isHiding},s.prototype.getIsHidden=function(){return!this.isShown},s.prototype.getIsFinalizing=function(){return this.isFinalizing},s.prototype.getIsFinalized=function(){return this.isFinalized},s.prototype.getId=function(){return this.id},s.prototype.getView=function(){return this.view},s.prototype.getName=function(){return this.name},s.prototype.setName=function(t){this.name=t},s.prototype.getAutoHideWithInit=function(){return this.autoHideWithInit},s.prototype.setAutoHideWithInit=function(t){this.autoHideWithInit=t},s.getViewById=function(t){return s.viewsById[t]},s.viewCount=0,s.viewsById={},n=s,i.View=n}(alm=alm||{}),function(t){var e,n;function i(t,e,n,i,o){var r=this;void 0===e&&(e=null),void 0===n&&(n=!0),void 0===i&&(i=!0),void 0===o&&(o=!0),this.mouseOverHandler=function(t){r.isPreventDefaultEnabled&&t.preventDefault(),r.isStopPropagationEnabled&&t.stopPropagation(),r.over(),r.applyMouseCursor()},this.mouseOutHandler=function(t){r.isPreventDefaultEnabled&&t.preventDefault(),r.isStopPropagationEnabled&&t.stopPropagation(),r.out(),r.applyMouseCursor()},this.mouseDownHandler=function(t){r.isPreventDefaultEnabled&&t.preventDefault(),r.isStopPropagationEnabled&&t.stopPropagation(),r.down()},this.mouseUpHandler=function(t){r.isPreventDefaultEnabled&&t.preventDefault(),r.isStopPropagationEnabled&&t.stopPropagation(),r.up()},this.clickHandler=function(t){r.isPreventDefaultEnabled&&t.preventDefault(),r.isStopPropagationEnabled&&t.stopPropagation(),r.click()},this.touchStartHandler=function(t){r.isPreventDefaultEnabled&&t.preventDefault(),r.isStopPropagationEnabled&&t.stopPropagation(),r.down()},this.touchEndHandler=function(t){r.isPreventDefaultEnabled&&t.preventDefault(),r.isStopPropagationEnabled&&t.stopPropagation(),r.up(),r.click()},this.touchCancelHandler=function(t){r.isPreventDefaultEnabled&&t.preventDefault(),r.isStopPropagationEnabled&&t.stopPropagation(),r.up()},this.target=t,this.hitArea=null,this.isHoverCursorEnabled=n,this.isPreventDefaultEnabled=i,this.isStopPropagationEnabled=o,this.isEnabled=!0,this.isOver=!1,this.isDown=!1,this.isOverInternal=!1,this.isDownInternal=!1,this.defaultMouseCursor="",this.setHitArea(e)}e=t.view||(t.view={}),i.prototype.over=function(t){if(void 0===t&&(t=!0),this.isOverInternal=!0,this.isEnabled){if(this.isOver)return;this.isOver=!0,this.target.implButtonOver(t)}},i.prototype.out=function(t){void 0===t&&(t=!0),this._out(!0,t)},i.prototype._out=function(t,e){if(void 0===e&&(e=!0),this.isOverInternal=!1,this.isEnabled||!t){if(!this.isOver)return;this.isOver=!1,this.target.implButtonOut(e)}},i.prototype.down=function(t){if(void 0===t&&(t=!0),this.isDownInternal=!0,this.isEnabled){if(this.isDown)return;this.isDown=!0,this.target.implButtonDown(t)}},i.prototype.up=function(t){void 0===t&&(t=!0),this._up(!0,t)},i.prototype._up=function(t,e){if(void 0===e&&(e=!0),this.isDownInternal=!1,this.isEnabled||!t){if(!this.isDown)return;this.isDown=!1,this.target.implButtonUp(e)}},i.prototype.click=function(t){void 0===t&&(t=!0),this.isEnabled&&this.target.implButtonClick(t)},i.prototype.on=function(){null!=this.hitArea&&(this.hitArea.addEventListener("mouseover",this.mouseOverHandler),this.hitArea.addEventListener("mouseout",this.mouseOutHandler),this.hitArea.addEventListener("mousedown",this.mouseDownHandler),this.hitArea.addEventListener("mouseup",this.mouseUpHandler),this.hitArea.addEventListener("click",this.clickHandler),this.hitArea.addEventListener("touchstart",this.touchStartHandler),this.hitArea.addEventListener("touchend",this.touchEndHandler),this.hitArea.addEventListener("touchcancel",this.touchCancelHandler))},i.prototype.off=function(){null!=this.hitArea&&(this.hitArea.removeEventListener("mouseover",this.mouseOverHandler),this.hitArea.removeEventListener("mouseout",this.mouseOutHandler),this.hitArea.removeEventListener("mousedown",this.mouseDownHandler),this.hitArea.removeEventListener("mouseup",this.mouseUpHandler),this.hitArea.removeEventListener("click",this.clickHandler),this.hitArea.removeEventListener("touchstart",this.touchStartHandler),this.hitArea.removeEventListener("touchend",this.touchEndHandler),this.hitArea.removeEventListener("touchcancel",this.touchCancelHandler))},i.prototype.getIsEnabled=function(){return this.isEnabled},i.prototype.setIsEnabled=function(t,e){void 0===e&&(e=!0),this.isEnabled!=t&&(this.isEnabled=t,this.isEnabled?(this.isOverInternal&&this.over(),this.isDownInternal&&this.down()):(this.isOver&&(this._out(!1),this.isOverInternal=!0),this.isDown&&(this._up(!1),this.isDownInternal=!0)),this.target.implButtonChangeEnabled(this.isEnabled,e))},i.prototype.getIsOver=function(){return this.isOver},i.prototype.getIsDown=function(){return this.isDown},i.prototype.getHitArea=function(){return this.hitArea},i.prototype.setHitArea=function(t){this.hitArea!==t&&(this.off(),this.hitArea=t,this.on())},i.prototype.clearHitArea=function(){this.setHitArea(null)},i.prototype.getIsPreventDefaultEnabled=function(){return this.isPreventDefaultEnabled},i.prototype.setIsPreventDefaultEnabled=function(t){this.isPreventDefaultEnabled=t},i.prototype.getIsStopPropagationEnabled=function(){return this.isStopPropagationEnabled},i.prototype.setIsStopPropagationEnabled=function(t){this.isStopPropagationEnabled=t},i.prototype.getIsHoverCursorEnabled=function(){return this.isHoverCursorEnabled},i.prototype.setIsHoverCursorEnabled=function(t){this.isHoverCursorEnabled=t},i.prototype.applyMouseCursor=function(){this.isHoverCursorEnabled&&(this.isOverInternal&&this.isEnabled&&null!=this.hitArea?(this.defaultMouseCursor=this.hitArea.style.cursor,this.hitArea.style.cursor="pointer"):this.hitArea.style.cursor=""!=this.defaultMouseCursor?this.defaultMouseCursor:"auto")},n=i,e.ButtonBehavior=n}(alm=alm||{}),function(t){var e,n;function i(t){this.target=t}e=t.view||(t.view={}),i.prototype.select=function(t){void 0===t&&(t=!0),this.isSelected||(this.isSelected=!0,this.target.implSelectionChanged(this.isSelected,t))},i.prototype.deselect=function(t){void 0===t&&(t=!0),this.isSelected&&(this.isSelected=!1,this.target.implSelectionChanged(this.isSelected,t))},i.prototype.getIsSelected=function(){return this.isSelected},n=i,e.SelectionBehavior=n}(alm=alm||{}),function(t){var e,n;function i(){}e=t.browser||(t.browser={}),i.initialize=function(){var t;this.isInitialized||(this.isInitialized=!0,t=window.navigator.userAgent.toLowerCase(),this.isTablet=-1!=t.indexOf("windows")&&-1!=t.indexOf("touch")||-1!=t.indexOf("ipad")||-1!=t.indexOf("android")&&-1==t.indexOf("mobile")||-1!=t.indexOf("firefox")&&-1!=t.indexOf("tablet")||-1!=t.indexOf("kindle")||-1!=t.indexOf("silk")||-1!=t.indexOf("playbook"),this.isMobile=-1!=t.indexOf("windows")&&-1!=t.indexOf("phone")||-1!=t.indexOf("iphone")||-1!=t.indexOf("ipod")||-1!=t.indexOf("android")&&-1!=t.indexOf("mobile")||-1!=t.indexOf("firefox")&&-1!=t.indexOf("mobile")||-1!=t.indexOf("blackberry"),this.isDesktop=!this.isTablet&&!this.isMobile,this.isIOS=-1!=t.indexOf("ipad")||-1!=t.indexOf("iphone")||-1!=t.indexOf("ipod"),this.isAndroid=-1!=t.indexOf("android")&&-1!=t.indexOf("mobile"),-1!=t.indexOf("msie")||-1!=t.indexOf("trident")?this.isIE=!0:-1!=t.indexOf("edge")?this.isEdge=!0:-1!=t.indexOf("chrome")?this.isChrome=!0:-1!=t.indexOf("safari")?this.isSafari=!0:-1!=t.indexOf("firefox")?this.isFireFox=!0:-1!=t.indexOf("opera")?this.isOpera=!0:this.isUnknownBrowser=!0,this.isTouchEnabled=void 0!==window.ontouchstart,this.isDownloadEnabled=!this.isIOS,this.devicePixelRatio=window.devicePixelRatio,this.isRetina=1<this.devicePixelRatio)},i.getIsDesktop=function(){return this.initialize(),this.isDesktop},i.getIsTablet=function(){return this.initialize(),this.isTablet},i.getIsMobile=function(){return this.initialize(),this.isMobile},i.getIsIOS=function(){return this.initialize(),this.isIOS},i.getIsAndroid=function(){return this.initialize(),this.isAndroid},i.getIsIE=function(){return this.initialize(),this.isIE},i.getIsEdge=function(){return this.initialize(),this.isEdge},i.getIsChrome=function(){return this.initialize(),this.isChrome},i.getIsSafari=function(){return this.initialize(),this.isSafari},i.getIsFireFox=function(){return this.initialize(),this.isFireFox},i.getIsOpera=function(){return this.initialize(),this.isOpera},i.getIsUnknownBrowser=function(){return this.initialize(),this.isUnknownBrowser},i.getIsTouchEnabled=function(){return this.initialize(),this.isTouchEnabled},i.getIsDownloadEnabled=function(){return this.initialize(),this.isDownloadEnabled},i.getIsRetina=function(){return this.initialize(),this.isRetina},i.getDevicePixelRatio=function(){return this.initialize(),this.devicePixelRatio},i.getDpi=function(){var t;return-1==this.dpi&&((t=document.createElement("div")).setAttribute("style","height:1in;left:-100%;top:-100%;position:absolute;width:1in;"),document.body.appendChild(t),this.dpi=t.offsetHeight,document.body.removeChild(t)),this.dpi},i.isDesktop=!1,i.isTablet=!1,i.isMobile=!1,i.isIOS=!1,i.isAndroid=!1,i.isIE=!1,i.isEdge=!1,i.isChrome=!1,i.isSafari=!1,i.isFireFox=!1,i.isOpera=!1,i.isUnknownBrowser=!1,i.isTouchEnabled=!1,i.isDownloadEnabled=!1,i.isRetina=!1,i.devicePixelRatio=1,i.dpi=-1,i.isInitialized=!1,n=i,e.DeviceInfo=n}(alm=alm||{}),function(t){var e,o,n;function r(){}e=t.browser||(t.browser={}),o=t.util.Time,r.save=function(t,e,n){if(void 0===n&&(n=-1),!r.isAvailable())return!1;var i={value:JSON.stringify(e),expiredAt:n};return localStorage.setItem(t,JSON.stringify(i)),!0},r.saveWithTerm=function(t,e,n){void 0===n&&(n=-1);var i=0<n?o.now()+n:-1;return r.save(t,e,i)},r.load=function(t,e){if(void 0===e&&(e=null),!r.isAvailable())return e;var n=JSON.parse(localStorage.getItem(t));return n?!(0<n.expiredAt)||o.now()<n.expiredAt?JSON.parse(n.value):(localStorage.removeItem(t),e):e},r.remove=function(t){r.isAvailable()&&localStorage.removeItem(t)},r.isAvailable=function(){if(null==r.isAvailable_)try{localStorage.setItem("__CKECK__","__CKECK__"),localStorage.removeItem("__CKECK__"),r.isAvailable_=!0}catch(t){r.isAvailable_=!1}return r.isAvailable_},r.toMilliseconds=function(t,e,n,i,o){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=0),o+1e3*(i+60*(n+60*(e+24*t)))},r.isAvailable_=null,n=r,e.LocalStorage=n}(alm=alm||{}),function(o){!function(n){var t;(t=n.KeyCode||(n.KeyCode={}))[t.Backspace=8]="Backspace",t[t.Tab=9]="Tab",t[t.Enter=13]="Enter",t[t.Shift=16]="Shift",t[t.Ctrl=17]="Ctrl",t[t.Alt=18]="Alt",t[t.PauseBreak=19]="PauseBreak",t[t.CapsLock=20]="CapsLock",t[t.Escape=27]="Escape",t[t.Space=32]="Space",t[t.PageUp=33]="PageUp",t[t.PageDown=34]="PageDown",t[t.End=35]="End",t[t.Home=36]="Home",t[t.LeftArrow=37]="LeftArrow",t[t.UpArrow=38]="UpArrow",t[t.RightArrow=39]="RightArrow",t[t.DownArrow=40]="DownArrow",t[t.Insert=45]="Insert",t[t.Delete=46]="Delete",t[t.Key0=48]="Key0",t[t.Key1=49]="Key1",t[t.Key2=50]="Key2",t[t.Key3=51]="Key3",t[t.Key4=52]="Key4",t[t.Key5=53]="Key5",t[t.Key6=54]="Key6",t[t.Key7=55]="Key7",t[t.Key8=56]="Key8",t[t.Key9=57]="Key9",t[t.ClosedParen=48]="ClosedParen",t[t.ExclamationMark=49]="ExclamationMark",t[t.AtSign=50]="AtSign",t[t.PoundSign=51]="PoundSign",t[t.Hash=51]="Hash",t[t.DollarSign=52]="DollarSign",t[t.PercentSign=53]="PercentSign",t[t.Caret=54]="Caret",t[t.Hat=54]="Hat",t[t.Ampersand=55]="Ampersand",t[t.Star=56]="Star",t[t.Asterik=56]="Asterik",t[t.OpenParen=57]="OpenParen",t[t.A=65]="A",t[t.B=66]="B",t[t.C=67]="C",t[t.D=68]="D",t[t.E=69]="E",t[t.F=70]="F",t[t.G=71]="G",t[t.H=72]="H",t[t.I=73]="I",t[t.J=74]="J",t[t.K=75]="K",t[t.L=76]="L",t[t.M=77]="M",t[t.N=78]="N",t[t.O=79]="O",t[t.P=80]="P",t[t.Q=81]="Q",t[t.R=82]="R",t[t.S=83]="S",t[t.T=84]="T",t[t.U=85]="U",t[t.V=86]="V",t[t.W=87]="W",t[t.X=88]="X",t[t.Y=89]="Y",t[t.Z=90]="Z",t[t.LeftWindowKey=91]="LeftWindowKey",t[t.RightWindowKey=92]="RightWindowKey",t[t.SelectKey=93]="SelectKey",t[t.Numpad0=96]="Numpad0",t[t.Numpad1=97]="Numpad1",t[t.Numpad2=98]="Numpad2",t[t.Numpad3=99]="Numpad3",t[t.Numpad4=100]="Numpad4",t[t.Numpad5=101]="Numpad5",t[t.Numpad6=102]="Numpad6",t[t.Numpad7=103]="Numpad7",t[t.Numpad8=104]="Numpad8",t[t.Numpad9=105]="Numpad9",t[t.Multiply=106]="Multiply",t[t.Add=107]="Add",t[t.Subtract=109]="Subtract",t[t.DecimalPoint=110]="DecimalPoint",t[t.Divide=111]="Divide",t[t.F1=112]="F1",t[t.F2=113]="F2",t[t.F3=114]="F3",t[t.F4=115]="F4",t[t.F5=116]="F5",t[t.F6=117]="F6",t[t.F7=118]="F7",t[t.F8=119]="F8",t[t.F9=120]="F9",t[t.F10=121]="F10",t[t.F11=122]="F11",t[t.F12=123]="F12",t[t.NumLock=144]="NumLock",t[t.ScrollLock=145]="ScrollLock",t[t.SemiColon=186]="SemiColon",t[t.Equals=187]="Equals",t[t.Comma=188]="Comma",t[t.Dash=189]="Dash",t[t.Period=190]="Period",t[t.UnderScore=189]="UnderScore",t[t.PlusSign=187]="PlusSign",t[t.ForwardSlash=191]="ForwardSlash",t[t.Tilde=192]="Tilde",t[t.GraveAccent=192]="GraveAccent",t[t.OpenBracket=219]="OpenBracket",t[t.ClosedBracket=221]="ClosedBracket",t[t.Quote=222]="Quote";var e=(i.initialize=function(){this.isInitialized||(this.isInitialized=!0,this.eventDispatcher=new o.event.EventDispatcher)},i.start=function(){this.isRunning||(this.isRunning=!0,this.initialize(),trace("[KeyWatcher] start"),window.addEventListener("keydown",this.windowKeyDownHandler),window.addEventListener("keyup",this.windowKeyUpHandler))},i.stop=function(){this.isRunning&&(this.isRunning=!1,this.initialize(),trace("[KeyWatcher] stop"),window.removeEventListener("keydown",this.windowKeyDownHandler),window.removeEventListener("keyup",this.windowKeyUpHandler))},i.addEventListener=function(t,e){this.initialize(),this.eventDispatcher.addEventListener(t,e)},i.removeEventListener=function(t,e){this.initialize(),this.eventDispatcher.removeEventListener(t,e)},i.getIsRunning=function(){return this.isRunning},i.getIsAnyKeyPressed=function(){return 0<this.pressedKeyCount},i.getIsKeyPressed=function(t){return null!=this.isKeyPressedByKeyCode[t]},i.getIsContinuousPressEnabled=function(){return this.isContinuousPressEnabled},i.setIsContinuousPressEnabled=function(t){this.isContinuousPressEnabled=t},i.windowKeyDownHandler=function(t){var e=t.keyCode;null==i.isKeyPressedByKeyCode[e]?(i.isKeyPressedByKeyCode[e]=!0,++i.pressedKeyCount,i.eventDispatcher.dispatchEvent(new n.KeyWatcherEvent(n.KeyWatcherEvent.KEY_DOWN,i,t))):i.isContinuousPressEnabled&&i.eventDispatcher.dispatchEvent(new n.KeyWatcherEvent(n.KeyWatcherEvent.KEY_DOWN,i,t))},i.windowKeyUpHandler=function(t){var e=t.keyCode;null!=i.isKeyPressedByKeyCode[e]&&(delete i.isKeyPressedByKeyCode[e],--i.pressedKeyCount,i.eventDispatcher.dispatchEvent(new n.KeyWatcherEvent(n.KeyWatcherEvent.KEY_UP,i,t)))},i.isRunning=!1,i.pressedKeyCount=0,i.isKeyPressedByKeyCode={},i.isContinuousPressEnabled=!1,i.isInitialized=!1,i.isLongPressed=!1,i.eventDispatcher=null,i);function i(){}n.KeyWatcher=e}(o.browser||(o.browser={}))}(alm=alm||{}),function(t){var e,o,n;function i(t,e,n){void 0===n&&(n=null);var i=o.call(this,t,e)||this;return i.originalEvent=n,i.key=i.originalEvent.key,i.keyCode=i.originalEvent.keyCode,i.altKey=i.originalEvent.altKey,i.ctrlKey=i.originalEvent.ctrlKey,i.shiftKey=i.originalEvent.shiftKey,i}e=t.browser||(t.browser={}),o=t.event.Event,__extends(i,o),i.prototype.clone=function(){return new i(this.type,this.target,this.originalEvent)},i.prototype.toString=function(){return"[KeyWatcherEvent] type = "+this.type+", key = "+this.key+", keyCode = "+this.keyCode+", altKey = "+this.altKey+", ctrlKey = "+this.ctrlKey+", shiftKey = "+this.shiftKey},i.KEY_UP="keyUp",i.KEY_DOWN="keyDown",n=i,e.KeyWatcherEvent=n}(alm=alm||{}),function(t){var e,n;function i(){}e=t.browser||(t.browser={}),i.initialize=function(){this.isInitialized||(this.isInitialized=!0,this.eventDispatcher=new t.event.EventDispatcher)},i.start=function(t){void 0===t&&(t=null),this.isRunning||(this.isRunning=!0,this.initialize(),trace("[WindowWatcher] start"),this.window=t||window,this.window.addEventListener("resize",this.windowResizeHandler),this.window.addEventListener("orientationchange",this.windowResizeHandler),this.window.addEventListener("scroll",this.windowScrollHandler),this.apply())},i.stop=function(){this.isRunning&&(this.isRunning=!1,this.initialize(),trace("[WindowWatcher] stop"),this.window.removeEventListener("resize",this.windowResizeHandler),this.window.removeEventListener("orientationchange",this.windowResizeHandler),this.window.removeEventListener("scroll",this.windowScrollHandler))},i.apply=function(){this.windowWidth=this.window.innerWidth,this.windowHeight=this.window.innerHeight,this.scrollTop=void 0!==this.window.pageYOffset?this.window.pageYOffset:document.documentElement.scrollTop,this.scrollBottom=this.scrollTop+this.windowHeight},i.addEventListener=function(t,e){this.initialize(),this.eventDispatcher.addEventListener(t,e)},i.removeEventListener=function(t,e){this.initialize(),this.eventDispatcher.removeEventListener(t,e)},i.calcScrolledPosition=function(t){return t-this.scrollTop},i.calcScrolledPositionRatio=function(t){return this.calcScrolledPosition(t)/this.windowHeight},i.resize=function(t){i.apply(),i.eventDispatcher.dispatchEvent(new e.WindowWatcherEvent(e.WindowWatcherEvent.RESIZE,i,t,i.scrollTop,i.scrollBottom,i.windowWidth,i.windowHeight))},i.getIsRunning=function(){return this.isRunning},i.getWindow=function(){return this.window},i.getScrollTop=function(){return this.scrollTop},i.getScrollBottom=function(){return this.scrollBottom},i.getWindowWidth=function(){return this.windowWidth},i.getWindowHeight=function(){return this.windowHeight},i.getIsMobileOrientationResize=function(){return this.isMobileOrientationResize},i.setIsMobileOrientationResize=function(t){this.isMobileOrientationResize=t},i.windowResizeHandler=function(t){!e.DeviceInfo.getIsDesktop()&&i.isMobileOrientationResize||(trace("[WindowWatcher] resize by window.resize"),i.resize(t))},i.windowOrientationChangeHandler=function(t){!e.DeviceInfo.getIsDesktop()&&i.isMobileOrientationResize&&(trace("[WindowWatcher] resize by window.orientationchange"),i.resize(t))},i.windowScrollHandler=function(t){i.apply(),i.eventDispatcher.dispatchEvent(new e.WindowWatcherEvent(e.WindowWatcherEvent.SCROLL,i,t,i.scrollTop,i.scrollBottom,i.windowWidth,i.windowHeight))},i.isRunning=!1,i.window=null,i.windowWidth=0,i.windowHeight=0,i.isMobileOrientationResize=!0,i.isInitialized=!1,i.eventDispatcher=null,n=i,e.WindowWatcher=n}(alm=alm||{}),function(t){var e,u,n;function i(t,e,n,i,o,r,s){void 0===n&&(n=null),void 0===i&&(i=0),void 0===o&&(o=0),void 0===r&&(r=0),void 0===s&&(s=0);var a=u.call(this,t,e)||this;return a.originalEvent=n,a.scrollTop=i,a.scrollBottom=o,a.windowWidth=r,a.windowHeight=s,a}e=t.browser||(t.browser={}),u=t.event.Event,__extends(i,u),i.prototype.clone=function(){return new i(this.type,this.target,this.originalEvent,this.scrollTop,this.scrollBottom,this.windowWidth,this.windowHeight)},i.prototype.toString=function(){return"[WindowWatcherEvent] type = "+this.type+", scrollTop = "+this.scrollTop+", scrollBottom = "+this.scrollBottom+", windowWidth = "+this.windowWidth+", windowHeight = "+this.windowHeight},i.SCROLL="scroll",i.RESIZE="resize",n=i,e.WindowWatcherEvent=n}(alm=alm||{}),function(t){var e,r,n;function i(t,e,n,i){var o=r.call(this,t,e)||this;return o.currentSectionIndex=n,o.prevSectionIndex=i,o}e=t.browser||(t.browser={}),r=t.event.Event,__extends(i,r),i.CHANGE="ScrollSectionTriggerEvent.CHANGE",n=i,e.ScrollSectionTriggerEvent=n}(alm=alm||{}),function(t){var u,n,h,e,i,o,r;function s(t){void 0===t&&(t=.5);var e=n.call(this)||this;return e.windowScrollHandler=function(t){e.updateScrollPosition(),e.check()},e.windowResizeHandler=function(t){e.updateThresholdPosition(),e.updateScrollPosition(),e.check()},e.isRunning=!1,e.scrollPosition=null,e.triggerPositions=[],e.thresholdRatio=t,e.thresholdPosition=null,e.currentSectionIndex=-1,e.prevSectionIndex=-1,e}u=t.browser||(t.browser={}),h=t.debug.Logger,e=t.browser.WindowWatcher,i=t.browser.WindowWatcherEvent,o=t.event.EventDispatcher,__extends(s,n=o),s.prototype.start=function(){this.isRunning||(this.isRunning=!0,e.addEventListener(i.SCROLL,this.windowScrollHandler),e.addEventListener(i.RESIZE,this.windowResizeHandler),e.start(),this.updateThresholdPosition(),this.updateScrollPosition(),this.check())},s.prototype.stop=function(){this.isRunning&&(this.isRunning=!1,e.removeEventListener(i.SCROLL,this.windowScrollHandler),e.removeEventListener(i.RESIZE,this.windowResizeHandler),e.stop())},s.prototype.getIsRunning=function(){return this.isRunning},s.prototype.getCurrentIndex=function(){return this.currentSectionIndex},s.prototype.getPrevIndex=function(){return this.prevSectionIndex},s.prototype.getTriggerPositions=function(){return this.triggerPositions.concat()},s.prototype.setTriggerPositions=function(t){this.triggerPositions=t.concat(),this.triggerPositions.sort(function(t,e){return t-e}),this.isRunning&&this.check()},s.prototype.getThreshold=function(){return this.thresholdRatio},s.prototype.setThreshold=function(t){this.thresholdRatio=t,this.updateThresholdPosition(),this.isRunning&&this.check()},s.prototype.check=function(){if(null!=this.scrollPosition){for(var t,e=-1,n=-1,i=Number.MAX_VALUE,o=this.triggerPositions.length,r=0;r<o;++r){var s=this.triggerPositions[r]-this.scrollPosition,a=Math.abs(s-this.thresholdPosition);a<i&&(i=a,e=r,n=s)}0<=e&&(t=-1,t=n>this.thresholdPosition?e:e+1,this.currentSectionIndex!=t&&(this.prevSectionIndex=this.currentSectionIndex,this.currentSectionIndex=t,this.dispatchEvent(new u.ScrollSectionTriggerEvent(u.ScrollSectionTriggerEvent.CHANGE,this,this.currentSectionIndex,this.prevSectionIndex))))}else h.warn("[RangeTrigger] current position is need set")},s.prototype.updateThresholdPosition=function(){this.thresholdPosition=e.getWindowHeight()*this.thresholdRatio},s.prototype.updateScrollPosition=function(){this.scrollPosition=e.getScrollTop()},r=s,u.ScrollSectionTrigger=r}(alm=alm||{}),function(t){var n,i,o,e,r,s;function a(){var e=i.call(this)||this;return e.windowResizeHandler=function(t){e.check()},e.breakPoints=[],e.breakPointCount=0,e.currentIndex=-1,e.prevIndex=-1,e}n=t.browser||(t.browser={}),o=t.browser.WindowWatcher,e=t.browser.WindowWatcherEvent,r=t.event.EventDispatcher,__extends(a,i=r),a.prototype.start=function(){this.isRunning||(this.isRunning=!0,o.addEventListener(e.RESIZE,this.windowResizeHandler),o.start(),this.check())},a.prototype.stop=function(){this.isRunning&&(this.isRunning=!1,o.removeEventListener(e.RESIZE,this.windowResizeHandler),o.stop())},a.prototype.setBreakpoints=function(t){this.breakPoints=t.concat(),this.breakPointCount=this.breakPoints.length,this.breakPoints.sort(function(t,e){return t-e}),this.isRunning&&this.check()},a.prototype.getIsRunning=function(){return this.isRunning},a.prototype.getCurrentIndex=function(){return this.currentIndex},a.prototype.getPrevIndex=function(){return this.prevIndex},a.prototype.getBreakPoints=function(){return this.breakPoints.concat()},a.prototype.getBreakPointCount=function(){return this.breakPointCount},a.prototype.check=function(){for(var t=o.getWindowWidth(),e=0;e<this.breakPointCount&&!(t<=this.breakPoints[e]);++e);this.currentIndex!=e&&(this.prevIndex=this.currentIndex,this.currentIndex=e,trace("[ResponsiveObserver] switch index :",this.prevIndex,"->",this.currentIndex,", window width =",t),this.dispatchEvent(new n.ResponsiveObserverEvent(n.ResponsiveObserverEvent.CHANGE,this,this.currentIndex,this.prevIndex)))},s=a,n.ResponsiveObserver=s}(alm=alm||{}),function(t){var e,r,n;function i(t,e,n,i){var o=r.call(this,t,e)||this;return o.currentIndex=n,o.prevIndex=i,o}e=t.browser||(t.browser={}),r=t.event.Event,__extends(i,r),i.CHANGE="ResponsiveObserverEvent.CHANGE",n=i,e.ResponsiveObserverEvent=n}(alm=alm||{}),function(i){var n,o=alm.debug.Logger,t=alm.event.EventDispatcher,e=(__extends(r,n=t),r.prototype.addChild=function(t){if(t){var e=t.name;if(!this.childrenByName[e])return++this.numChildren,(t.parent=this).childrenByName[e]=t;o.warn("[Scene '"+this.name+"'] addChild was failed, because child name '"+e+"' is already contained.")}else o.warn("[Scene '"+this.name+"'] addChild was failed, because child is null.");return null},r.prototype.removeChild=function(t){if(t){var e=t.name;if(this.childrenByName[e])return--this.numChildren,t.parent=null,delete this.childrenByName[e],t;o.warn("[Scene '"+this.name+"'] removeChild was failed, because child name '"+e+"' is not contained.")}else o.warn("[Scene '"+this.name+"'] removeChild was failed, because child is null.");return null},r.prototype.addChildren=function(t){for(var e,n=[],i=t.length,o=0;o<i;++o)(e=this.addChild(t[o]))&&n.push(e);return n},r.prototype.removeChildren=function(t){for(var e,n=[],i=t.length,o=0;o<i;++o)(e=this.removeChild(t[o]))&&n.push(e);return n},r.prototype.removeAllChildren=function(){var t,e=[];for(var n in this.childrenByName)(t=this.childrenByName[n]).parent=null,e.push(t);return this.childrenByName={},this.numChildren=0,e},r.prototype.contains=function(t){return!!t&&null!=this.childrenByName["string"==typeof t?t:t.name]},r.prototype.getName=function(){return this.name},r.prototype.getState=function(){return this.state},r.prototype.getLastState=function(){return this.lastState},r.prototype.getParent=function(){return this.parent},r.prototype.getChildByName=function(t){return this.childrenByName[t]},r.prototype.getNumChildren=function(){return this.numChildren},r.prototype.getManager=function(){return this.parent?this.parent.getManager():(o.warn("[Scene '"+this.name+"'] getManager was failed, check whether if scene is connected to root."),null)},r.prototype.getPath=function(){var t=this.getManager();if(t){for(var e=[this.name],n=this;n=n.parent;)e.unshift(n.name);return t.getScenePathByNames(e)}return o.warn("[Scene '"+this.name+"'] getPath was failed, check whether if scene is connected to root."),null},r.prototype.gotoScene=function(t){this.getManager().goto(t)},r.prototype._load=function(t){var e=this;this.transferInfo=t,this.state=i.SceneState.Loading,this.isEntered=!0;var n=new cmd.Serial(function(){e.dispatchEvent(new i.SceneEvent(i.SceneEvent.LOAD,e));var t="function"==typeof e.onLoad?e.onLoad():e.implOnLoad();t&&n.insertCommand(t)},function(){e.lastState=e.state,e.state=i.SceneState.Idling,e.dispatchEvent(new i.SceneEvent(i.SceneEvent.LOAD_COMPLETE,e))});n.execute()},r.prototype._unload=function(t){var e=this;this.transferInfo=t,this.state=i.SceneState.Unloading,this.isEntered=!1;var n=new cmd.Serial(function(){e.dispatchEvent(new i.SceneEvent(i.SceneEvent.UNLOAD,e));var t="function"==typeof e.onUnload?e.onUnload():e.implOnUnload();t&&n.insertCommand(t)},function(){e.lastState=e.state,e.state=i.SceneState.Idling,e.dispatchEvent(new i.SceneEvent(i.SceneEvent.UNLOAD_COMPLETE,e))});n.execute()},r.prototype._arrive=function(t){var e=this;this.transferInfo=t,this.state=i.SceneState.Arriving,this.isEntered=!0;var n=new cmd.Serial(function(){e.dispatchEvent(new i.SceneEvent(i.SceneEvent.ARRIVE,e));var t="function"==typeof e.onArrive?e.onArrive():e.implOnArrive();t&&n.insertCommand(t)},function(){e.lastState=e.state,e.state=i.SceneState.Idling,e.dispatchEvent(new i.SceneEvent(i.SceneEvent.ARRIVE_COMPLETE,e))});n.execute()},r.prototype._leave=function(t){var e=this;this.transferInfo=t,this.state=i.SceneState.Leaving,this.isEntered=!1;var n=new cmd.Serial(function(){e.dispatchEvent(new i.SceneEvent(i.SceneEvent.LEAVE,e));var t="function"==typeof e.onLeave?e.onLeave():e.implOnLeave();t&&n.insertCommand(t)},function(){e.lastState=e.state,e.state=i.SceneState.Idling,e.dispatchEvent(new i.SceneEvent(i.SceneEvent.LEAVE_COMPLETE,e))});n.execute()},r.prototype._ascend=function(t){var e=this;this.transferInfo=t,this.state=i.SceneState.Ascending,this.isEntered=!0;var n=new cmd.Serial(function(){e.dispatchEvent(new i.SceneEvent(i.SceneEvent.ASCEND,e));var t="function"==typeof e.onAscend?e.onAscend():e.implOnAscend();t&&n.insertCommand(t)},function(){e.lastState=e.state,e.state=i.SceneState.Idling,e.dispatchEvent(new i.SceneEvent(i.SceneEvent.ASCEND_COMPLETE,e))});n.execute()},r.prototype._descend=function(t){var e=this;this.transferInfo=t,this.state=i.SceneState.Descending,this.isEntered=!1;var n=new cmd.Serial(function(){e.dispatchEvent(new i.SceneEvent(i.SceneEvent.DESCEND,e));var t="function"==typeof e.onDescend?e.onDescend():e.implOnDescend();t&&n.insertCommand(t)},function(){e.lastState=e.state,e.state=i.SceneState.Idling,e.dispatchEvent(new i.SceneEvent(i.SceneEvent.DESCEND_COMPLETE,e))});n.execute()},r.prototype.implOnLoad=function(){return new cmd.Command},r.prototype.implOnUnload=function(){return new cmd.Command},r.prototype.implOnArrive=function(){return new cmd.Command},r.prototype.implOnLeave=function(){return new cmd.Command},r.prototype.implOnAscend=function(){return new cmd.Command},r.prototype.implOnDescend=function(){return new cmd.Command},r);function r(t){var e=n.call(this)||this;return e.name=t,e.state=i.SceneState.Idling,e.parent=null,e.childrenByName={},e.numChildren=0,e.isEntered=!1,e.onLoad=null,e.onUnload=null,e.onArrive=null,e.onLeave=null,e.onAscend=null,e.onDescend=null,e}i.Scene=e}(scn=scn||{}),function(t){var n,e=alm.event.Event,i=(__extends(o,n=e),o.prototype.clone=function(){return new o(this.type,this.target)},o.prototype.toString=function(){return"[SceneEvent] type = "+this.type},o.LOAD="load",o.UNLOAD="unload",o.ARRIVE="arrive",o.LEAVE="leave",o.ASCEND="ascend",o.DESCEND="descend",o.LOAD_COMPLETE="loadComplete",o.UNLOAD_COMPLETE="unloadComplete",o.ARRIVE_COMPLETE="arriveComplete",o.LEAVE_COMPLETE="leaveComplete",o.ASCEND_COMPLETE="ascendComplete",o.DESCEND_COMPLETE="descendComplete",o);function o(t,e){return n.call(this,t,e)||this}t.SceneEvent=i}(scn=scn||{}),function(m){var n,f=alm.debug.Logger,g=alm.debug.LoggerLevel,t=alm.event.EventDispatcher,e=(__extends(i,n=t),i.prototype.start=function(){f.verbose("----- scene manager start -----"),this.goto("/")},i.prototype.goto=function(t){var e,n;t=this.resolvePath(t),this.transferInfo&&this.transferInfo.getDestinationPath()==t||(n=[],0<(n=-1!=this.waypointIndex?this.createWaypoints(this.waypoints[this.waypointIndex].getPath(),t):[new m.core.Waypoint("/",0)]).length&&((e=null!=this.transferInfo)?(f.verbose("destination is changed"),f.verbose("waypoint index : "+this.waypointIndex),this.waypoints=this.waypoints.slice(0,this.waypointIndex+1).concat(n.slice(1)),this.setDirection(this.waypoints),this.printWaypoint(this.waypoints)):(this.waypointIndex=0,this.eventIndex=0,++this.transferId,this.waypoints=n),this.transferInfo=new m.SceneTransferInfo(this.transferId,this.waypoints[this.waypointIndex].getPath(),this.waypoints[this.waypoints.length-1].getPath()),e||this.dispatchEvent(new m.SceneManagerEvent(m.SceneManagerEvent.TRANSFER_START,this)),this.checkState()))},i.prototype.resolvePath=function(t){"/"!=t[0]&&(t=this.currentScene?this.currentScene.getPath()+"/"+t:"/"+t);for(var e=t.split("/"),n=[],i=0;i<e.length;++i){var o=e[i];""!=o&&"."!=o&&(".."!=o?n.push(o):n.pop())}return"/"+n.join("/")},i.prototype.addSceneAt=function(t,e){void 0===e&&(e=!1);for(var n=!1,i=this.getSceneNamesByPath(t),o=i.length,r=this.root,s=1;s<o;++s){var a=i[s];s==o-1?r.contains(a)?f.warn("[SceneManager '"+this.name+"'] addSceneAt was failed, because path '"+t+"' is already exist."):(r=r.addChild(new m.Scene(a)),n=!0):r=r.contains(a)?r.getChildByName(a):r.addChild(new m.Scene(a))}return n?r:null},i.prototype.getName=function(){return this.name},i.prototype.getRoot=function(){return this.root},i.prototype.getSceneByPath=function(t){for(var e=this.getSceneNamesByPath(t),n=e.length,i=this.root,o=1;o<n;++o)i=i.getChildByName(e[o]);return i},i.prototype.getSceneNamesByPath=function(t){return"/"==t?[""]:this.resolvePath(t).split("/")},i.prototype.getSceneLevelByNames=function(t){return t.length-1},i.prototype.getScenePathByNames=function(t){return 0==t.length?"/":1==t.length?"/"+t[0]:t.join("/")},i.prototype.createWaypoints=function(t,e){if(t==e)return f.warn("[SceneManager] departure path and destination path is same, path = '"+t+"'"),[];f.verbose("----- scene flow -----");var n=[new m.core.Waypoint(t,this.getSceneLevelByNames(this.getSceneNamesByPath(t)))],i=this.getSceneNamesByPath(t),o=this.getSceneNamesByPath(e);f.verbose("    path"),f.verbose("        current    : '"+t+"'"),f.verbose("        destination: '"+e+"'"),f.verbose("    names"),f.verbose("        current("+i.length+")    : '"+i+"'"),f.verbose("        destination("+o.length+"): '"+o+"'");var r,s=0,a=[];if("/"==e)s=-1,a=[],r="/";else{for(;;){if(i[s]!=o[s]){--s;break}a.push(i[s]),++s}r=this.getScenePathByNames(a)}f.verbose("    turning"),f.verbose("        path     : "+r),f.verbose("        level    : "+s),f.verbose("        names("+a.length+") : '"+a+"'");for(var u=i.concat(),h=t,c=i.length-1;s+1<c;--c)u.pop(),(d=this.getScenePathByNames(u))!=h&&(p=this.getSceneLevelByNames(u),n.push(new m.core.Waypoint(d,p)),h=d);if(r==e&&0<s)s==n[n.length-1].getLevel()?m.core.Direction.Sibling:m.core.Direction.Ascend,n.push(new m.core.Waypoint(r,s));else for(var u=a.concat(),l=n[n.length-1],h=l.getPath(),c=(l.getLevel(),s+1);c<o.length;++c){var d,p,v=o[c];u.push(v),(d=this.getScenePathByNames(u))!=h&&(p=this.getSceneLevelByNames(u),n.push(new m.core.Waypoint(d,p)),h=d)}return this.setDirection(n),f.level<=g.Verbose&&this.printWaypoint(n),n},i.prototype.setDirection=function(t){for(var e=t.length,n=null,i=0;i<e;++i){var o,r=t[i];0<i&&(o=r.getLevel()-n.getLevel(),r._setFrom(0<o?m.core.Direction.Descend:o<0?m.core.Direction.Ascend:m.core.Direction.Sibling),n._setTo(r.getFrom())),n=r}},i.prototype.printWaypoint=function(t){f.verbose("    waypoints");for(var e=t.length,n=0;n<e;++n)f.verbose("        ["+n+"] "+t[n]);f.verbose("")},i.prototype.checkState=function(){if(trace("lastState : "+m.getSceneStateString(this.lastState)),this.waypointIndex>=this.waypoints.length){f.verbose("----- scene transfer complete -----");var t=this.transferInfo.getTransferId();return this.waypointIndex=this.waypoints.length-1,this.dispatchEvent(new m.SceneManagerEvent(m.SceneManagerEvent.TRANSFER_COMPLETE,this)),void(t==this.transferInfo.getTransferId()&&(this.lastState=m.SceneState.Idling,this.transferInfo=null))}if(this.currentScene){var e=this.waypoints[this.waypointIndex];if(this.currentScene=this.getSceneByPath(e.getPath()),1<this.waypoints.length&&0==this.waypointIndex)return trace("Departure scene"),this.lastState!=m.SceneState.Leaving&&this.currentScene.getLastState()==m.SceneState.Arriving?(f.verbose(this.eventIndex+" Leave   : '"+this.currentScene.getPath()+"'"),this.currentScene.addEventListener(m.SceneEvent.LEAVE_COMPLETE,this.sceneLeaveCompleteHandler),void this.currentScene._leave(this.transferInfo)):this.lastState==m.SceneState.Unloading||e.getTo()!=m.core.Direction.Sibling&&e.getTo()!=m.core.Direction.Ascend?(++this.waypointIndex,void this.checkState()):(++this.waypointIndex,f.verbose(this.eventIndex+" Unload  : '"+this.currentScene.getPath()+"'"),this.currentScene.addEventListener(m.SceneEvent.UNLOAD_COMPLETE,this.sceneUnloadCompleteHandler),void this.currentScene._unload(this.transferInfo));if(0<this.waypointIndex&&this.waypointIndex<this.waypoints.length-1){if(trace("Through scene"),this.lastState!=m.SceneState.Loading&&(e.getFrom()==m.core.Direction.Sibling||e.getFrom()==m.core.Direction.Descend))return f.verbose(this.eventIndex+" Load    : '"+this.currentScene.getPath()+"'"),this.currentScene.addEventListener(m.SceneEvent.LOAD_COMPLETE,this.sceneLoadCompleteHandler),void this.currentScene._load(this.transferInfo);if(this.lastState!=m.SceneState.Ascending&&e.getFrom()==m.core.Direction.Ascend)return f.verbose(this.eventIndex+" Ascend  : '"+this.currentScene.getPath()+"'"),this.currentScene.addEventListener(m.SceneEvent.ASCEND_COMPLETE,this.sceneAscendCompleteHandler),void this.currentScene._ascend(this.transferInfo);if(this.lastState!=m.SceneState.Unloading&&(e.getTo()==m.core.Direction.Sibling||e.getTo()==m.core.Direction.Ascend))return++this.waypointIndex,f.verbose(this.eventIndex+" Unload  : '"+this.currentScene.getPath()+"'"),this.currentScene.addEventListener(m.SceneEvent.UNLOAD_COMPLETE,this.sceneUnloadCompleteHandler),void this.currentScene._unload(this.transferInfo);if(this.lastState!=m.SceneState.Descending&&e.getTo()==m.core.Direction.Descend)return++this.waypointIndex,f.verbose(this.eventIndex+" Descend : '"+this.currentScene.getPath()+"'"),this.currentScene.addEventListener(m.SceneEvent.DESCEND_COMPLETE,this.sceneDescendCompleteHandler),void this.currentScene._descend(this.transferInfo)}if(this.waypointIndex==this.waypoints.length-1){if(trace("Destination scene"),this.lastState!=m.SceneState.Loading&&(e.getFrom()==m.core.Direction.Sibling||e.getFrom()==m.core.Direction.Descend))return f.verbose(this.eventIndex+" Load    : '"+this.currentScene.getPath()+"'"),this.currentScene.addEventListener(m.SceneEvent.LOAD_COMPLETE,this.sceneLoadCompleteHandler),void this.currentScene._load(this.transferInfo);if(this.lastState!=m.SceneState.Arriving)return++this.waypointIndex,f.verbose(this.eventIndex+" Arrive  : '"+this.currentScene.getPath()+"'"),this.currentScene.addEventListener(m.SceneEvent.ARRIVE_COMPLETE,this.sceneArriveCompleteHandler),void this.currentScene._arrive(this.transferInfo)}}else trace("Init scene"),this.lastState=m.SceneState.Idling,this.currentScene=this.root,f.verbose(this.eventIndex+" Load    : '"+this.currentScene.getPath()+"'"),this.currentScene.addEventListener(m.SceneEvent.LOAD_COMPLETE,this.sceneLoadCompleteHandler),this.currentScene._load(this.transferInfo)},i);function i(t){void 0===t&&(t="");var e=n.call(this)||this;return e.sceneLoadCompleteHandler=function(t){e.currentScene.removeEventListener(m.SceneEvent.LOAD_COMPLETE,e.sceneLoadCompleteHandler),e.lastState=m.SceneState.Loading,++e.eventIndex,e.checkState()},e.sceneUnloadCompleteHandler=function(t){e.currentScene.removeEventListener(m.SceneEvent.UNLOAD_COMPLETE,e.sceneUnloadCompleteHandler),e.lastState=m.SceneState.Unloading,++e.eventIndex,e.checkState()},e.sceneArriveCompleteHandler=function(t){e.currentScene.removeEventListener(m.SceneEvent.ARRIVE_COMPLETE,e.sceneArriveCompleteHandler),e.lastState=m.SceneState.Arriving,++e.eventIndex,e.checkState()},e.sceneLeaveCompleteHandler=function(t){e.currentScene.removeEventListener(m.SceneEvent.LEAVE_COMPLETE,e.sceneLeaveCompleteHandler),e.lastState=m.SceneState.Leaving,++e.eventIndex,e.checkState()},e.sceneAscendCompleteHandler=function(t){e.currentScene.removeEventListener(m.SceneEvent.ASCEND_COMPLETE,e.sceneAscendCompleteHandler),e.lastState=m.SceneState.Ascending,++e.eventIndex,e.checkState()},e.sceneDescendCompleteHandler=function(t){e.currentScene.removeEventListener(m.SceneEvent.DESCEND_COMPLETE,e.sceneDescendCompleteHandler),e.lastState=m.SceneState.Descending,++e.eventIndex,e.checkState()},e.name=t,e.root=new m.core.RootScene(e),e.currentScene=null,e.waypoints=[],e.waypointIndex=-1,e.lastState=m.SceneState.Idling,e.eventIndex=-1,e.transferId=-1,e.transferInfo=null,e}m.SceneManager=e}(scn=scn||{}),function(t){var n,e=alm.event.Event,i=(__extends(o,n=e),o.prototype.clone=function(){return new o(this.type,this.target)},o.prototype.toString=function(){return"[SceneManagerEvent] type = "+this.type},o.TRANSFER_START="transferStart",o.TRANSFER_COMPLETE="transferComplete",o);function o(t,e){return n.call(this,t,e)||this}t.SceneManagerEvent=i}(scn=scn||{}),function(t){var e=(n.prototype.getTransferId=function(){return this.transferId},n.prototype.getDeparturePath=function(){return this.departurePath},n.prototype.getDestinationPath=function(){return this.destinationPath},n);function n(t,e,n){this.transferId=t,this.departurePath=e,this.destinationPath=n,this.relay=null}t.SceneTransferInfo=e}(scn=scn||{}),function(t){var e,n;(n=e=t.SceneState||(t.SceneState={}))[n.Idling=0]="Idling",n[n.Loading=1]="Loading",n[n.Unloading=2]="Unloading",n[n.Arriving=3]="Arriving",n[n.Leaving=4]="Leaving",n[n.Ascending=5]="Ascending",n[n.Descending=6]="Descending",t.getSceneStateString=function(t){switch(t){case e.Idling:return"idling";case e.Loading:return"loading";case e.Unloading:return"unloading";case e.Arriving:return"arriving";case e.Leaving:return"leaving";case e.Ascending:return"ascending";case e.Descending:return"descending"}return""}}(scn=scn||{}),function(t){var e,n,i;e=t.core||(t.core={}),(i=n=e.Direction||(e.Direction={}))[i.Static=0]="Static",i[i.Sibling=1]="Sibling",i[i.Ascend=2]="Ascend",i[i.Descend=3]="Descend",e.getDirectionString=function(t){switch(t){case n.Static:return"static";case n.Sibling:return"sibling";case n.Ascend:return"ascend";case n.Descend:return"descend"}return""}}(scn=scn||{}),function(t){var e,n,i;function o(t){var e=n.call(this,"")||this;return e.manager=t,e}e=t.core||(t.core={}),n=t.Scene,__extends(o,n),o.prototype.getManager=function(){return this.manager},i=o,e.RootScene=i}(scn=scn||{}),function(t){var n,e;function i(t,e){this.path=t,this.level=e,this.from=n.Direction.Static,this.to=n.Direction.Static}n=t.core||(t.core={}),i.prototype.getPath=function(){return this.path},i.prototype.getLevel=function(){return this.level},i.prototype.getFrom=function(){return this.from},i.prototype.getTo=function(){return this.to},i.prototype._setFrom=function(t){this.from=t},i.prototype._setTo=function(t){this.to=t},i.prototype.toString=function(){return"[Waypoint] path = '"+this.path+"', level = "+this.level+", from = "+n.getDirectionString(this.from)+", to = "+n.getDirectionString(this.to)},e=i,n.Waypoint=e}(scn=scn||{}),function(){function t(){return"0.0.1"}(alm||(alm={})).getVersion=t;var e="color:#999;",n=console.debug;n("%c+ + + + + + + + + + + + + + + + + + + + + + + + + +",e),n("%c+ alumican.js",e),n("%c+ version 0.0.1",e),n("%c+ http://alumican.net",e),n("%c+ https://github.com/alumican/alumican.js",e),n("%c+ + + + + + + + + + + + + + + + + + + + + + + + + +",e),n("")}();
//# sourceMappingURL=index.min.js.map
